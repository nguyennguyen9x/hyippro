window.__require=function e(t,n,i){function s(r,o){if(!n[r]){if(!t[r]){var c=r.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!o&&l)return l(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+r+"'")}r=c}var h=n[r]={exports:{}};t[r][0].call(h.exports,function(e){return s(t[r][1][e]||e)},h,h.exports,e,t,n,i)}return n[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<i.length;r++)s(i[r]);return s}({"TienLen.CardGroup":[function(e,t,n){"use strict";var i;cc._RF.push(t,"64e01WTFY9HWKELM3zTT4BQ","TienLen.CardGroup"),Object.defineProperty(n,"__esModule",{value:!0}),n.TienLenCardGroup=n.TienLenCardDTO=n.CardGroupType=void 0,function(e){e[e.MOT_LA=0]="MOT_LA",e[e.MOT_DOI=1]="MOT_DOI",e[e.SAM_CO=2]="SAM_CO",e[e.SANH=3]="SANH",e[e.TU_QUY=4]="TU_QUY",e[e.HAI_TU_QUY=5]="HAI_TU_QUY",e[e.BA_DOI_THONG=6]="BA_DOI_THONG",e[e.BON_DOI_THONG=7]="BON_DOI_THONG",e[e.NAM_DOI_THONG=8]="NAM_DOI_THONG",e[e.SAU_DOI_THUONG=9]="SAU_DOI_THUONG",e[e.SAU_DOI_THONG=10]="SAU_DOI_THONG",e[e.SANH_RONG=11]="SANH_RONG",e[e.HAI_DOI_THONG=12]="HAI_DOI_THONG"}(i=n.CardGroupType||(n.CardGroupType={}));class s{constructor(e){for(this.id=e,this.suit=e+1;this.suit>4;)this.suit-=4;this.number=(e+1-this.suit)/4+3,this.number>13&&(this.number-=13)}static fromCardId(e){return new s(e)}get isHeo(){return 2==this.number}equals(e){return e&&this.number===e.number&&this.suit===e.suit}isSameNumber(e){return e&&this.number===e.number}isSameSuit(e){return e&&this.suit===e.suit}static nextStraightNumber(e){return 2===e?-1:(13===e?1:e)+1}}n.TienLenCardDTO=s;class a{constructor(e){this.cards=null,this.cardsByNumbers=null,this.cards=a.sortCards(e),this.cardsByNumbers=new Map,e.forEach(e=>{void 0===this.cardsByNumbers.get(e.number)&&this.cardsByNumbers.set(e.number,[]),this.cardsByNumbers.get(e.number).push(e)})}getOrderedBySuit(){var e=new Map(this.cardsByNumbers),t=[];for(var[n,i]of e)4==i.length&&(t=t.concat(i),e.delete(n));for(var[n,i]of e)if(i.length>=2){var s=a.getNextKey(n);if(e.get(s)&&e.get(s).length>=2){var r=a.getNextKey(s);if(e.get(r)&&e.get(r).length>=2){t=t.concat([i.shift(),i.shift()]),i.length<=0&&e.delete(n);var o=e.get(s);t=t.concat([o.shift(),o.shift()]),o.length<=0&&e.delete(s);var c=e.get(r);t=t.concat([c.shift(),c.shift()]),c.length<=0&&e.delete(r);var l=a.getNextKey(r);if(e.get(l)&&e.get(l).length>=2){var h=e.get(l);t=t.concat([h.shift(),h.shift()]),h.length<=0&&e.delete(l)}break}}}for(var[n,i]of e)3==i.length&&(t=t.concat(i),e.delete(n));do{var d=a.getFirstSequenceSuit([...e.keys()],3);d&&d.forEach(function(n){t=t.concat([e.get(n).shift()]),e.get(n).length<=0&&e.delete(n)})}while(d);for(var[n,i]of e)2==i.length&&(t=t.concat(i),e.delete(n));for(var[n,i]of e)t=t.concat(i),e.delete(n);return t}getCardGroupType(){let e=new Map(this.cardsByNumbers),t=e.size,n=[...e.keys()];switch(t){case 1:return 1==e.get(n[0]).length?i.MOT_LA:2==e.get(n[0]).length?i.MOT_DOI:3==e.get(n[0]).length?i.SAM_CO:i.TU_QUY;case 2:return i.HAI_TU_QUY;case 3:return 1==e.get(n[0]).length?i.SANH:i.BA_DOI_THONG;case 4:return 1==e.get(n[0]).length?i.SANH:i.BON_DOI_THONG;default:return i.SANH}}detectSuggestionBySelectedCards(e,t,n=!1){let i;if(n){if((i=this.get_TU_QUY([],e)).length>0)return i;if((i=this.get_BON_DOI_THONG([],e)).length>0)return i;if((i=this.get_BA_DOI_THONG([],e)).length>0)return i}else{if((i=this.get_BON_DOI_THONG([],e)).length>0)return i;if((i=this.get_BA_DOI_THONG([],e)).length>0)return i;if((i=this.get_TU_QUY([],e)).length>0)return i;if((i=this.getSequenceSuitBySelectedCards(t,e)).length>0)return i;if((i=this.get_SAM_CO([],e)).length>0)return i}return i}detectSuggestionByCurrentTurnCards(e,t){const n=new a(e).getCardGroupType(),s=a.getMaxCardOfCards(e),r=new Map(this.cardsByNumbers);let o=new Array;switch(n){case i.MOT_LA:for(var c=0;c<this.cards.length;c++)a.point(this.cards[c])>a.point(s)&&o.push([this.cards[c]]);break;case i.MOT_DOI:for(var[l,h]of r)if(1!=h.length&&h.length>=2)for(c=0;c<h.length;c++)a.point(h[c])>a.point(s)&&o.push([h.shift(),h.shift()]);break;case i.SAM_CO:for(var[l,h]of r)h.length<3||l>s.number&&o.push([h.shift(),h.shift(),h.shift()]);break;case i.TU_QUY:if((o=this.get_BON_DOI_THONG(e)).length>0)return o;o=this.get_TU_QUY(e);break;case i.HAI_TU_QUY:o=this.get_TU_QUY(e);break;case i.BA_DOI_THONG:if((o=this.get_BON_DOI_THONG(e)).length>0)return o;if((o=this.get_TU_QUY(e)).length>0)return o;o=this.get_BA_DOI_THONG(e);break;case i.BON_DOI_THONG:for(var[l,h]of r)if(h.length>=2){var d=a.getNextKey(l);if(r.get(d)&&r.get(d).length>=2){var u=a.getNextKey(d);if(r.get(u)&&r.get(u).length>=2){var f=a.getNextKey(u);if(r.get(f)&&r.get(f).length>=2){var g=[h.shift(),h.shift()],p=r.get(d);g=g.concat([p.shift(),p.shift()]);var m=r.get(u);g=g.concat([m.shift(),m.shift()]);var T=r.get(f);g=g.concat([T.shift(),T.shift()]);var C=a.getMaxCardOfCards(g);a.point(C)>a.point(s)&&o.push(g)}break}}}break;case i.SANH:o=this.getSequenceSuitByCurrentTurnCards(e,t)}return o}getSequenceSuitByCurrentTurnCards(e,t){let n=[...this.cardsByNumbers.keys()].sort((e,t)=>(1==e?14:e)-(1==t?14:t)),i=[],a=[];return n.forEach((r,o)=>{const c=14==r?1:r,l=this.cardsByNumbers.get(c);if(l&&!l[0].isHeo)if(a.push(l),o+1<n.length&&this.cardsByNumbers.get(s.nextStraightNumber(c)));else{if(a.length>=e.length&&a.find(e=>e.find(e=>e.equals(t))))for(let n=0;n<=a.length-e.length;n++){let s=[];for(let i=n;i<n+e.length;i++){const e=a[i][0];s.push(e.isSameNumber(t)?t:e)}i.push(s)}a=[]}else{if(a.length>=e.length&&a.find(e=>e.find(e=>e.equals(t))))for(let n=0;n<=a.length-e.length;n++){let s=[];for(let i=n;i<n+e.length;i++){const e=a[i][0];s.push(e.isSameNumber(t)?t:e)}i.push(s)}a=[]}}),i}getSequenceSuitBySelectedCards(e,t){if(t.length<2)return[];let n=[...this.cardsByNumbers.keys()].sort((e,t)=>(1==e?14:e)-(1==t?14:t)),i=[],a=[];return n.forEach((r,o)=>{const c=14==r?1:r,l=this.cardsByNumbers.get(c);if(l&&!l[0].isHeo)if(a.push(l),o+1<n.length&&this.cardsByNumbers.get(s.nextStraightNumber(c)));else{if(a.length>=3&&a.find(t=>t.find(t=>t.equals(e)))){let n=[];for(let i=0;i<a.length;i++){const s=a[i][0];if(s.isSameNumber(e))n.push(e);else{const e=t.find(e=>e.isSameNumber(s));n.push(e||s)}}t.filter(e=>n.find(t=>e.equals(t))).length>=2&&i.push(n)}a=[]}else{if(a.length>=3&&a.find(t=>t.find(t=>t.equals(e)))){let n=[];for(let i=0;i<a.length;i++){const s=a[i][0];if(s.isSameNumber(e))n.push(e);else{const e=t.find(e=>e.isSameNumber(s));n.push(e||s)}}t.filter(e=>n.find(t=>e.equals(t))).length>=2&&i.push(n)}a=[]}}),i}get_BA_DOI_THONG(e,t=null){if(e.length>0){let e=new Array,t=new Array,s=new Array,r=new Array;for(var[n,i]of new Map(this.cardsByNumbers))e.push({number:n,value:i});for(let n=0;n<e.length;n++)n+1<e.length&&a.cardRank(e[n].number)==a.cardRank(e[n+1].number)-1&&e[n].value.length>=2&&e[n+1].value.length>=2?s.push(e[n]):(e[n].value.length>=2&&s.push(e[n]),s.length>=3&&t.push(s),s=new Array);for(let n=0;n<t.length;n++)for(let e=0;e<t[n].length-2;e++){let i=new Array;for(let s=e;s<e+3;s++)for(let e=0;e<2;e++)i.push(t[n][s].value[e]);r.push(i)}return r}{let e=new Array;if(t.length>=2){let s=new Array,r=new Array,o=new Array;for(var[n,i]of new Map(this.cardsByNumbers))s.push({number:n,value:i});for(let e=0;e<s.length;e++)e+1<s.length&&a.cardRank(s[e].number)==a.cardRank(s[e+1].number)-1&&s[e].value.length>=2&&s[e+1].value.length>=2?o.push(s[e]):(s[e].value.length>=2&&o.push(s[e]),o.length>=3&&r.push(o),o=new Array);for(let n=0;n<r.length;n++)for(let i=0;i<r[n].length-2;i++){let s=new Array;for(let e=i;e<i+3;e++)for(let t=0;t<2;t++)s.push(r[n][e].value[t]);if(t.filter(e=>s.findIndex(t=>e.equals(t))>=0).length>=2)return e.push(s),e}}return e}}get_BON_DOI_THONG(e,t=null){if(e.length>0){let e=new Array,t=new Array,s=new Array,r=new Array;for(var[n,i]of new Map(this.cardsByNumbers))e.push({number:n,value:i});for(let n=0;n<e.length;n++)n+1<e.length&&a.cardRank(e[n].number)==a.cardRank(e[n+1].number)-1&&e[n].value.length>=2&&e[n+1].value.length>=2?s.push(e[n]):(e[n].value.length>=2&&s.push(e[n]),s.length>=3&&t.push(s),s=new Array);for(let n=0;n<t.length;n++)for(let e=0;e<t[n].length-3;e++){let i=new Array;for(let s=e;s<e+4;s++)for(let e=0;e<2;e++)i.push(t[n][s].value[e]);r.push(i)}return r}{let e=new Array;if(t.length>=2){let s=new Array,r=new Array,o=new Array;for(var[n,i]of new Map(this.cardsByNumbers))s.push({number:n,value:i});for(let e=0;e<s.length;e++)e+1<s.length&&a.cardRank(s[e].number)==a.cardRank(s[e+1].number)-1&&s[e].value.length>=2&&s[e+1].value.length>=2?o.push(s[e]):(s[e].value.length>=2&&o.push(s[e]),o.length>=3&&r.push(o),o=new Array);for(let n=0;n<r.length;n++)for(let i=0;i<r[n].length-3;i++){let s=new Array;for(let e=i;e<i+4;e++)for(let t=0;t<2;t++)s.push(r[n][e].value[t]);if(t.filter(e=>s.findIndex(t=>e.equals(t))>=0).length>=2)return e.push(s),e}}return e}}get_TU_QUY(e,t=null){if(e.length>0){let e=new Array;for(var[n,i]of new Map(this.cardsByNumbers))4==i.length&&e.push(i);return e}{let e=new Array;if(t.length>=2)for(var[n,i]of new Map(this.cardsByNumbers))if(4==i.length&&t.filter(e=>i.findIndex(t=>e.equals(t))>=0).length>=2)return e.push(i),e;return e}}get_SAM_CO(e,t=null){let n=new Array;if(t.length>=2)for(var[i,s]of new Map(this.cardsByNumbers)){let e=new Array;if(!(s.length<3)&&i>2)return e=[s.shift(),s.shift(),s.shift()],t.filter(t=>e.findIndex(e=>t.equals(e))>=0).length>=2&&n.push(e),n}return n}static getMaxCardOfCards(e){return a.sortCards(e)[e.length-1]}static getNextKey(e){return 13==e?1:e+1}static subCards(e,t){return e.filter(function(e){var n=!1;return t.forEach(function(t){e.number!=t.number||e.suit!=t.suit||(n=!0)}),!n})}static sortSuits(e){e.sort(function(e,t){return(e+10)%13-(t+10)%13})}static sortCards(e){return e.sort(function(e,t){return a.point(e)-a.point(t)})}static point(e){return(e.number+10)%13*4+e.suit}static getFirstSequenceSuit(e,t){if(!e)return null;if(t<=1||t>e.length)return null;var n=[...e];a.sortSuits(n);var i=[];do{var s=n.shift();if(2==s)break;if(i.length>0&&(1!=s&&s-i[i.length-1]>1||1==s&&13!=i[i.length-1])){if(i.length>=t)return i;i=[]}i.push(s)}while(0!=n.length);return i.length>=t?i:null}static getFirstSequenceSuitBySize(e,t,n){if(!e)return null;if(t<=1||t>e.length)return null;var i=[...e.keys()];a.sortSuits(i);for(var s=[],r=0;r<i.length-1;r++){var o=i[r],c=i[r+1];if(1==o){var l=e.get(o);for(let e=0;e<l.length;e++)a.point(l[e])>a.point(n)&&s.push(l[e])}if(o<n.number-t)e.delete(o);else{if(2==o||2==c)break;if(s.length==t-1){l=e.get(o);for(let e=0;e<l.length;e++)a.point(l[e])>a.point(n)&&s.push(l[e]);return e.delete(i.shift()),a.getFirstSequenceSuitBySize(e,t,n)}c-o==1||1==c&&13==o?(l=e.get(o),s.push(l[0])):(e.delete(i.shift()),s.push(a.getFirstSequenceSuitBySize(e,t,n)))}}return s.length==t?s:null}static cardRank(e){return(e+10)%13}static indexsToCards(e){let t=[];return e.forEach(e=>{t.push(s.fromCardId(e))}),t}static cardsToIndexs(e){let t=[];return e.forEach(e=>{t.push(a.cardToIndex(e))}),t}static cardToIndex(e){return(e.number+10)%13*4+e.suit-1}}n.TienLenCardGroup=a,cc._RF.pop()},{}],"TienLen.Card":[function(e,t,n){"use strict";cc._RF.push(t,"c50a54Af+5A7Ii1aiHY1pUT","TienLen.Card");var i=this&&this.__decorate||function(e,t,n,i){var s,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(r=(a<3?s(r):a>3?s(t,n,r):s(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});const s=e("./TienLen.InGame"),{ccclass:a,property:r}=cc._decorator;let o=class extends cc.Component{constructor(){super(...arguments),this.spr=null,this.posY=0,this.offsetY=20,this.isSelected=!1,this.callback=null,this.cardDTO=null,this.moveAction=null}start(){this.posY=this.node.y}onSelect(){this.node.y+=this.isSelected?0:this.offsetY,this.isSelected=!this.isSelected,this.isSelected&&this.callback&&this.callback(this.cardDTO)}setCardData(e,t=null){this.cardDTO=e,this.spr.spriteFrame=s.default.getInstance().getCardFrame(e.id),this.callback=t}getCardDTO(){return this.cardDTO}select(){this.node.y=this.posY+this.offsetY,this.isSelected=!0}deSelect(){this.node.y=this.posY,this.isSelected=!1}moveCard(e,t){null!=this.moveAction&&this.node.stopAction(this.moveAction),this.moveAction=cc.moveTo(e,t).easing(cc.easeCubicActionOut()),this.node.runAction(this.moveAction)}};i([r(cc.Sprite)],o.prototype,"spr",void 0),o=i([a],o),n.default=o,cc._RF.pop()},{"./TienLen.InGame":"TienLen.InGame"}],"TienLen.Cmd":[function(e,t,n){"use strict";cc._RF.push(t,"e0a41YHXsZDBYEqWON2rQf/","TienLen.Cmd"),Object.defineProperty(n,"__esModule",{value:!0}),n.TienLenCmd=void 0;const i=e("../../Main/Game/src/networks/Network.OutPacket"),s=e("../../Main/Game/src/networks/Network.InPacket"),a=e("./TienLen.CardGroup"),r=e("./TienLen.InGame"),{ccclass:o}=cc._decorator;var c;(function(e){class t{}t.LOGIN=1,t.NOTIFY_DISCONNECT=37,t.PING_PONG=50,t.JOIN_ROOM=3001,t.MONEY_BET_CONFIG=3003,t.JOIN_ROOM_FAIL=3004,t.QUICK_ROOM_SUCCEED=3006,t.CHAT_ROOM=3008,t.JOIN_GAME_ROOM_BY_ID=3015,t.DANH_BAI=3101,t.START_GAME=3102,t.END_GAME=3103,t.THANG_TRANG=3104,t.CHIA_BAI=3105,t.BO_LUOT=3106,t.AUTO_START=3107,t.FIRST_TURN=3108,t.UPDATE_GAME_INFO=3110,t.REQUEST_LEAVE_ROOM=3111,t.CHANGE_TURN=3112,t.CHAT_CHONG=3113,t.CHEAT_CARDS=3115,t.HOLD=3116,t.JOIN_ROOM_SUCCESS=3118,t.USER_LEAVE_ROOM=3119,t.NOTIFY_KICK_OFF=3120,t.USER_JOIN_ROOM=3121,t.UPDATE_MATCH=3123,t.WAIT_4_DOI_THONG=3124,t.CARDS_DEFINE=3999,e.Code=t,e.SendMoneyBetConfig=class extends i.default{constructor(){super(),this.initData(100),this.setControllerId(1),this.setCmdId(t.MONEY_BET_CONFIG),this.packHeader(),this.updateSize()}},e.SendJoinRoom=class extends i.default{constructor(e,n,i,s){super(),this.initData(100),this.setControllerId(1),this.setCmdId(t.JOIN_ROOM),this.packHeader(),this.putInt(e),this.putInt(n),this.putLong(i),this.putInt(s),this.updateSize()}},e.SendJoinRoomById=class extends i.default{constructor(e){super(),this.initData(100),this.setControllerId(1),this.setCmdId(t.JOIN_GAME_ROOM_BY_ID),this.packHeader(),this.putInt(e),this.putString(""),this.updateSize()}},e.SendChatRoom=class extends i.default{constructor(e,n){super(),this.initData(100),this.setControllerId(1),this.setCmdId(t.CHAT_ROOM),this.packHeader(),this.putByte(e?1:0),this.putString(encodeURI(n)),this.updateSize()}},e.SendTest=class extends i.default{constructor(e){super(),this.initData(100),this.setControllerId(1),this.setCmdId(0),this.packHeader(),this.putString(e),this.putInt(111),this.putLong(2147483647),this.putLong(325),this.putLong(8686),this.updateSize()}},e.SendLogin=class extends i.default{constructor(e,n){super(),this.initData(100),this.setControllerId(1),this.setCmdId(t.LOGIN),this.packHeader(),this.putString(e),this.putString(n),this.updateSize()}},e.SendReconnectRoom=class extends i.default{constructor(){super(),this.initData(100),this.setControllerId(1),this.setCmdId(t.RECONNECT_GAME_ROOM),this.packHeader(),this.updateSize()}},e.SendReadyAutoStart=class extends i.default{constructor(){super(),this.initData(100),this.setControllerId(1),this.setCmdId(3124),this.packHeader(),this.updateSize()}},e.SendStartGame=class extends i.default{constructor(){super(),this.initData(100),this.setControllerId(1),this.setCmdId(t.START_GAME),this.packHeader(),this.updateSize()}},e.SendPing=class extends i.default{constructor(){super(),this.initData(100),this.setControllerId(0),this.setCmdId(t.PING_PONG),this.packHeader(),this.updateSize()}},e.SendDanhBai=class extends i.default{constructor(e,n){if(super(),this.initData(100),this.setControllerId(1),this.setCmdId(t.DANH_BAI),this.packHeader(),this.putByte(e),!e){this.putShort(n.length);for(let e=0;e<n.length;e++)this.putByte(n[e])}this.updateSize()}},e.SendBoLuot=class extends i.default{constructor(e){super(),this.initData(100),this.setControllerId(1),this.setCmdId(t.DANH_BAI),this.packHeader(),this.putByte(e),this.updateSize()}},e.SendRequestLeaveGame=class extends i.default{constructor(){super(),this.initData(100),this.setControllerId(1),this.setCmdId(t.REQUEST_LEAVE_ROOM),this.packHeader(),this.updateSize()}},e.SendCardDefinations=class extends i.default{constructor(){super(),this.initData(100),this.setControllerId(1),this.setCmdId(t.CARDS_DEFINE),this.packHeader(),this.updateSize()}},e.SendCheatCards=class extends i.default{constructor(e,n){if(super(),this.initData(100),this.setControllerId(1),this.setCmdId(t.CHEAT_CARDS),this.packHeader(),this.putByte(e),this.putByte(0),this.putShort(n.length),e)for(var i=0;i<n.length;i++)this.putByte(n[i]);this.updateSize()}},e.ReceivedMoneyBetConfig=class extends s.default{constructor(e){super(e),this.list=[],this.rules=[];let t=this.getShort();for(var n=0;n<t;n++){var i={maxUserPerRoom:this.getInt(),moneyType:this.getByte(),moneyBet:this.getLong(),moneyRequire:this.getLong(),nPersion:this.getInt()};this.list.push(i)}for(n=0;n<t;n++)this.rules.push(this.getByte())}},e.ReceivedJoinRoomFail=class extends s.default{constructor(e){super(e),this.error=0,this.error=this.getError()}},e.ReceivedJoinRoomSuccess=class extends s.default{constructor(e){super(e),this.myChair=0,this.moneyBet=0,this.roomOwner=0,this.roomId=0,this.matchId=0,this.moneyType=0,this.playerSize=0,this.playerInfos=[],this.gameAction=0,this.currentChair=0,this.countDownTime=0,this.myChair=this.getByte(),this.moneyBet=this.getLong(),this.roomOwner=this.getByte(),this.roomId=this.getInt(),this.matchId=this.getInt(),this.moneyType=this.getByte(),this.playerSize=this.getShort();let t=[];for(let i=0;i<this.playerSize;i++)t.push(this.getByte());this.playerSize=this.getShort();for(let i=0;i<this.playerSize;i++){let e=new r.TienLenSlotInfo;e.avatar=this.getString(),e.nickName=this.getString(),e.money=this.getLong(),e.uID=0,e.cardSize=0,e.playerStatus=t[i],this.playerInfos.push(e)}this.gameAction=this.getByte();let n=this.getShort();for(let i=0;i<n;i++){let e=this.getByte();cc.isValid(this.playerInfos[i])&&(this.playerInfos[i].cardSize=e)}this.currentChair=this.getByte(),this.countDownTime=this.getByte()}},e.ReceivedDisconnect=class extends s.default{constructor(e){super(e)}},e.ReceivedUpdateGameInfo=class extends s.default{constructor(e){super(e),this.maxPlayer=0,this.myChair=0,this.playerCards=[],this.boLuot=!1,this.toiTrang=0,this.newRound=!1,this.gameServerState=0,this.gameAction=0,this.activeTimeRemain=0,this.currentChair=0,this.recentCards=[],this.moneyType=0,this.moneyBet=0,this.matchId=0,this.roomId=0,this.hasInfoList=[],this.playerInfos=[],this.maxPlayer=this.getByte(),this.myChair=this.getByte();for(var t=this.getShort(),n=0;n<t;n++)this.playerCards.push(a.TienLenCardDTO.fromCardId(this.getByte()));for(this.boLuot=this.getBool(),this.toiTrang=this.getInt(),this.newRound=this.getBool(),this.gameServerState=this.getByte(),this.gameAction=this.getByte(),this.activeTimeRemain=this.getByte(),this.currentChair=this.getByte(),t=this.getShort(),n=0;n<t;n++)this.recentCards.push(a.TienLenCardDTO.fromCardId(this.getByte()));this.moneyType=this.getByte(),this.moneyBet=this.getLong(),this.matchId=this.getInt(),this.roomId=this.getInt(),t=this.getShort();for(let i=0;i<t;i++)this.hasInfoList.push(this.getBool());for(let i=0;i<t;i++){let e=new r.TienLenSlotInfo;if(this.hasInfoList[i]){let t=this.getByte(),n=this.getByte(),i=this.getString(),s=this.getInt(),a=this.getString(),r=this.getLong();e.cardSize=t,e.avatar=i,e.uID=s,e.nickName=a,e.money=r,e.playerStatus=n}this.playerInfos.push(e)}}},e.ReceivedAutoStart=class extends s.default{constructor(e){super(e),this.isAutoStart=!1,this.autoStartTime=0,this.matchId=0,this.isAutoStart=this.getBool(),this.autoStartTime=this.getByte(),this.matchId=this.getByte()}},e.ReceivedChatRoom=class extends s.default{constructor(e){super(e),this.chair=this.getByte(),this.isIcon=this.getBool(),this.content=decodeURI(this.getString()),this.nickname=this.getString()}},e.ReceivedChiaBai=class extends s.default{constructor(e){super(e),this.cardSize=0,this.cards=[],this.toiTrang=0,this.timeBaoSam=0,this.matchId=0,this.playerSize=0,this.playerStatus=[];var t=0;for(this.cardSize=this.getShort(),t=0;t<this.cardSize;t++)this.cards.push(a.TienLenCardDTO.fromCardId(this.getByte()));for(this.toiTrang=this.getByte(),this.timeBaoSam=this.getByte(),this.matchId=this.getInt(),this.playerSize=this.getShort(),t=0;t<this.playerSize;t++)this.playerStatus.push(this.getByte())}},e.ReceivedDanhBai=class extends s.default{constructor(e){super(e),this.chair=0,this.cards=[],this.remainCardSize=0,this.chair=this.getByte();for(var t=this.getShort(),n=0;n<t;n++)this.cards.push(this.getByte());this.remainCardSize=this.getByte()}},e.ReceivedBoluot=class extends s.default{constructor(e){super(e),this.chair=0,this.chair=this.getByte()}},e.ReceivedChangeTurn=class extends s.default{constructor(e){super(e),this.newRound=!1,this.chair=0,this.chairLastTurn=0,this.time=0,this.newRound=this.getBool(),this.chair=this.getByte(),this.chairLastTurn=this.getByte(),this.time=this.getByte()}},e.ReceivedWaitBonDoiThong=class extends s.default{constructor(e){super(e),this.chair=0,this.chair=this.getByte()}},e.ReceivedNotifyRegOutRoom=class extends s.default{constructor(e){super(e),this.outChair=this.getByte(),this.isOutRoom=this.getBool()}},e.ReceivedEndGame=class extends s.default{constructor(e){super(e),this.winTypes=[],this.ketQuaTinhTienList=[],this.cards=[],this.sizeWinType=0,this.kqTinhTienSize=0,this.currentMoney=[],this.countDown=0,this.sizeWinType=this.getShort();for(var t=0;t<this.sizeWinType;t++)this.winTypes.push(this.getByte());for(this.kqTinhTienSize=this.getShort(),t=0;t<this.kqTinhTienSize;t++)this.ketQuaTinhTienList.push(this.getLong());var n=this.getShort();for(t=0;t<n;t++)this.currentMoney.push(this.getLong());var i=n;for(t=0;t<i;t++){n=this.getShort();for(var s=[],r=0;r<n;r++)s.push(a.TienLenCardDTO.fromCardId(this.getByte()));this.cards.push(s)}this.countDown=this.getByte()}},e.ReceivedFirstTurnDecision=class extends s.default{constructor(e){super(e),this.isRandom=!1,this.chair=0,this.cardSize=0,this.cards=[],this.playerSize=0,this.playerStatus=[],this.isRandom=this.getBool(),this.chair=this.getByte(),this.cardSize=this.getShort();for(var t=0;t<this.cardSize;t++){var n=this.getByte();this.cards.push(n)}for(this.playerSize=this.getShort(),t=0;t<this.playerSize;t++)this.playerStatus.push(this.getByte())}},e.ReceivedChatChong=class extends s.default{constructor(e){super(e),this.winChair=0,this.lostChair=0,this.winMoney=0,this.lostMoney=0,this.winCurrentMoney=0,this.lostCurrentMoney=0,this.winChair=this.getByte(),this.lostChair=this.getByte(),this.winMoney=this.getLong(),this.lostMoney=this.getLong(),this.winCurrentMoney=this.getLong(),this.lostCurrentMoney=this.getLong()}},e.ReceivedPingPong2=class extends s.default{constructor(e){super(e),this.id=0,this.id=this.getLong()}},e.UserLeaveRoom=class extends s.default{constructor(e){super(e),this.chair=0,this.nickName="",this.chair=this.getByte(),this.nickName=this.getString()}},e.ReceiveUserJoinRoom=class extends s.default{constructor(e){super(e),this.info=new r.TienLenSlotInfo,this.uChair=0,this.uStatus=0,this.info.nickName=this.getString(),this.info.avatar=this.getString(),this.info.money=this.getLong(),this.uChair=this.getByte(),this.uStatus=this.getByte()}},e.ReceivedUpdateMatch=class extends s.default{constructor(e){super(e),this.myChair=0,this.hasInfo=[],this.infos=[],this.myChair=this.getByte();for(var t=this.getShort(),n=0;n<t;n++)this.hasInfo.push(this.getBool());for(n=0;n<t;n++){var i={money:this.hasInfo[n]?this.getLong():null,status:this.hasInfo[n]?this.getInt():null};this.infos.push(i)}}},e.ReceiveNotifyRegOutRoom=class extends s.default{constructor(e){super(e),this.outChair=0,this.isOutRoom=!1,this.outChair=this.getByte(),this.isOutRoom=this.getBool()}},e.ReceivedKickOff=class extends s.default{constructor(e){super(e),this.reason=0,this.reason=this.getByte()}},e.ReceivePingPong=class extends s.default{constructor(e){super(e),this.test=0,this.test=this.getLong()}},e.ReceivedCardDefinations=class extends s.default{constructor(e){super(e),this.strData=this.getString()}}})(c=n.TienLenCmd||(n.TienLenCmd={})),n.default=c,cc._RF.pop()},{"../../Main/Game/src/networks/Network.InPacket":void 0,"../../Main/Game/src/networks/Network.OutPacket":void 0,"./TienLen.CardGroup":"TienLen.CardGroup","./TienLen.InGame":"TienLen.InGame"}],"TienLen.Constant":[function(e,t,n){"use strict";var i;cc._RF.push(t,"0f7d1OQxSZGDLP7T8ukp1Tu","TienLen.Constant"),Object.defineProperty(n,"__esModule",{value:!0}),n.TienLenConstant=void 0,function(e){class t{}t.NONE=-1,t.AUTOSTART=0,t.JOINROOM=4,t.FIRSTTURN=1,t.CHIABAI=2,t.CHANGETURN=3,t.USERJOIN=5,t.DANHBAI=6,t.BOLUOT=7,t.QUIT=8,t.USERLEAVE=12,t.ENDGAME=13,t.UPDATEMATH=14,t.UPDATEOWNERROOM=15,t.PLAYCONTINUE=16,t.CHATCHONG=17,t.JACKPOT=18,t.REASONQUIT=19,t.NOTIFYOUTROOM=20,t.WAITBONDOITHONG=21,e.GameState=t;class n{}n.MAX_PLAYER=4,n.MAX_CARDS=13,e.Config=n;class i{}i.kSortTangDan=0,i.kSortGroup=1,i.kSortUnkown=2,e.SortType=i;class s{}s.MY=0,s.ENEMY=1,s.STATENONE=0,s.STATEVIEWING=1,s.STATEBAOSAM=2,e.PlayerType=s;class a{}a.NO_LOGIN=0,a.VIEW=1,a.SIT=2,a.PLAY=3,e.PlayerStatus=a;class r{}r.ERROR_MONEY=1,r.ERROR_BAO_TRI=2,e.KickReasonCodes=r}(i=n.TienLenConstant||(n.TienLenConstant={})),n.default=i,cc._RF.pop()},{}],"TienLen.InGame":[function(e,t,n){"use strict";cc._RF.push(t,"342d3Cd3U9Nz7EQADJPgCr3","TienLen.InGame");var i,s=this&&this.__decorate||function(e,t,n,i){var s,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(r=(a<3?s(r):a>3?s(t,n,r):s(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.TienLenSlotInfo=n.TienLenRoomInfoDTO=void 0;const a=e("../../Main/Game/src/common/Utils"),r=e("./TienLen.Player"),o=e("./TienLen.Card"),c=e("../../Main/Game/src/networks/TienLenNetworkClient"),l=e("./TienLen.Cmd"),h=e("./TienLen.Constant"),d=e("./TienLen.CardGroup"),u=e("../../Main/Game/src/common/Configs"),f=e("../../Main/Game/src/common/App"),g=e("../../Main/Game/src/games/cardgames/PopupCardDefinations"),p=e("./TienLen.PopupMatchResult"),m=e("./TienLen.ItemPlayerResult"),T=e("../../Main/Game/src/networks/CardGame.Cmd"),C=e("../../Main/Game/src/games/cardgames/PopupChatInGame"),y=e("../../Main/Game/src/games/cardgames/PopupSettingInGame"),v=e("./TienLen.PopupGuide"),R=e("../../Main/Game/src/common/Common.AudioManager"),I=e("../../Main/Game/src/common/BroadcastReceiver"),_=e("./TienLen.Listener"),{ccclass:O,property:A}=cc._decorator;class S{constructor(){this.roomId=0,this.moneyBet=0,this.matchId=0,this.myChair=0,this.slotInfos=[],this.recentCards=[],this.currentTurnChair=0,this.currentTimeRemain=0,this.newRound=!1}static fromReceivedJoinRoomSuccess(e){let t=new S;return t.roomId=e.roomId,t.moneyBet=e.moneyBet,t.matchId=e.matchId,t.myChair=e.myChair,t.slotInfos=e.playerInfos,t.recentCards=[],t.currentTurnChair=e.currentChair,t.currentTimeRemain=e.countDownTime,t.newRound=!1,t}static fromReceivedUpdateGameInfo(e){let t=new S;return t.roomId=e.roomId,t.moneyBet=e.moneyBet,t.matchId=e.matchId,t.myChair=e.myChair,t.slotInfos=e.playerInfos,t.slotInfos[t.myChair].cards=e.playerCards,t.recentCards=e.recentCards,t.currentTurnChair=e.currentChair,t.currentTimeRemain=e.activeTimeRemain,t.newRound=e.newRound,t}}n.TienLenRoomInfoDTO=S,n.TienLenSlotInfo=class{constructor(){this.cards=[]}};let b=i=class extends cc.Component{constructor(){super(...arguments),this.lbRoomId=null,this.lbRoomBet=null,this.lbMatchId=null,this.players=[],this.lbTimeCountDown=null,this.cardLine=null,this.board=null,this.btnsInGame=null,this.lblToast=null,this.fxMeWin=null,this.fxMeLose=null,this.fxWhoPlayFirst=null,this.btnShowCardDefinations=null,this.backgroundMusic=null,this.winSound=null,this.cardFrames=[],this.cardBackFrame=null,this.cardItem=null,this.cardsOnHand=new Map,this.buttons={},this.myChair=0,this.sortBySuit=!0,this.currTurnCards=[],this.isMyTurn=!1,this.changeTurnChair=null,this.countDown=null,this.playerUsernameByServerChair=[],this.cardDefinations=[]}static getInstance(){return this.instance}static destroyInstance(){this.instance=null}onLoad(){i.instance=this}start(){var e;null===(e=_.default.getInstance())||void 0===e||e.releasePendingCommands(),I.default.send(I.default.SET_SOUND,cc.find("Canvas")),this.btnsInGame.children.forEach(e=>{this.buttons[e.name]=e}),R.default.getInstance().playBackgroundMusicByGame(u.default.App.BUNDLE_NAME.TIENLEN,this.backgroundMusic),this.enableCardTouch()}onDestroy(){clearInterval(this.countDown),p.default.instance=null,i.instance=null}updateRoomInfo(e=null){this.lbTimeCountDown.node.parent.active=!1,this.cleanCardLine(),this.cleanCardsOnBoard(),this.cleanCardsOnHand(),this.players.forEach(e=>e.resetPlayer()),this.lbRoomId.string=e.roomId+"",this.lbRoomBet.string=a.default.formatNumber(e.moneyBet),this.lbMatchId.string=e.matchId+"",this.myChair=e.myChair,this.setPlayersInfo(e)}setPlayersInfo(e){this.playerUsernameByServerChair=[];for(let n=0;n<e.slotInfos.length;n++){let t=e.slotInfos[n],i=this.convertChair(n),s=this.players[i];s.status=t.playerStatus,s.status&&s.status!==h.default.PlayerStatus.NO_LOGIN&&(this.playerUsernameByServerChair[n]=t.nickName,s.setPlayerInfo(t),s.status==h.default.PlayerStatus.PLAY&&0!=i&&s.setCardRemain(t.cardSize))}if(e.recentCards&&e.recentCards.length>0){let t=(e.recentCards.length-1)/2,n=Math.floor(100*Math.random())-50,i=Math.floor(100*Math.random())-50;for(let s=0;s<e.recentCards.length;s++){let a=cc.instantiate(this.cardItem);a.parent=this.board,a.setScale(.6,.6),a.getComponent(o.default).setCardData(e.recentCards[s]),a.setPosition(30*(s-t)+n,i)}}let t=e.slotInfos[e.myChair];if(t.cards&&t.cards.length>0){if(this.changeTurnChair=e.currentTurnChair,this.players.forEach(e=>e.setTimeRemain(0)),this.players[this.changeTurnChair].setTimeRemain(e.currentTimeRemain),0==this.changeTurnChair&&(this.setActiveButtons(["bt_submit_turn","bt_pass_turn"],[!0,!0]),this.isMyTurn=!0),e.newRound){this.cleanCardsOnBoard(),this.currTurnCards=[],this.isMyTurn=!1;for(let e=0;e<this.players.length;e++)this.players[e].active&&this.players[e].setAction()}this.cardLine.active=!0,this.setCardsOnHand(this.sortCards(t.cards)),this.setActiveButtons(["bt_sort"],[!0])}}receivedChatRoom(e){const t=this.convertChair(e.chair);let n=e.isIcon,i=e.content;n?this.players[t].showChatEmotion(i):this.players[t].showChatMsg(i)}receivedUserJoinRoom(e){e.uStatus!==h.default.PlayerStatus.NO_LOGIN&&(this.playerUsernameByServerChair[e.uChair]=e.info.nickName,this.players[this.convertChair(e.uChair)].setPlayerInfo(e.info),this.players[this.convertChair(e.uChair)].status=e.uStatus)}receivedAutoStart(e){this.lbMatchId.string=e.matchId+"",this.btnsInGame.children.forEach(e=>e.active=!1),this.setTimeCountDown("V\xe1n \u0111\u1ea5u b\u1eaft \u0111\u1ea7u sau: ",e.autoStartTime),p.default.instance&&p.default.instance.node.active&&p.default.instance.dismiss()}setTimeCountDown(e,t){this.lbTimeCountDown.string=e+""+t+"s",this.lbTimeCountDown.node.parent.active=!0,clearInterval(this.countDown),this.countDown=setInterval(()=>{--t<0?(clearInterval(this.countDown),this.lbTimeCountDown.node.parent.active=!1):this.lbTimeCountDown.string=e+""+t+"s"},1e3)}receivedFirstTurnDecision(e){this.cleanCardLine(),e.cards.forEach((t,n)=>{var i=this.players[this.convertChair(n)];i.status=e.playerStatus[n],i.isPlaying()&&i.setFirstCard(t)}),this.players.filter(e=>e.isPlaying()).forEach((e,t)=>{const n=0===t?this.board.convertToNodeSpaceAR(e.node.parent.convertToWorldSpaceAR(e.node.getPosition())):e.node.getPosition(),i=cc.instantiate(this.cardItem);i.parent=this.node,i.getComponent(o.default).spr.spriteFrame=this.cardBackFrame,i.runAction(cc.sequence(cc.delayTime(.5+.05*t),cc.spawn(cc.moveTo(.2,n),cc.scaleTo(.2,.76)),cc.delayTime(1),cc.callFunc(()=>{i.destroy()})))})}receivedDealCard(e){this.lbMatchId.string=e.matchId+"",this.setCardsOnHand(this.sortCards(e.cards)),e.toiTrang,this.players.filter(e=>e.isPlaying()).forEach(e=>e.offFirstCard()),this.players.filter(e=>e.isPlaying()).filter(e=>!e.isMe()).forEach(t=>t.setCardRemain(e.cardSize)),this.setActiveButtons(["bt_sort"],[!0]),this.disableCardTouch(),this.enableCardTouch()}receivedChangeTurn(e){const t=this.convertChair(e.chair);this.changeTurnChair=t,this.players.forEach(e=>e.setTimeRemain(0)),this.players[t].setTimeRemain(e.time),0==t&&(this.setActiveButtons(["bt_submit_turn","bt_pass_turn"],[!0,!0]),this.isMyTurn=!0),e.newRound&&(this.cleanCardsOnBoard(),this.currTurnCards=[],this.isMyTurn=!1,this.scheduleOnce(()=>{this.players.filter(e=>e.active).forEach(e=>e.setAction())},1))}receivedSubmitTurn(e){this.setActiveButtons(["bt_submit_turn","bt_pass_turn"],[!1,!1]);let t=this.sortCards(d.TienLenCardGroup.indexsToCards(e.cards)),n="";switch(new d.TienLenCardGroup(t).getCardGroupType()){case d.CardGroupType.MOT_LA:t[0].isHeo&&(n="Heo!");break;case d.CardGroupType.MOT_DOI:t[0].isHeo&&(n="\u0110\xf4i Heo!");break;case d.CardGroupType.SAM_CO:t[0].isHeo&&(n="Ba con Heo!");break;case d.CardGroupType.TU_QUY:n="T\u1ee9 qu\xfd"+(t[0].isHeo?"Heo!":"!");break;case d.CardGroupType.HAI_TU_QUY:n="Hai t\u1ee9 qu\xfd!";break;case d.CardGroupType.BA_DOI_THONG:n="Ba \u0111\xf4i th\xf4ng!";break;case d.CardGroupType.BON_DOI_THONG:n="B\u1ed1n \u0111\xf4i th\xf4ng!"}n&&this.showNotification(n);let i=(t.length-1)/2,s=Math.floor(100*Math.random())-50,a=Math.floor(100*Math.random())-50,r=this.convertChair(e.chair),c=this.players[r];if(c.isMe())t.forEach((e,t)=>{let n=this.cardsOnHand.get(e.id),r=n.parent.convertToWorldSpaceAR(n.position);r=this.board.convertToNodeSpaceAR(r),n.parent=this.board,n.setPosition(r),n.runAction(cc.moveTo(.2,cc.v2(30*(t-i)+s,a))),n.runAction(cc.scaleTo(.2,.6,.6)),this.cardsOnHand.delete(e.id)}),this.moveAllCardOnHand();else{let n=c.node.parent.convertToWorldSpaceAR(c.node.position);n=this.board.convertToNodeSpaceAR(n),t.forEach((e,t)=>{let r=cc.instantiate(this.cardItem);r.parent=this.board,r.setScale(.6,.6),r.setPosition(n),r.runAction(cc.moveTo(.2,cc.v2(30*(t-i)+s,a))),r.getComponent(o.default).setCardData(e)}),c.setCardRemain(e.remainCardSize),this.currTurnCards=t}this.board.children.forEach((e,t)=>{e.zIndex=this.board.zIndex+t}),1===e.cards.length&&0===e.cards[0]&&0===e.remainCardSize&&c.showEffectKet3Bich()}receivedPassTurn(e){this.players[this.convertChair(e.chair)].setAction("B\u1ecf l\u01b0\u1ee3t"),this.setActiveButtons(["bt_submit_turn","bt_pass_turn"],[!1,!1])}actSubmitTurn(){var e=[];this.cardLine.children.forEach(t=>{var n=t.getComponent(o.default);n.isSelected&&e.push(n.getCardDTO())}),0!==e.length?(this.sendSubmitTurn(e),this.isMyTurn=!1):this.showToast("Vui l\xf2ng ch\u1ecdn l\xe1 b\xe0i")}sendSubmitTurn(e){c.default.getInstance().send(new l.default.SendDanhBai(!1,d.TienLenCardGroup.cardsToIndexs(e)))}actPassTurn(){this.sendPassTurn(),this.isMyTurn=!1}sendPassTurn(){c.default.getInstance().send(new l.default.SendBoLuot(!0))}sortCards(e){return this.sortBySuit?new d.TienLenCardGroup(e).getOrderedBySuit():d.TienLenCardGroup.sortCards(e)}actSort(){this.cardLine.children.forEach(e=>e.stopAllActions()),this.sortBySuit=!this.sortBySuit;let e=this.getCardDTOsOnHand();e=this.sortCards(e),this.setToggleCardsOnHand(),this.sortCardsOnHand(e)}setCardsOnHand(e){e.forEach(e=>{let t=cc.instantiate(this.cardItem);t.parent=this.cardLine,t.getComponent(o.default).setCardData(e,this.onCardSelectCallback.bind(this)),this.cardsOnHand.set(e.id,t)}),this.sortCardsOnHand(e)}onCardSelectCallback(e){const t=this.detectSuggestionCards(e);for(let n=0;n<t.length;n++)for(let i=0;i<t[n].length;i++)d.TienLenCardGroup.cardToIndex(e)==d.TienLenCardGroup.cardToIndex(t[n][i])&&this.setToggleCardsOnHand(t[n])}detectSuggestionCards(e){const t=this.getCardDTOsOnHand();if(this.isMyTurn){if(1===this.currTurnCards.length&&this.currTurnCards[0].isHeo){const n=[...this.cardsOnHand.values()].map(e=>e.getComponent(o.default)).filter(e=>e.isSelected).map(e=>e.getCardDTO());return new d.TienLenCardGroup(t).detectSuggestionBySelectedCards(n,e,!0)}return new d.TienLenCardGroup(t).detectSuggestionByCurrentTurnCards(this.currTurnCards,e)}const n=[...this.cardsOnHand.values()].map(e=>e.getComponent(o.default)).filter(e=>e.isSelected).map(e=>e.getCardDTO());return new d.TienLenCardGroup(t).detectSuggestionBySelectedCards(n,e)}getCardDTOsOnHand(){var e=[];return this.cardsOnHand.forEach(t=>{const n=t.getComponent(o.default);e.push(n.getCardDTO())}),e}cleanCardsOnHand(){this.cardsOnHand.clear()}cleanCardsOnBoard(){this.board.removeAllChildren()}setToggleCardsOnHand(e=null){this.cardsOnHand.forEach(e=>{e.getComponent(o.default).deSelect()}),e&&e.forEach(e=>{this.cardsOnHand.get(e.id).getComponent(o.default).select()})}sortCardsOnHand(e){e.forEach((e,t)=>{const n=this.cardsOnHand.get(e.id);n.zIndex=this.cardLine.zIndex+t,n.setSiblingIndex(t)}),this.moveAllCardOnHand()}effectClean(e){for(let a=e.length-1;a>=0;a--){var t=e[a],n=t.parent.convertToWorldSpaceAR(t.position);n=this.board.convertToNodeSpaceAR(n),t.parent=this.board,t.setPosition(n);var i=Math.floor(100*Math.random())-50,s=Math.floor(100*Math.random())-50;t.runAction(cc.sequence(cc.delayTime(.1*a),cc.spawn(cc.moveTo(.2,cc.v2(i,s)),cc.scaleTo(.2,.6,.6))))}}cleanAllCard(){for(let e=1;e<this.players.length;e++)this.players[e].active&&this.effectClean(this.players[e].cardLine.children);this.effectClean(this.cardLine.children),this.scheduleOnce(()=>{this.cleanCardsOnHand(),this.cleanCardLine(),this.cleanCardsOnBoard()},2)}cleanCardLine(){this.cardLine.removeAllChildren(),this.players.forEach(e=>e.clearCardLine())}setActiveButtons(e,t){for(let n=0;n<e.length;n++)this.buttons[e[n]]&&(this.buttons[e[n]].active=t[n])}receivedEndGame(e){this.disableCardTouch(),this.players.forEach(e=>e.setTimeRemain(0));const t=e.ketQuaTinhTienList;this.scheduleOnce(()=>{for(let n=0;n<h.default.Config.MAX_PLAYER;n++){const i=this.convertChair(n);this.players[i].setCoinChange(t[n]),this.players[i].setCoin(e.currentMoney[n]),0===i&&(u.default.Login.Coin=e.currentMoney[n],this.fxMeWin.active=t[n]>0,this.fxMeLose.active=t[n]<0,t[n]>0&&R.default.getInstance().playEffectByGame(u.default.App.BUNDLE_NAME.TIENLEN,this.winSound))}},2),e.cards.forEach((e,t)=>{const n=this.convertChair(t);0!=n&&this.players[n].status==h.default.PlayerStatus.PLAY&&(this.players[n].setCardLine(e),this.players[n].setCardRemain(0)),1===e.length&&0===e[0].id&&this.players[n].showEffectThoi3Bich()}),this.setActiveButtons(["bt_sort"],[!1]),this.scheduleOnce(()=>{this.setTimeCountDown("V\xe1n \u0111\u1ea5u k\u1ebft th\xfac sau: ",0==e.countDown?10:e.countDown-6)},0==e.countDown?0:4),this.scheduleOnce(()=>{this.cleanAllCard(),this.players.forEach(e=>e.setAction())},0==e.countDown?5:9),c.default.getInstance().send(new l.default.SendReadyAutoStart),this.scheduleOnce(()=>{this.fxMeWin.active=!1,this.fxMeLose.active=!1;let n=[];t.forEach((t,i)=>{if(0!==t){let s=new m.TienLenResult;s.userName=this.playerUsernameByServerChair[i],s.goldChange=t,s.cards=e.cards[i],s.winTypes=e.winTypes[i],n.push(s)}}),n.sort((e,t)=>e.cards.length-t.cards.length).forEach((e,t)=>e.rank=t),p.default.createAndShow(this.node,n)},4)}receivedUpdateMatch(e){this.myChair=e.myChair;for(let n=0;n<e.hasInfo.length;n++){var t=this.convertChair(n);e.hasInfo[n]&&(this.players[t].status=e.infos[n].status,this.players[t].setCoin(e.infos[n].money))}}receivedUserLeaveRoom(e){const t=this.convertChair(e.chair);this.players[t].resetPlayer(),0==t&&(clearInterval(this.countDown),cc.director.loadScene("TienLen"))}receivedNotifyUserRegOutRoom(e){let t=e.outChair,n=e.isOutRoom,i=this.convertChair(t);-1!==i&&this.players[i].setNotify(n?"S\u1eafp r\u1eddi b\xe0n !":"Kh\xf4 M\xe1u !")}receivedChatChong(e){let t=e.winChair,n=e.lostChair,i=e.winMoney,s=e.lostMoney,a=e.winCurrentMoney,r=e.lostCurrentMoney,o=this.convertChair(t),c=this.convertChair(n);this.players[o].setCoinChange(i),this.players[c].setCoinChange(s),this.players[o].setCoin(a),this.players[c].setCoin(r),0===o&&(u.default.Login.Coin=a),0===c&&(u.default.Login.Coin=r)}receivedWait4doithong(e){this.showNotification("\u0110\u1ee3i B\u1ed1n \u0110\xf4i Th\xf4ng !")}showNotification(e){this.fxWhoPlayFirst.active=!0,this.fxWhoPlayFirst.scale=0,this.fxWhoPlayFirst.opacity=0,this.fxWhoPlayFirst.stopAllActions(),this.fxWhoPlayFirst.runAction(cc.sequence(cc.spawn(cc.scaleTo(.2,1).easing(cc.easeBackOut()),cc.fadeIn(.2)),cc.delayTime(1.5),cc.callFunc(()=>{this.fxWhoPlayFirst.active=!1}))),this.fxWhoPlayFirst.children[0].getComponent(cc.Label).string=e}convertChair(e){return(e-this.myChair+h.default.Config.MAX_PLAYER)%h.default.Config.MAX_PLAYER}showToast(e){this.lblToast.string=e;let t=this.lblToast.node.parent;t.stopAllActions(),t.active=!0,t.opacity=0,t.runAction(cc.sequence(cc.fadeIn(.1),cc.delayTime(2),cc.fadeOut(.2),cc.callFunc(()=>{t.active=!1})))}receivedKickFromRoom(e){cc.director.loadScene("TienLen",()=>{switch(e){case h.default.KickReasonCodes.ERROR_MONEY:f.default.instance.actiontDialog.showMsgWithAction("S\u1ed1 d\u01b0 kh\xf4ng \u0111\u1ee7.","N\u1ea0P NGAY",()=>{f.default.instance.openShop(0)});break;case h.default.KickReasonCodes.ERROR_BAO_TRI:f.default.instance.alertDialog.showMsg("H\u1ec7 th\u1ed1ng b\u1ea3o tr\xec!");break;default:f.default.instance.alertDialog.showMsg("B\u1ea1n b\u1ecb kick kh\u1ecfi b\xe0n ch\u01a1i!")}})}findTouchedCard(e){for(let t=this.cardLine.children.length-1;t>=0;t--)if(this.cardLine.children[t].getBoundingBoxToWorld().contains(e))return t}moveAllCardOnHand(e=null){for(let t=0;t<this.cardLine.children.length;t++){let n=this.cardLine.children[t];n!=e&&n.runAction(cc.moveTo(.2,this.getCardPosition(this.cardLine.children.length,t)))}}getCardPosition(e,t){let n=this.cardLine.position.x-45*(e-1)/2+45*t;return cc.v2(n,0)}swapCard(e,t){this.node.runAction(cc.spawn(cc.callFunc(()=>{let n=this.cardLine.children[t].getComponent(o.default).getCardDTO().id;this.cardsOnHand.get(n).setSiblingIndex(e)}),cc.callFunc(()=>{let n=this.cardLine.children[e].getComponent(o.default).getCardDTO().id;this.cardsOnHand.get(n).setSiblingIndex(t)})))}enableCardTouch(){let e=null,t=null,n=null,i=!1;this.node.on(cc.Node.EventType.TOUCH_START,n=>{let i=cc.v2(n.touch.getLocation());t=this.findTouchedCard(i);let s=this.cardLine.children[t];e=s},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,s=>{let a=s.touch.getDelta();if(n+=Math.sqrt(Math.pow(a.x,2)),null!=e){if(i=!1,e.x+=a.x,a.x<0&&null!=this.cardLine.children[t-1]&&e.x<=this.cardLine.children[t-1].x+20){let n=this.cardLine.children[t-1],i=this.getCardPosition(this.cardLine.children.length,t-1);n.getComponent(o.default).moveCard(.2,cc.v2(i.x+45,0)),n.zIndex++,e.zIndex--,this.swapCard(t,t-1),t--}if(a.x>0&&null!=this.cardLine.children[t+1]&&e.x>=this.cardLine.children[t+1].x-20){let n=this.cardLine.children[t+1],i=this.getCardPosition(this.cardLine.children.length,t+1);n.getComponent(o.default).moveCard(.2,cc.v2(i.x-45,0)),n.zIndex--,e.zIndex++,this.swapCard(t,t+1),t++}}n>30&&(i=!0)},this),this.node.on(cc.Node.EventType.TOUCH_END,()=>{if(n=0,null!=e){let n=this.getCardPosition(this.cardLine.children.length,t);e.getComponent(o.default).moveCard(.2,n),i||e.getComponent(o.default).onSelect(),i=!1}e=null},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,()=>{if(n=0,null!=e){let n=this.getCardPosition(this.cardLine.children.length,t);e.getComponent(o.default).moveCard(.2,n),i=!1,this.moveAllCardOnHand()}e=null},this)}disableCardTouch(){this.node.off(cc.Node.EventType.TOUCH_START),this.node.off(cc.Node.EventType.TOUCH_MOVE),this.node.off(cc.Node.EventType.TOUCH_END),this.node.off(cc.Node.EventType.TOUCH_CANCEL)}getCardDefinations(){c.default.getInstance().send(new l.default.SendCardDefinations)}receivedCardDefinations(e){(JSON.parse(e.strData).object||[]).forEach(e=>this.cardDefinations.push(new T.default.CardDefination(e))),this.btnShowCardDefinations.node.active=!1}actShowCardDefinations(){g.default.createAndShow(this.node,this.cardDefinations,this.cardFrames)}actShowChat(){C.default.createAndShow(this.node,this.cardDefinations,(e,t)=>{c.default.getInstance().send(new l.default.SendChatRoom(e,t))},(e,t)=>{c.default.getInstance().send(new l.default.SendCheatCards(e,t))})}actSetting(){y.default.createAndShow(this.node,u.default.App.BUNDLE_NAME.TIENLEN,()=>{v.default.createAndShow(this.node)},()=>{c.default.getInstance().send(new l.default.SendRequestLeaveGame)})}isMePlaying(){return this.players[0].isPlaying()}getCardFrame(e){const t=(e<10?"0":"")+e;return this.cardFrames.find(e=>e.name=="labai_"+t)}getCardBackFrame(){return this.cardBackFrame}getCardItem(){return this.cardItem}};b.instance=null,s([A(cc.Label)],b.prototype,"lbRoomId",void 0),s([A(cc.Label)],b.prototype,"lbRoomBet",void 0),s([A(cc.Label)],b.prototype,"lbMatchId",void 0),s([A(r.default)],b.prototype,"players",void 0),s([A(cc.Label)],b.prototype,"lbTimeCountDown",void 0),s([A(cc.Node)],b.prototype,"cardLine",void 0),s([A(cc.Node)],b.prototype,"board",void 0),s([A(cc.Node)],b.prototype,"btnsInGame",void 0),s([A(cc.Label)],b.prototype,"lblToast",void 0),s([A(cc.Node)],b.prototype,"fxMeWin",void 0),s([A(cc.Node)],b.prototype,"fxMeLose",void 0),s([A(cc.Node)],b.prototype,"fxWhoPlayFirst",void 0),s([A(cc.Button)],b.prototype,"btnShowCardDefinations",void 0),s([A(cc.AudioClip)],b.prototype,"backgroundMusic",void 0),s([A(cc.AudioClip)],b.prototype,"winSound",void 0),s([A([cc.SpriteFrame])],b.prototype,"cardFrames",void 0),s([A(cc.SpriteFrame)],b.prototype,"cardBackFrame",void 0),s([A(cc.Prefab)],b.prototype,"cardItem",void 0),b=i=s([O],b),n.default=b,cc._RF.pop()},{"../../Main/Game/src/common/App":void 0,"../../Main/Game/src/common/BroadcastReceiver":void 0,"../../Main/Game/src/common/Common.AudioManager":void 0,"../../Main/Game/src/common/Configs":void 0,"../../Main/Game/src/common/Utils":void 0,"../../Main/Game/src/games/cardgames/PopupCardDefinations":void 0,"../../Main/Game/src/games/cardgames/PopupChatInGame":void 0,"../../Main/Game/src/games/cardgames/PopupSettingInGame":void 0,"../../Main/Game/src/networks/CardGame.Cmd":void 0,"../../Main/Game/src/networks/TienLenNetworkClient":void 0,"./TienLen.Card":"TienLen.Card","./TienLen.CardGroup":"TienLen.CardGroup","./TienLen.Cmd":"TienLen.Cmd","./TienLen.Constant":"TienLen.Constant","./TienLen.ItemPlayerResult":"TienLen.ItemPlayerResult","./TienLen.Listener":"TienLen.Listener","./TienLen.Player":"TienLen.Player","./TienLen.PopupGuide":"TienLen.PopupGuide","./TienLen.PopupMatchResult":"TienLen.PopupMatchResult"}],"TienLen.ItemPlayerResult":[function(e,t,n){"use strict";cc._RF.push(t,"af49eQFqGVKnpFUqosHPApz","TienLen.ItemPlayerResult");var i=this&&this.__decorate||function(e,t,n,i){var s,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(r=(a<3?s(r):a>3?s(t,n,r):s(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.TienLenResult=void 0;const s=e("../../Main/Game/src/common/Utils"),a=e("./TienLen.InGame");var r;n.TienLenResult=class{},function(e){e[e.KHONG_CHOI=1]="KHONG_CHOI",e[e.THANG_THONG_THUONG=2]="THANG_THONG_THUONG",e[e.THANG_BAT_TREO=3]="THANG_BAT_TREO",e[e.THANG_TRANG_SANH_RONG=4]="THANG_TRANG_SANH_RONG",e[e.THANG_TRANG_TU_HEO=5]="THANG_TRANG_TU_HEO",e[e.THANG_TRANG_NAM_DOI_THONG=6]="THANG_TRANG_NAM_DOI_THONG",e[e.THANG_TRANG_SAU_DOI=7]="THANG_TRANG_SAU_DOI",e[e.THANG_TRANG_DONG_MAU_13=8]="THANG_TRANG_DONG_MAU_13",e[e.THANG_TRANG_DONG_MAU_12=9]="THANG_TRANG_DONG_MAU_12",e[e.KET_QUA_HOA=10]="KET_QUA_HOA",e[e.THUA_THONG_THUONG=11]="THUA_THONG_THUONG",e[e.THUA_TREO=12]="THUA_TREO",e[e.THUA_TOI_TRANG=13]="THUA_TOI_TRANG",e[e.THANG_DUT_BA_BICH=20]="THANG_DUT_BA_BICH",e[e.THUA_DUT_BA_BICH=30]="THUA_DUT_BA_BICH",e[e.THUA_THOI_BA_BICH=31]="THUA_THOI_BA_BICH"}(r||(r={}));const{ccclass:o,property:c}=cc._decorator;let l=class extends cc.Component{constructor(){super(...arguments),this.spRank=null,this.lbRank=null,this.labelUserName=null,this.labelMoneyChange=null,this.listCards=null,this.resultWin=null,this.resultLose=null,this.fxResult=null,this.matSprite=[],this.labelFx=null,this.prefabCard=null,this.rankFrames=[]}initItem(e){if(e.rank<this.rankFrames.length?(this.spRank.node.active=!0,this.spRank.spriteFrame=this.rankFrames[e.rank]):(this.spRank.node.active=!1,this.lbRank.string=(e.rank+1).toString()),this.labelUserName.string=e.userName,this.labelMoneyChange.string=e.goldChange>0?"+"+s.default.formatNumber(e.goldChange):s.default.formatNumber(e.goldChange),e.cards)for(let t=0;t<e.cards.length;t++){let n=cc.instantiate(this.prefabCard);n.getComponent(cc.Sprite).spriteFrame=a.default.getInstance().getCardFrame(e.cards[t].id),this.listCards.addChild(n)}switch(e.winTypes){case r.KHONG_CHOI:break;case r.THANG_THONG_THUONG:this.resultLose.active=!1,this.fxResult.active=!1;break;case r.THANG_BAT_TREO:this.resultLose.active=!1,this.fxResult.active=!0,this.fxResult.getComponent(cc.Sprite).setMaterial(0,this.matSprite[0]),this.labelFx.node.color=cc.Color.RED,this.labelFx.string="Th\u1eafng B\u1eaft Treo";break;case r.THANG_TRANG_SANH_RONG:this.resultLose.active=!1,this.fxResult.active=!0,this.fxResult.getComponent(cc.Sprite).setMaterial(0,this.matSprite[0]),this.labelFx.node.color=cc.Color.RED,this.labelFx.string="Th\u1eafng Tr\u1eafng S\u1ea3nh R\u1ed3ng";break;case r.THANG_TRANG_TU_HEO:this.resultLose.active=!1,this.fxResult.active=!0,this.fxResult.getComponent(cc.Sprite).setMaterial(0,this.matSprite[0]),this.labelFx.node.color=cc.Color.RED,this.labelFx.string="Th\u1eafng Tr\u1eafng T\u1ee9 Heo";break;case r.THANG_TRANG_NAM_DOI_THONG:this.resultLose.active=!1,this.fxResult.active=!0,this.fxResult.getComponent(cc.Sprite).setMaterial(0,this.matSprite[0]),this.labelFx.node.color=cc.Color.RED,this.labelFx.string="Th\u1eafng Tr\u1eafng 5 \u0110\xf4i Th\xf4ng";break;case r.THANG_TRANG_SAU_DOI:this.resultLose.active=!1,this.fxResult.active=!0,this.fxResult.getComponent(cc.Sprite).setMaterial(0,this.matSprite[0]),this.labelFx.node.color=cc.Color.RED,this.labelFx.string="Th\u1eafng Tr\u1eafng 6 \u0110\xf4i";break;case r.THANG_TRANG_DONG_MAU_13:this.resultLose.active=!1,this.fxResult.active=!0,this.fxResult.getComponent(cc.Sprite).setMaterial(0,this.matSprite[0]),this.labelFx.node.color=cc.Color.RED,this.labelFx.string="Th\u1eafng Tr\u1eafng \u0110\u1ed3ng M\xe0u";break;case r.KET_QUA_HOA:break;case r.THUA_THONG_THUONG:e.cards&&(this.kiemtraThoiTuQuy(e.cards)?(this.fxResult.active=!0,this.fxResult.getComponent(cc.Sprite).setMaterial(0,this.matSprite[1]),this.labelFx.node.color=cc.Color.GRAY,this.labelFx.string="Th\u1ed1i T\u1ee9 Qu\xfd"):this.kiemtraThoiHeo(e.cards)&&(this.fxResult.active=!0,this.fxResult.getComponent(cc.Sprite).setMaterial(0,this.matSprite[1]),this.labelFx.node.color=cc.Color.GRAY,this.labelFx.string="Th\u1ed1i Heo"));break;case r.THUA_TREO:this.fxResult.active=!0,this.fxResult.getComponent(cc.Sprite).setMaterial(0,this.matSprite[1]),this.labelFx.node.color=cc.Color.GRAY,this.labelFx.string="C\xf3ng";break;case r.THUA_TOI_TRANG:this.fxResult.active=!0,this.fxResult.getComponent(cc.Sprite).setMaterial(0,this.matSprite[1]),this.labelFx.node.color=cc.Color.GRAY,this.labelFx.string="Thua T\u1edbi Tr\u1eafng";break;case r.THANG_DUT_BA_BICH:this.resultLose.active=!1,this.fxResult.active=!0,this.fxResult.getComponent(cc.Sprite).setMaterial(0,this.matSprite[0]),this.labelFx.node.color=cc.Color.RED,this.labelFx.string="Th\u1eafng K\u1ebft 3 B\xedch";break;case r.THUA_DUT_BA_BICH:this.fxResult.active=!0,this.fxResult.getComponent(cc.Sprite).setMaterial(0,this.matSprite[1]),this.labelFx.node.color=cc.Color.GRAY,this.labelFx.string="Thua K\u1ebft 3 B\xedch";break;case r.THUA_THOI_BA_BICH:this.fxResult.active=!0,this.fxResult.getComponent(cc.Sprite).setMaterial(0,this.matSprite[1]),this.labelFx.node.color=cc.Color.GRAY,this.labelFx.string="Thua Th\u1ed1i 3 B\xedch"}}kiemtraThoiHeo(e){for(var t=0,n=0;n<e.length;n++)12==Math.floor(e[n].id/4)&&t++;return 0<t}kiemtraThoiTuQuy(e){if(e.sort(function(e,t){return e.id-t.id}),4<=e.length)for(var t=e.length-1,n=0;0<t;){if(Math.floor(e[t].id/4)==Math.floor(e[t-1].id/4)){if(3==++n)return!0}else n=0;t--}return!1}};i([c(cc.Sprite)],l.prototype,"spRank",void 0),i([c(cc.Label)],l.prototype,"lbRank",void 0),i([c(cc.Label)],l.prototype,"labelUserName",void 0),i([c(cc.Label)],l.prototype,"labelMoneyChange",void 0),i([c(cc.Node)],l.prototype,"listCards",void 0),i([c(cc.Node)],l.prototype,"resultWin",void 0),i([c(cc.Node)],l.prototype,"resultLose",void 0),i([c(cc.Node)],l.prototype,"fxResult",void 0),i([c(cc.Material)],l.prototype,"matSprite",void 0),i([c(cc.Label)],l.prototype,"labelFx",void 0),i([c(cc.Prefab)],l.prototype,"prefabCard",void 0),i([c([cc.SpriteFrame])],l.prototype,"rankFrames",void 0),l=i([o],l),n.default=l,cc._RF.pop()},{"../../Main/Game/src/common/Utils":void 0,"./TienLen.InGame":"TienLen.InGame"}],"TienLen.Listener":[function(e,t,n){"use strict";cc._RF.push(t,"41dcbU82TpP1o8JxtKQ22sH","TienLen.Listener");var i,s=this&&this.__decorate||function(e,t,n,i){var s,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(r=(a<3?s(r):a>3?s(t,n,r):s(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});const a=e("../../Main/Game/src/common/App"),r=e("../../Main/Game/src/common/BroadcastReceiver"),o=e("../../Main/Game/src/common/Configs"),c=e("../../Main/Game/src/networks/Network.InPacket"),l=e("../../Main/Game/src/networks/TienLenNetworkClient"),h=e("./TienLen.Cmd"),d=e("./TienLen.InGame"),u=e("./TienLen.Room"),{ccclass:f,property:g}=cc._decorator;let p=i=class extends cc.Component{constructor(){super(...arguments),this.currentRoomInfo=null,this.pendingCommands=new Map}static getInstance(){return this.instance}static destroyInstance(){this.instance=null}onLoad(){i.instance=this,cc.game.addPersistRootNode(this.node)}start(){r.default.register(r.default.USER_UPDATE_COIN,()=>{var e;null===(e=u.default.getInstance())||void 0===e||e.updateCoinPlayer()},this),r.default.register(r.default.USER_INFO_UPDATED,()=>{var e,t;null===(e=u.default.getInstance())||void 0===e||e.updateInfoPlayer(),null===(t=u.default.getInstance())||void 0===t||t.updateCoinPlayer()},this),r.default.register(r.default.USER_DISCONNECTED,()=>{l.default.getInstance().close()},this),l.default.getInstance().addOnClose(()=>{var e;(null===(e=u.default.getInstance())||void 0===e?void 0:e.isClickBack)||!o.default.Login.IsLogin?this.backToLobby():"TienLen.InGame"===cc.director.getScene().name&&d.default.getInstance()&&d.default.getInstance().isMePlaying()&&l.default.getInstance().shouldAutoReconnect()?(l.default.getInstance().setLoginCallback(()=>{a.default.instance.showLoading(!1),l.default.getInstance().send(new h.default.SendJoinRoom(o.default.App.MONEY_TYPE,this.currentRoomInfo.maxUserPerRoom,this.currentRoomInfo.moneyBet,0))}),a.default.instance.showErrLoading("M\u1ea5t k\u1ebft n\u1ed1i, \u0111ang th\u1eed k\u1ebft n\u1ed1i l\u1ea1i...")):(a.default.instance.showLoading(!1),l.default.getInstance().setForceClose(!0),a.default.instance.alertDialog.showMsgWithOnDismissed("B\u1ea1n \u0111\xe3 m\u1ea5t k\u1ebft n\u1ed1i v\u1edbi server",()=>{this.backToLobby()}))},this),l.default.getInstance().addListener(e=>{var t,n,i,s,r,o,f,g,p,m,T,C,y,v,R;switch(a.default.instance.showLoading(!1),new c.default(e).getCmdId()){case h.default.Code.LOGIN:l.default.getInstance().send(new h.default.SendReconnectRoom);break;case h.default.Code.MONEY_BET_CONFIG:{let n=new h.default.ReceivedMoneyBetConfig(e);cc.log(n),null===(t=u.default.getInstance())||void 0===t||t.receivedMoneyBetConfig(n);break}case h.default.Code.JOIN_ROOM_FAIL:{let t=new h.default.ReceivedJoinRoomFail(e);cc.log(t),a.default.instance.showLoading(!1,15,h.default.Code.JOIN_ROOM),null===(n=u.default.getInstance())||void 0===n||n.receivedJoinRoomFail(t);break}case h.default.Code.JOIN_ROOM_SUCCESS:{let t=new h.default.ReceivedJoinRoomSuccess(e);cc.log(t),a.default.instance.showLoading(!1,15,h.default.Code.JOIN_ROOM),null===(i=u.default.getInstance())||void 0===i||i.receivedJoinRoomSuccess(t);break}case h.default.Code.UPDATE_GAME_INFO:{let t=new h.default.ReceivedUpdateGameInfo(e);cc.log(t),a.default.instance.showLoading(!1,15,h.default.Code.JOIN_ROOM),null===(s=u.default.getInstance())||void 0===s||s.receivedUpdateGameInfo(t);break}case h.default.Code.AUTO_START:{let t=new h.default.ReceivedAutoStart(e);cc.log(t),d.default.getInstance()?d.default.getInstance().receivedAutoStart(t):this.pendingCommands.set(h.default.Code.AUTO_START,t)}break;case h.default.Code.USER_JOIN_ROOM:{let t=new h.default.ReceiveUserJoinRoom(e);cc.log(t),d.default.getInstance()?d.default.getInstance().receivedUserJoinRoom(t):this.pendingCommands.set(h.default.Code.USER_JOIN_ROOM,t)}break;case h.default.Code.FIRST_TURN:{let t=new h.default.ReceivedFirstTurnDecision(e);cc.log(t),d.default.getInstance()?d.default.getInstance().receivedFirstTurnDecision(t):this.pendingCommands.set(h.default.Code.FIRST_TURN,t)}break;case h.default.Code.CHIA_BAI:{let t=new h.default.ReceivedChiaBai(e);cc.log(t),d.default.getInstance()?d.default.getInstance().receivedDealCard(t):this.pendingCommands.set(h.default.Code.CHIA_BAI,t)}break;case h.default.Code.CHANGE_TURN:{let t=new h.default.ReceivedChangeTurn(e);cc.log(t),null===(r=d.default.getInstance())||void 0===r||r.receivedChangeTurn(t)}break;case h.default.Code.DANH_BAI:{let t=new h.default.ReceivedDanhBai(e);cc.log(t),null===(o=d.default.getInstance())||void 0===o||o.receivedSubmitTurn(t)}break;case h.default.Code.BO_LUOT:{let t=new h.default.ReceivedBoluot(e);cc.log(t),null===(f=d.default.getInstance())||void 0===f||f.receivedPassTurn(t)}break;case h.default.Code.END_GAME:{let t=new h.default.ReceivedEndGame(e);cc.log(t),null===(g=d.default.getInstance())||void 0===g||g.receivedEndGame(t)}break;case h.default.Code.UPDATE_MATCH:{let t=new h.default.ReceivedUpdateMatch(e);cc.log(t),null===(p=d.default.getInstance())||void 0===p||p.receivedUpdateMatch(t)}break;case h.default.Code.USER_LEAVE_ROOM:{let t=new h.default.UserLeaveRoom(e);cc.log(t),null===(m=d.default.getInstance())||void 0===m||m.receivedUserLeaveRoom(t)}break;case h.default.Code.CHAT_ROOM:{let t=new h.default.ReceivedChatRoom(e);cc.log(t),null===(T=d.default.getInstance())||void 0===T||T.receivedChatRoom(t)}break;case h.default.Code.CHAT_CHONG:{let t=new h.default.ReceivedChatChong(e);cc.log(t),null===(C=d.default.getInstance())||void 0===C||C.receivedChatChong(t)}break;case h.default.Code.WAIT_4_DOI_THONG:{let t=new h.default.ReceivedWaitBonDoiThong(e);cc.log(t)}break;case h.default.Code.RECONNECT_GAME_ROOM:{let t=new h.default.UserLeaveRoom(e);cc.log(t)}break;case h.default.Code.NOTIFY_KICK_OFF:{let t=new h.default.ReceivedKickOff(e);cc.log(t),null===(y=d.default.getInstance())||void 0===y||y.receivedKickFromRoom(t.reason)}break;case h.default.Code.REQUEST_LEAVE_ROOM:{let t=new h.default.ReceivedNotifyRegOutRoom(e);cc.log(t),null===(v=d.default.getInstance())||void 0===v||v.receivedNotifyUserRegOutRoom(t)}break;case h.default.Code.CARDS_DEFINE:{let t=new h.default.ReceivedCardDefinations(e);cc.log(t),null===(R=d.default.getInstance())||void 0===R||R.receivedCardDefinations(t)}}},this)}backToLobby(){a.default.instance.loadScene("Lobby",()=>{cc.game.removePersistRootNode(this.node),i.destroyInstance(),d.default.destroyInstance(),u.default.destroyInstance()})}setCurrentRoomInfo(e){this.currentRoomInfo=e}releasePendingCommands(){var e,t,n,i;for(const[s,a]of this.pendingCommands.entries())switch(s){case h.default.Code.AUTO_START:null===(e=d.default.getInstance())||void 0===e||e.receivedAutoStart(a);break;case h.default.Code.USER_JOIN_ROOM:null===(t=d.default.getInstance())||void 0===t||t.receivedUserJoinRoom(a);break;case h.default.Code.FIRST_TURN:null===(n=d.default.getInstance())||void 0===n||n.receivedFirstTurnDecision(a);break;case h.default.Code.CHIA_BAI:null===(i=d.default.getInstance())||void 0===i||i.receivedDealCard(a)}this.pendingCommands.clear()}clearPendingCommands(){this.pendingCommands.clear()}};p.instance=null,p=i=s([f],p),n.default=p,cc._RF.pop()},{"../../Main/Game/src/common/App":void 0,"../../Main/Game/src/common/BroadcastReceiver":void 0,"../../Main/Game/src/common/Configs":void 0,"../../Main/Game/src/networks/Network.InPacket":void 0,"../../Main/Game/src/networks/TienLenNetworkClient":void 0,"./TienLen.Cmd":"TienLen.Cmd","./TienLen.InGame":"TienLen.InGame","./TienLen.Room":"TienLen.Room"}],"TienLen.Player":[function(e,t,n){"use strict";cc._RF.push(t,"412f4i4blxDIrSUXZ0FQPQH","TienLen.Player");var i=this&&this.__decorate||function(e,t,n,i){var s,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(r=(a<3?s(r):a>3?s(t,n,r):s(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});const s=e("../../Main/Game/src/common/Utils"),a=e("../../Main/Game/src/common/App"),r=e("./TienLen.Card"),o=e("./TienLen.Constant"),c=e("../../Main/Game/src/common/Configs"),l=e("./TienLen.InGame"),h=e("../../Main/Game/src/common/BroadcastReceiver"),{ccclass:d,property:u}=cc._decorator;let f=class extends cc.Component{constructor(){super(...arguments),this.chatEmotion=null,this.chatMsg=null,this.lblNickname=null,this.lblCoin=null,this.avatar=null,this.card=null,this.lblCardRemain=null,this.timeRemain=null,this.lbAction=null,this.lbCoinChange=null,this.cardLine=null,this.fxKet3Bich=null,this.fxThoi3Bich=null,this.active=!1,this.status=o.default.PlayerStatus.NO_LOGIN,this.timeTurn=0}start(){h.default.send(h.default.SET_SOUND,this.node)}setPlayerInfo(e){this.lblNickname.string=e.nickName,this.setCoin(e.money),this.avatar.spriteFrame=a.default.instance.getAvatarSpriteFrame(e.avatar),this.node.active=!0,this.active=!0}setFirstCard(e){this.card.spriteFrame=l.default.getInstance().getCardFrame(e),this.card.node.active=!0,this.lblCardRemain.node.active=!1}offFirstCard(){this.card.node.active=!1,this.card.spriteFrame=l.default.getInstance().getCardBackFrame()}setCardRemain(e){0!=e?(this.card.node.active=!0,null===this.card.spriteFrame&&(this.card.spriteFrame=l.default.getInstance().getCardBackFrame()),this.lblCardRemain.node.active=!0,this.lblCardRemain.string=e.toString()):this.card.node.active=!1}setTimeRemain(e){this.timeTurn=e,this.timeRemain.fillRange=this.timeTurn/20}update(e){this.timeTurn>0&&(this.timeTurn-=e,this.timeRemain.fillRange=this.timeTurn/20)}setAction(e=""){this.lbAction.string=e}setCoin(e){this.lblCoin.string=s.default.formatNumber(e)}setCoinChange(e){0!==e&&(this.lbCoinChange.string=(e>0?"+":"")+s.default.formatNumber(e),this.scheduleOnce(()=>{this.lbCoinChange.string=""},5))}resetPlayer(){this.node.active=!1,this.active=!1,this.status=o.default.PlayerStatus.NO_LOGIN,this.lblCardRemain.string="",this.card.node.active=!1,this.clearCardLine(),this.setAction()}setCardLine(e){let t=this.cardLine.getComponent(cc.Layout);t.type==cc.Layout.Type.VERTICAL&&(e.length>5?(t.resizeMode=cc.Layout.ResizeMode.CHILDREN,t.node.height=500):t.resizeMode=cc.Layout.ResizeMode.CONTAINER),e.forEach(e=>{var t=cc.instantiate(l.default.getInstance().getCardItem());t.parent=this.cardLine,t.removeComponent(cc.Button),t.getComponent(r.default).setCardData(e)})}clearCardLine(){this.cardLine.removeAllChildren()}showChatEmotion(e){this.chatEmotion.active=!0,this.chatMsg.active=!1,this.chatEmotion.getComponent(sp.Skeleton).setAnimation(0,e,!0),this.scheduleOnce(()=>{this.chatEmotion.active=!1,this.chatMsg.active=!1},3)}showChatMsg(e){this.chatEmotion.active=!1,this.chatMsg.active=!0,this.chatMsg.children[1].getComponent(cc.Label).string=e,this.scheduleOnce(()=>{this.chatEmotion.active=!1,this.chatMsg.active=!1},3)}setNotify(e){this.lbAction.string=e,this.scheduleOnce(()=>{this.lbAction.string=""},1)}isPlaying(){return this.active&&this.status==o.default.PlayerStatus.PLAY}isMe(){return this.lblNickname.string===c.default.Login.Nickname}showEffectKet3Bich(){this.fxKet3Bich.active=!0,this.scheduleOnce(()=>{this.fxKet3Bich.active=!1},4)}showEffectThoi3Bich(){this.fxThoi3Bich.active=!0,this.scheduleOnce(()=>{this.fxThoi3Bich.active=!1},4)}};i([u(cc.Node)],f.prototype,"chatEmotion",void 0),i([u(cc.Node)],f.prototype,"chatMsg",void 0),i([u(cc.Label)],f.prototype,"lblNickname",void 0),i([u(cc.Label)],f.prototype,"lblCoin",void 0),i([u(cc.Sprite)],f.prototype,"avatar",void 0),i([u(cc.Sprite)],f.prototype,"card",void 0),i([u(cc.Label)],f.prototype,"lblCardRemain",void 0),i([u(cc.Sprite)],f.prototype,"timeRemain",void 0),i([u(cc.Label)],f.prototype,"lbAction",void 0),i([u(cc.Label)],f.prototype,"lbCoinChange",void 0),i([u(cc.Node)],f.prototype,"cardLine",void 0),i([u(cc.Node)],f.prototype,"fxKet3Bich",void 0),i([u(cc.Node)],f.prototype,"fxThoi3Bich",void 0),f=i([d],f),n.default=f,cc._RF.pop()},{"../../Main/Game/src/common/App":void 0,"../../Main/Game/src/common/BroadcastReceiver":void 0,"../../Main/Game/src/common/Configs":void 0,"../../Main/Game/src/common/Utils":void 0,"./TienLen.Card":"TienLen.Card","./TienLen.Constant":"TienLen.Constant","./TienLen.InGame":"TienLen.InGame"}],"TienLen.PopupGuide":[function(e,t,n){"use strict";cc._RF.push(t,"412f1CLBihDtYyTqllTYJqj","TienLen.PopupGuide");var i,s=this&&this.__decorate||function(e,t,n,i){var s,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(r=(a<3?s(r):a>3?s(t,n,r):s(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});const a=e("../../Main/Game/src/common/App"),r=e("../../Main/Game/src/common/Configs"),o=e("../../Main/Game/src/common/Dialog"),{ccclass:c,property:l}=cc._decorator;let h=i=class extends o.default{constructor(){super(...arguments),this.scrollPopupGuide=null}static createAndShow(e){null==this.instance||null==this.instance.node?a.default.instance.loadPrefabInBundle(r.default.App.BUNDLE_NAME.TIENLEN,r.default.App.UPDATE_INFO[r.default.App.BUNDLE_NAME.TIENLEN],!0,"res/prefabs/TienLenPopupGuide",(t,n)=>{if(null!=t)return void a.default.instance.alertDialog.showMsg(t);let s=cc.instantiate(n);s.parent=e,this.instance=s.getComponent(i),this.instance.show()}):this.instance.show()}show(){let e=this.scrollPopupGuide.content.getComponentsInChildren(cc.Label);e[0].string="LU\u1eacT CH\u01a0I:",e[1].string="\u2022 S\u1ed1 ng\u01b0\u1eddi ch\u01a1i t\u1ed1i thi\u1ec3u l\xe0 2 ng\u01b0\u1eddi v\xe0 t\u1ed1i \u0111a l\xe0 4 ng\u01b0\u1eddi.\n\u2022 \u0110\u1ed9 l\u1edbn c\xe1c l\xe1 b\xe0i \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo th\u1ee9 t\u1ef1: 3,4,5,6,7,8,9,10,J,Q,K,A,2. Trong \u0111\xf3 nh\u1ecf nh\u1ea5t l\xe0 3 v\xe0 l\u1edbn nh\u1ea5t l\xe0 2 (Heo).\n\u2022 \u0110\u1ed9 l\u1edbn v\u1ec1 ch\u1ea5t \u0111\u01b0\u1ee3c t\xednh nh\u01b0 sau: \n  C\u01a1 > R\xf4 > T\xe9p > B\xedch\n\u2022 Khi v\xe1n b\xe0i b\u1eaft \u0111\u1ea7u, m\u1ed7i ng\u01b0\u1eddi ch\u01a1i s\u1ebd \u0111\u01b0\u1ee3c chia 13 l\xe1 b\xe0i.\n\u2022 L\u01b0\u1ee3t ch\u01a1i s\u1ebd t\xednh theo ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3.\n\n",e[2].string="CH\u1eb6T H\xc0NG:",e[3].string="\u2022 Ba \u0110\xf4i Th\xf4ng ch\u1eb7t \u0111\u01b0\u1ee3c: m\u1ed9t c\xe2y 2 ho\u1eb7c Ba \u0110\xf4i Th\xf4ng nh\u1ecf h\u01a1n (Ba \u0110\xf4i Th\xf4ng \u0111\xe8).\n\u2022 T\u1ee9 Qu\xfd ch\u1eb7t \u0111\u01b0\u1ee3c: 1 c\xe2y 2 ho\u1eb7c \u0110\xf4i 2, Ba \u0110\xf4i Th\xf4ng ho\u1eb7c T\u1ee9 Qu\xfd nh\u1ecf h\u01a1n.\n\u2022 T\u1ee9 \u0110\xf4i Th\xf4ng ch\u1eb7t \u0111\u01b0\u1ee3c: m\u1ed9t c\xe2y 2 ho\u1eb7c \u0110\xf4i 2 b\u1ea5t k\u1ef3, Ba ho\u1eb7c T\u1ee9 \u0110\xf4i Th\xf4ng nh\u1ecf h\u01a1n (T\u1ee9 \u0110\xf4i Th\xf4ng \u0111\xe8) ho\u1eb7c T\u1ee9 Qu\xfd.\n\u2022 L\u01b0u \xfd: T\u1ee9 \u0110\xf4i Th\xf4ng kh\xf4ng v\xf4 v\xf2ng t\u1ef1 do.\n\u2022 \u0102n tr\u1eafng: S\u1ea3nh r\u1ed3ng \u0111\u1ed3ng hoa > S\u1ea3nh r\u1ed3ng > \u0110\u1ed3ng hoa > 6 \u0111\xf4i th\xf4ng > 5 \u0111\xf4i th\xf4ng > 6 \u0111\xf4i > t\u1ee9 qu\xfd heo.\n\n",e[4].string="T\xcdNH TI\u1ec0N:",e[5].string="\u2022 Heo \u0111\u1ecf: Ph\u1ea1t 6 l\xe1.\n\u2022 Heo \u0111en: Ph\u1ea1t 3 l\xe1.\n\u2022 Ba \u0110\xf4i Th\xf4ng: Ph\u1ea1t 12 l\xe1.\n\u2022 T\u1ee9 Qu\xfd: Ph\u1ea1t 12 l\xe1.\n\u2022 T\u1ee9 \u0110\xf4i Th\xf4ng: Ph\u1ea1t 16 l\xe1.\n\u2022 C\xf3ng: Thua 26 l\xe1 + t\xednh th\u1ed1i heo, ba \u0111\xf4i th\xf4ng, t\u1ee9 qu\xfd, t\u1ee9 \u0111\xf4i th\xf4ng.\n\u2022 T\u1edbi tr\u1eafng: M\u1ed7i ng\u01b0\u1eddi c\xf2n l\u1ea1i s\u1ebd b\u1ecb thua 26 l\xe1.\n\u2022 K\u1ebft 3 b\xedch: M\u1ed7i ng\u01b0\u1eddi c\xf2n l\u1ea1i s\u1ebd b\u1ecb thua 26 l\xe1.\n\u2022 Th\u1ed1i 3 b\xedch(l\xe1 cu\u1ed1i 3 b\xedch): Ph\u1ea1t 26 l\xe1.",super.show(),this.scrollPopupGuide.scrollToTop(0)}};h.instance=null,s([l(cc.ScrollView)],h.prototype,"scrollPopupGuide",void 0),h=i=s([c],h),n.default=h,cc._RF.pop()},{"../../Main/Game/src/common/App":void 0,"../../Main/Game/src/common/Configs":void 0,"../../Main/Game/src/common/Dialog":void 0}],"TienLen.PopupMatchResult":[function(e,t,n){"use strict";cc._RF.push(t,"b79afV/LRBPA6Rfy5J7Uwez","TienLen.PopupMatchResult");var i,s=this&&this.__decorate||function(e,t,n,i){var s,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(r=(a<3?s(r):a>3?s(t,n,r):s(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});const a=e("../../Main/Game/src/common/App"),r=e("../../Main/Game/src/common/Configs"),o=e("../../Main/Game/src/common/Dialog"),c=e("./TienLen.ItemPlayerResult"),{ccclass:l,property:h}=cc._decorator;let d=i=class extends o.default{constructor(){super(...arguments),this.scrollPopupResult=null,this.prefabPlayerResult=null}static createAndShow(e,t){null==this.instance||null==this.instance.node?a.default.instance.loadPrefabInBundle(r.default.App.BUNDLE_NAME.TIENLEN,r.default.App.UPDATE_INFO[r.default.App.BUNDLE_NAME.TIENLEN],!0,"res/prefabs/TienLenPopupMatchResult",(n,s)=>{if(null!=n)return void a.default.instance.alertDialog.showMsg(n);let r=cc.instantiate(s);r.parent=e,this.instance=r.getComponent(i),this.instance.showResult(t)}):this.instance.showResult(t)}showResult(e){super.show(),this.scrollPopupResult.content.removeAllChildren(),e.forEach(e=>{let t=cc.instantiate(this.prefabPlayerResult).getComponent(c.default);t.initItem(e),this.scrollPopupResult.content.addChild(t.node)}),this.scrollPopupResult.scrollToTop(0)}};d.instance=null,s([h(cc.ScrollView)],d.prototype,"scrollPopupResult",void 0),s([h(cc.Prefab)],d.prototype,"prefabPlayerResult",void 0),d=i=s([l],d),n.default=d,cc._RF.pop()},{"../../Main/Game/src/common/App":void 0,"../../Main/Game/src/common/Configs":void 0,"../../Main/Game/src/common/Dialog":void 0,"./TienLen.ItemPlayerResult":"TienLen.ItemPlayerResult"}],"TienLen.Room":[function(e,t,n){"use strict";cc._RF.push(t,"9ac265kyMdCZ6G4GL5Q1zxj","TienLen.Room");var i,s=this&&this.__decorate||function(e,t,n,i){var s,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(r=(a<3?s(r):a>3?s(t,n,r):s(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});const a=e("../../Main/Game/src/networks/TienLenNetworkClient"),r=e("./TienLen.Cmd"),o=e("../../Main/Game/src/common/Tween"),c=e("../../Main/Game/src/common/Configs"),l=e("../../Main/Game/src/common/Utils"),h=e("../../Main/Game/src/common/App"),d=e("../../Main/Game/src/common/BroadcastReceiver"),u=e("./TienLen.InGame"),f=e("../../Main/Lobby/src/Lobby.PopupCashOut"),g=e("../../Main/Game/src/games/cardgames/ItemRoom"),p=e("./TienLen.Listener"),{ccclass:m,property:T}=cc._decorator;let C=i=class extends cc.Component{constructor(){super(...arguments),this.scrollListRoom=null,this.roomItem=null,this.lbCoin=null,this.lbName=null,this.avatar=null,this.listRoom=[],this._isClickBack=!1}static getInstance(){return this.instance}static destroyInstance(){this.instance=null}onLoad(){i.instance=this}start(){d.default.send(d.default.SET_SOUND,this.node),cc.director.preloadScene("TienLen.InGame"),this.sendGetListRoom(),this.updateInfoPlayer(),this.updateCoinPlayer(),this.isClickBack=!1}set isClickBack(e){this._isClickBack=e}get isClickBack(){return this._isClickBack}updateCoinPlayer(){o.default.numberTo(this.lbCoin,c.default.Login.Coin,.3)}updateInfoPlayer(){this.lbName.string=c.default.Login.Nickname,this.avatar.spriteFrame=h.default.instance.getAvatarSpriteFrame(c.default.Login.Avatar)}receivedMoneyBetConfig(e){this.initRooms(e.list)}initRooms(e){this.scrollListRoom.content.removeAllChildren(),[...new Set(e)].filter(e=>e.moneyType===c.default.App.MONEY_TYPE&&2===e.maxUserPerRoom).map(e=>e.moneyBet).forEach((t,n)=>{let i=0,s=0,a=0;e.forEach(e=>{e.moneyBet===t&&2==e.maxUserPerRoom&&(i+=e.nPersion,s=e.maxUserPerRoom,a=e.moneyRequire)}),this.listRoom.push(new g.RoomItemInfo(n+1,t,a,i,s))}),this.listRoom.sort((e,t)=>e.moneyBet-t.moneyBet),this.listRoom.forEach((e,t)=>{const n=cc.instantiate(this.roomItem);n.getComponent(g.default).initItem(e),n.on(cc.Node.EventType.TOUCH_END,()=>{var t;c.default.Login.Coin<e.requiredMoney?h.default.instance.actiontDialog.showMsgWithAction("S\u1ed1 d\u01b0 kh\xf4ng \u0111\u1ee7.","N\u1ea0P NGAY",()=>{h.default.instance.openShop(0)}):(h.default.instance.showLoading(!0,15,r.default.Code.JOIN_ROOM),a.default.getInstance().send(new r.default.SendJoinRoom(c.default.App.MONEY_TYPE,e.maxUserPerRoom,e.moneyBet,0)),null===(t=p.default.getInstance())||void 0===t||t.setCurrentRoomInfo(e))}),n.parent=this.scrollListRoom.content,n.y=-30;let i=.2*.7*(1===t?.8:1-Math.pow(2,-10*t));n.runAction(cc.sequence(cc.fadeOut(0),cc.delayTime(.105*(this.listRoom.length-t)),cc.spawn(cc.fadeIn(i),cc.moveTo(i,cc.v2(0,-30-85*t)).easing(cc.easeCircleActionOut()))))}),this.scrollListRoom.scrollToBottom(0),this.scrollListRoom.scrollToTop(2)}actBack(e){this.isClickBack=!0,a.default.getInstance().close()}show(e){this.node.active=e,e&&(d.default.send(d.default.USER_UPDATE_COIN),this.sendGetListRoom())}sendGetListRoom(){a.default.getInstance().send(new r.default.SendMoneyBetConfig)}actExchange(){f.default.createAndShow(this.node)}actQuickPlay(){let e=this.listRoom.filter(e=>e.requiredMoney<=c.default.Login.Coin);if(e.length<=0)return void h.default.instance.actiontDialog.showMsgWithAction("S\u1ed1 d\u01b0 kh\xf4ng \u0111\u1ee7.","N\u1ea0P NGAY",()=>{h.default.instance.openShop(0)});let t=e[l.default.randomRangeInt(0,e.length)];h.default.instance.showLoading(!0,15,r.default.Code.JOIN_ROOM),a.default.getInstance().send(new r.default.SendJoinRoom(c.default.App.MONEY_TYPE,t.maxUserPerRoom,t.moneyBet,0))}actHideFullyRoom(e){this.scrollListRoom.content.children.forEach(t=>{t.active=!e.isChecked||t.getComponent(g.default).isFull()})}receivedJoinRoomFail(e){let t="";switch(e.error){case 1:t="L\u1ed7i ki\u1ec3m tra th\xf4ng tin!";break;case 2:t="Kh\xf4ng t\xecm \u0111\u01b0\u1ee3c ph\xf2ng th\xedch h\u1ee3p. Vui l\xf2ng th\u1eed l\u1ea1i sau!";break;case 3:t="B\u1ea1n kh\xf4ng \u0111\u1ee7 ti\u1ec1n v\xe0o ph\xf2ng ch\u01a1i n\xe0y!";break;case 4:t="Kh\xf4ng t\xecm \u0111\u01b0\u1ee3c ph\xf2ng th\xedch h\u1ee3p. Vui l\xf2ng th\u1eed l\u1ea1i sau!";break;case 5:t="M\u1ed7i l\u1ea7n v\xe0o ph\xf2ng ph\u1ea3i c\xe1ch nhau 10 gi\xe2y!";break;case 6:t="H\u1ec7 th\u1ed1ng b\u1ea3o tr\xec!";break;case 7:t="Kh\xf4ng t\xecm th\u1ea5y ph\xf2ng ch\u01a1i!";break;case 8:t="M\u1eadt kh\u1ea9u ph\xf2ng ch\u01a1i kh\xf4ng \u0111\xfang!";break;case 9:t="Ph\xf2ng ch\u01a1i \u0111\xe3 \u0111\u1ee7 ng\u01b0\u1eddi!";break;case 10:t="B\u1ea1n b\u1ecb ch\u1ee7 ph\xf2ng kh\xf4ng cho v\xe0o b\xe0n!"}h.default.instance.alertDialog.showMsg(t)}receivedJoinRoomSuccess(e){h.default.instance.showLoading(!0),cc.director.loadScene("TienLen.InGame",t=>{var n;h.default.instance.showLoading(!1),t?null===(n=p.default.getInstance())||void 0===n||n.clearPendingCommands():u.default.getInstance().updateRoomInfo(u.TienLenRoomInfoDTO.fromReceivedJoinRoomSuccess(e))})}receivedUpdateGameInfo(e){h.default.instance.showLoading(!0),cc.director.loadScene("TienLen.InGame",t=>{var n;h.default.instance.showLoading(!1),t?null===(n=p.default.getInstance())||void 0===n||n.clearPendingCommands():u.default.getInstance().updateRoomInfo(u.TienLenRoomInfoDTO.fromReceivedUpdateGameInfo(e))})}tabRoomCheckEvent(e){switch(e.node.name){case"tabAll":this.scrollListRoom.content.children.forEach(e=>{e.active=!0});break;case"tab2":this.scrollListRoom.content.children.forEach(e=>{e.active=2===e.getComponent(g.default).getRoomInfo().maxUserPerRoom});break;case"tab4":this.scrollListRoom.content.children.forEach(e=>{e.active=4===e.getComponent(g.default).getRoomInfo().maxUserPerRoom})}}};C.instance=null,s([T(cc.ScrollView)],C.prototype,"scrollListRoom",void 0),s([T(cc.Prefab)],C.prototype,"roomItem",void 0),s([T(cc.Label)],C.prototype,"lbCoin",void 0),s([T(cc.Label)],C.prototype,"lbName",void 0),s([T(cc.Sprite)],C.prototype,"avatar",void 0),C=i=s([m],C),n.default=C,cc._RF.pop()},{"../../Main/Game/src/common/App":void 0,"../../Main/Game/src/common/BroadcastReceiver":void 0,"../../Main/Game/src/common/Configs":void 0,"../../Main/Game/src/common/Tween":void 0,"../../Main/Game/src/common/Utils":void 0,"../../Main/Game/src/games/cardgames/ItemRoom":void 0,"../../Main/Game/src/networks/TienLenNetworkClient":void 0,"../../Main/Lobby/src/Lobby.PopupCashOut":void 0,"./TienLen.Cmd":"TienLen.Cmd","./TienLen.InGame":"TienLen.InGame","./TienLen.Listener":"TienLen.Listener"}]},{},["TienLen.Card","TienLen.CardGroup","TienLen.Cmd","TienLen.Constant","TienLen.InGame","TienLen.ItemPlayerResult","TienLen.Listener","TienLen.Player","TienLen.PopupGuide","TienLen.PopupMatchResult","TienLen.Room"]);