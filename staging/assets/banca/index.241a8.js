window.__require=function t(e,i,s){function o(a,c){if(!i[a]){if(!e[a]){var l=a.split("/");if(l=l[l.length-1],!e[l]){var h="function"==typeof __require&&__require;if(!c&&h)return h(l,!0);if(n)return n(l,!0);throw new Error("Cannot find module '"+a+"'")}a=l}var r=i[a]={exports:{}};e[a][0].call(r.exports,function(t){return o(e[a][1][t]||t)},r,r.exports,t,e,i,s)}return i[a].exports}for(var n="function"==typeof __require&&__require,a=0;a<s.length;a++)o(s[a]);return o}({"ShootFish.Bullet":[function(t,e,i){"use strict";cc._RF.push(e,"36d2bcC+d9JWLYn26kehzX6","ShootFish.Bullet");var s=this&&this.__decorate||function(t,e,i,s){var o,n=arguments.length,a=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,s);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(n<3?o(a):n>3?o(e,i,a):o(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const o=t("../../Main/Game/src/common/BroadcastReceiver"),n=t("../../Main/Game/src/common/Utils"),a=t("./ShootFish.Play"),{ccclass:c,property:l}=cc._decorator;let h=class extends cc.Component{constructor(){super(...arguments),this.bullet=null,this.fishNet=null,this.id="",this.targetFishId=-1,this.worldSize=cc.size(1280,720),this.exploreDuration=.8,this.vX=0,this.vY=0,this.collisionCount=4,this.isExplored=!1,this.isExploring=!1,this.curExplore=0,this.circle=null}onLoad(){o.default.send(o.default.SET_SOUND,this.node)}run(){let t=Number(a.default.SERVER_CONFIG.BulletSpeed);(isNaN(t)||0==t)&&(t=1400);let e=n.default.degreesToVec2(this.node.angle);this.vX=e.x*t,this.vY=e.y*t,this.collisionCount=4,this.isExplored=!1,this.isExploring=!1,this.bullet.active=!0,this.fishNet.active=!1,this.circle=new SAT.Circle(new SAT.Vector(this.node.position.x,this.node.position.y),Number(a.default.SERVER_CONFIG.BulletRadius))}updateRealTime(t){if(!this.isExplored){if(this.isExploring)return this.curExplore-=t,void(this.curExplore<=0&&(this.isExplored=!0,this.node.active=!1));var e=this.node.position;if(e.x+=this.vX*t,e.y+=this.vY*t,this.node.position=e,Math.abs(e.x)>this.worldSize.width/2){this.vX*=-1;var i=Math.atan2(this.vY,this.vX)*n.default.Rad2Deg;this.node.angle=i,e.x=(e.x<0?-1:1)*this.worldSize.width/2,this.node.position=e,this.collisionCount--}else Math.abs(e.y)>this.worldSize.height/2&&(this.vY*=-1,i=Math.atan2(this.vY,this.vX)*n.default.Rad2Deg,this.node.angle=i,e.y=(e.y<0?-1:1)*this.worldSize.height/2,this.node.position=e,this.collisionCount--);this.circle.pos=new SAT.Vector(this.node.position.x,this.node.position.y),this.collisionCount<0&&(this.node.active=!1)}}explore(){this.isExploring=!0,this.curExplore=this.exploreDuration,this.bullet.active=!1,this.fishNet.active=!0,this.fishNet.opacity=0,this.fishNet.angle=0,this.fishNet.scale=0,this.fishNet.stopAllActions(),this.fishNet.runAction(cc.spawn(cc.sequence(cc.scaleTo(.3,1.1),cc.delayTime(.07),cc.scaleTo(.3,1)),cc.fadeIn(.1),cc.sequence(cc.delayTime(.25),cc.rotateTo(.5,35)),cc.sequence(cc.delayTime(.4),cc.fadeOut(.3))))}getCircle(){return this.circle}};s([l(cc.Node)],h.prototype,"bullet",void 0),s([l(cc.Node)],h.prototype,"fishNet",void 0),h=s([c],h),i.default=h,cc._RF.pop()},{"../../Main/Game/src/common/BroadcastReceiver":void 0,"../../Main/Game/src/common/Utils":void 0,"./ShootFish.Play":"ShootFish.Play"}],"ShootFish.CoinEffect":[function(t,e,i){"use strict";cc._RF.push(e,"f3de4Savp5BHqfZYOvwMNmn","ShootFish.CoinEffect");var s=this&&this.__decorate||function(t,e,i,s){var o,n=arguments.length,a=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,s);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(n<3?o(a):n>3?o(e,i,a):o(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const o=t("../../Main/Game/src/common/Utils"),{ccclass:n,property:a}=cc._decorator;let c=class extends cc.Component{constructor(){super(...arguments),this.lblCoin=null,this.coinExplore=null,this.coin0=null,this.coin1=null,this.coin2=null}run(t,e,i){this.coinExplore.node.position=e,this.coin0.stopAllActions(),this.coin0.position=e.clone().add(cc.v2(o.default.randomRange(80,-80),o.default.randomRange(80,-80))),this.coin0.scale=0,this.coin1.stopAllActions(),this.coin1.position=e.clone().add(cc.v2(o.default.randomRange(80,-80),o.default.randomRange(80,-80))),this.coin1.scale=0,this.coin2.stopAllActions(),this.coin2.position=e.clone().add(cc.v2(o.default.randomRange(80,-80),o.default.randomRange(80,-80))),this.coin2.scale=0,this.lblCoin.string=o.default.formatNumber(t),this.lblCoin.node.position=e,this.lblCoin.node.stopAllActions(),this.lblCoin.node.opacity=0,this.lblCoin.node.scale=0,this.lblCoin.node.runAction(cc.sequence(cc.spawn(cc.fadeIn(.2),cc.scaleTo(.2,1)),cc.moveBy(.1,new cc.Vec2(0,5)),cc.moveBy(.1,new cc.Vec2(0,-5)),cc.moveBy(.1,new cc.Vec2(0,5)),cc.moveBy(.1,new cc.Vec2(0,-5)),cc.moveBy(.1,new cc.Vec2(0,5)),cc.moveBy(.1,new cc.Vec2(0,-5)),cc.moveBy(.1,new cc.Vec2(0,5)),cc.moveBy(.1,new cc.Vec2(0,-5)),cc.fadeOut(.15))),this.coinExplore.setAnimation(0,"Idle",!1),this.coin0.runAction(cc.sequence(cc.scaleTo(.15,o.default.randomRange(.7,1)),cc.delayTime(.4),cc.moveBy(.1,new cc.Vec2(0,50)),cc.moveBy(.1,new cc.Vec2(0,-50)),cc.moveBy(.1,new cc.Vec2(0,50)),cc.moveBy(.1,new cc.Vec2(0,-50)),cc.moveTo(.7,i),cc.scaleTo(.15,0))),this.coin1.runAction(cc.sequence(cc.scaleTo(.15,o.default.randomRange(.7,1)),cc.delayTime(.55),cc.moveBy(.1,new cc.Vec2(0,50)),cc.moveBy(.1,new cc.Vec2(0,-50)),cc.moveBy(.1,new cc.Vec2(0,50)),cc.moveBy(.1,new cc.Vec2(0,-50)),cc.moveTo(.7,i),cc.scaleTo(.15,0))),this.coin2.runAction(cc.sequence(cc.scaleTo(.15,o.default.randomRange(.7,1)),cc.delayTime(.7),cc.moveBy(.1,new cc.Vec2(0,50)),cc.moveBy(.1,new cc.Vec2(0,-50)),cc.moveBy(.1,new cc.Vec2(0,50)),cc.moveBy(.1,new cc.Vec2(0,-50)),cc.moveTo(.7,i),cc.scaleTo(.15,0),cc.callFunc(()=>{this.node.active=!1})))}};s([a(cc.Label)],c.prototype,"lblCoin",void 0),s([a(sp.Skeleton)],c.prototype,"coinExplore",void 0),s([a(cc.Node)],c.prototype,"coin0",void 0),s([a(cc.Node)],c.prototype,"coin1",void 0),s([a(cc.Node)],c.prototype,"coin2",void 0),c=s([n],c),i.default=c,cc._RF.pop()},{"../../Main/Game/src/common/Utils":void 0}],"ShootFish.EffectBigWin":[function(t,e,i){"use strict";cc._RF.push(e,"3e4a4YbN9FGnbtYmPvTrs9e","ShootFish.EffectBigWin");var s=this&&this.__decorate||function(t,e,i,s){var o,n=arguments.length,a=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,s);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(n<3?o(a):n>3?o(e,i,a):o(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const o=t("../../Main/Game/src/common/Utils"),{ccclass:n,property:a}=cc._decorator;let c=class extends cc.Component{constructor(){super(...arguments),this.skeleton=null,this.lblNickname=null,this.lblCoin=null}show(t,e=null,i=0){this.node.stopAllActions(),t?(this.lblCoin.string=o.default.formatNumber(i),this.lblCoin.node.active=!1,this.lblNickname.string=e,this.lblNickname.node.active=!1,this.skeleton.setAnimation(0,"animation",!1),this.node.active=!0,this.node.runAction(cc.sequence(cc.delayTime(.7),cc.callFunc(()=>{this.lblNickname.node.active=!0,this.lblCoin.node.active=!0}),cc.delayTime(3),cc.callFunc(()=>{this.node.active=!1})))):this.node.active=!1}};s([a(sp.Skeleton)],c.prototype,"skeleton",void 0),s([a(cc.Label)],c.prototype,"lblNickname",void 0),s([a(cc.Label)],c.prototype,"lblCoin",void 0),c=s([n],c),i.default=c,cc._RF.pop()},{"../../Main/Game/src/common/Utils":void 0}],"ShootFish.EffectJackpot":[function(t,e,i){"use strict";cc._RF.push(e,"ce53aga3XZMIaymrxUZy+Ja","ShootFish.EffectJackpot");var s=this&&this.__decorate||function(t,e,i,s){var o,n=arguments.length,a=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,s);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(n<3?o(a):n>3?o(e,i,a):o(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const o=t("../../Main/Game/src/common/Utils"),{ccclass:n,property:a}=cc._decorator;let c=class extends cc.Component{constructor(){super(...arguments),this.skeletons=[],this.lblNickname=null,this.lblCoin=null}show(t,e=null,i=0){if(this.node.stopAllActions(),t){this.lblCoin.string=o.default.formatNumber(i),this.lblCoin.node.active=!1,this.lblNickname.string=e,this.lblNickname.node.active=!1;for(let t=0;t<this.skeletons.length;t++)this.skeletons[t].setAnimation(0,"Idle",!1);this.node.active=!0,this.node.runAction(cc.sequence(cc.delayTime(.7),cc.callFunc(()=>{this.lblNickname.node.active=!0,this.lblCoin.node.active=!0}),cc.delayTime(5),cc.callFunc(()=>{this.node.active=!1})))}else this.node.active=!1}};s([a([sp.Skeleton])],c.prototype,"skeletons",void 0),s([a(cc.Label)],c.prototype,"lblNickname",void 0),s([a(cc.Label)],c.prototype,"lblCoin",void 0),c=s([n],c),i.default=c,cc._RF.pop()},{"../../Main/Game/src/common/Utils":void 0}],"ShootFish.Fish":[function(t,e,i){"use strict";cc._RF.push(e,"8dcf1d04CtOE75piBWi/t9b","ShootFish.Fish");var s=this&&this.__decorate||function(t,e,i,s){var o,n=arguments.length,a=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,s);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(n<3?o(a):n>3?o(e,i,a):o(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const o=t("./ShootFish.Play"),n=t("../../Main/Game/src/common/Utils"),a=t("../../Main/Game/src/networks/ShootFishNetworkClient"),{ccclass:c,property:l}=cc._decorator;let h=class extends cc.Component{constructor(){super(...arguments),this.anim=null,this.lblId=null,this.isDie=!1,this.type=-1,this.polygon=null,this.dataPointsUpdate=[],this.currentStep=0,this.currentTimeStep=-1,this.currentVStepX=0,this.currentVStepY=0}setData(t){if(this.id=t.id,this.lblId.string=this.id.toString(),t.h<=0||0==t.path.length)return this.die(),void(0==t.path.length&&console.log("fishData path length = 0"));if(this.type!=t.t){this.type=t.t,this.anim.removeAllChildren(),cc.instantiate(o.default.instance.getFishAnimByType(this.type)).parent=this.anim;let e=t.H,i=t.w;this.polygon=new SAT.Box(new SAT.Vector(0,0),e,i).toPolygon(),this.polygon.translate(-e/2,-i/2),this.node.width=e,this.node.height=i}let e=Number(t.dx),i=Number(t.dy),s=Number(t.px),c=Number(t.py),l=t.path,h=a.default.serverCurrentTimeMillis();this.node.angle=Math.atan2(i,e)*n.default.Rad2Deg;let r=[];for(var d=0;d<l.length;d++){var u={t:Number(l[d].t)};switch(u.p=cc.v2(Number(l[d].x),Number(l[d].y)),o.default.instance.mePlayer.serverPos){case 1:u.p=cc.v2(-Number(l[d].x),Number(l[d].y));break;case 2:u.p=cc.v2(-Number(l[d].x),-Number(l[d].y));break;case 3:u.p=cc.v2(Number(l[d].x),-Number(l[d].y))}r.push(u)}switch(this.node.position=cc.v2(s,c),o.default.instance.mePlayer.serverPos){case 1:this.node.position=cc.v2(-s,c);break;case 2:this.node.position=cc.v2(-s,-c);break;case 3:this.node.position=cc.v2(s,-c)}let p=!0,f=-1;this.dataPointsUpdate.length=0;for(let o=1;o<r.length;o++){let t=r[o-1],e=r[o],i=t.p,s=e.p,a=t.t,c=e.t;if(h-c<0){f<0&&(f=o);let t=s.clone().sub(i),e=Math.atan2(t.y,t.x)*n.default.Rad2Deg,l=0;p?(l=(c-h)/1e3,p=!1):l=(c-a)/1e3,this.dataPointsUpdate.push({p:s,t:l,a:e,tms:c})}}if(this.currentTimeStep=-1,this.currentStep=0,this.currentVStepX=0,this.currentVStepY=0,this.dataPointsUpdate.length>0){this.currentTimeStep=this.dataPointsUpdate[this.currentStep].t;let t=this.dataPointsUpdate[this.currentStep].p.sub(this.node.position);this.currentVStepX=t.x/this.currentTimeStep,this.currentVStepY=t.y/this.currentTimeStep,this.node.angle=this.dataPointsUpdate[this.currentStep].a}else console.log("can't find path: "+this.id);this.isDie=!1,this.node.active=!0}updateRealTime(t){if(this.node.active&&!this.isDie&&this.dataPointsUpdate.length>0&&this.currentTimeStep>=0){let e=this.node.position;if(this.currentTimeStep-=t,this.currentTimeStep<0&&(this.currentStep++,this.currentStep<this.dataPointsUpdate.length)){this.currentTimeStep=this.dataPointsUpdate[this.currentStep].t+Math.abs(this.currentTimeStep),this.node.angle=this.dataPointsUpdate[this.currentStep].a,this.polygon.angle=this.node.angle*n.default.Deg2Rad;let t=this.dataPointsUpdate[this.currentStep].p.sub(e);this.currentVStepX=t.x/this.currentTimeStep,this.currentVStepY=t.y/this.currentTimeStep}e.x+=this.currentVStepX*t,e.y+=this.currentVStepY*t,this.node.position=e}}die(){this.isDie=!0,this.node.active=!1}getPolygon(){return this.polygon.pos=new SAT.Vector(this.node.position.x,this.node.position.y),this.polygon}hurt(){if(0!=this.anim.children.length&&0!=this.anim.children[0].children.length){this.anim.children[0].children[0].stopActionByTag(99);var t=cc.sequence(cc.tintTo(.05,255,54,54),cc.delayTime(.1),cc.tintTo(.05,255,255,255));t.setTag(99),this.anim.children[0].children[0].runAction(t)}}};s([l(cc.Node)],h.prototype,"anim",void 0),s([l(cc.Label)],h.prototype,"lblId",void 0),h=s([c],h),i.default=h,cc._RF.pop()},{"../../Main/Game/src/common/Utils":void 0,"../../Main/Game/src/networks/ShootFishNetworkClient":void 0,"./ShootFish.Play":"ShootFish.Play"}],"ShootFish.Lobby":[function(t,e,i){"use strict";cc._RF.push(e,"4378bty4U5E8KWt2uwkMkhd","ShootFish.Lobby");var s,o=this&&this.__decorate||function(t,e,i,s){var o,n=arguments.length,a=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,s);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(n<3?o(a):n>3?o(e,i,a):o(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=t("./ShootFish.Play"),a=t("../../Main/Game/src/common/App"),c=t("../../Main/Game/src/common/Configs"),l=t("./ShootFish.PopupCoinTransfer"),h=t("../../Main/Game/src/common/Utils"),r=t("../../Main/Game/src/common/BroadcastReceiver"),d=t("../../Main/Game/src/networks/MiniGameNetworkClient"),u=t("../../Main/Game/src/networks/Network.InPacket"),p=t("../../Main/Lobby/src/Lobby.Cmd"),f=t("../../Main/Game/src/networks/ShootFishNetworkClient"),g=t("../../Main/Game/src/common/Common.AudioManager"),{ccclass:m,property:b}=cc._decorator;let v=s=class extends cc.Component{constructor(){super(...arguments),this.playNode=null,this.lblBalance=null,this.popupCoinTransfer=null,this.clipBgm=null,this.clipClick=null,this.play=null}onLoad(){r.default.send(r.default.SET_SOUND,cc.find("Canvas")),s.instance=this,this.play=this.playNode.getComponent(n.default),this.play.node.active=!1,this.lblBalance.string=h.default.formatNumber(c.default.Login.CoinFish),r.default.register(r.default.USER_UPDATE_COIN,()=>{this.lblBalance.string=h.default.formatNumber(c.default.Login.CoinFish)},this),f.default.getInstance().checkConnect(t=>{t?(n.default.SERVER_CONFIG=c.default.Login.FishConfigs,r.default.send(r.default.USER_UPDATE_COIN),c.default.Login.CoinFish<=0&&a.default.instance.confirmDialog.show3("Ti\u1ec1n trong B\u1eafn C\xe1 c\u1ee7a b\u1ea1n \u0111\xe3 h\u1ebft, b\u1ea1n c\xf3 mu\u1ed1n chuy\u1ec3n ti\u1ec1n v\xe0o kh\xf4ng?","C\xf3",t=>{t&&this.popupCoinTransfer.show()})):a.default.instance.alertDialog.showMsgWithOnDismissed("\u0110\u0103ng nh\u1eadp th\u1ea5t b\u1ea1i, vui l\xf2ng th\u1eed l\u1ea1i.",()=>{this.actBack()})}),f.default.getInstance().addOnClose(()=>{a.default.instance.showErrLoading("M\u1ea5t k\u1ebft n\u1ed1i, \u0111ang th\u1eed k\u1ebft n\u1ed1i l\u1ea1i...")},this),d.default.getInstance().addListener(t=>{switch(new u.default(t).getCmdId()){case p.default.Code.GET_MONEY_USE:{let e=new p.default.ResGetMoneyUse(t);c.default.Login.Coin=e.moneyUse,r.default.send(r.default.USER_UPDATE_COIN);break}}},this),g.default.getInstance().playBackgroundMusic(this.clipBgm)}actBack(){g.default.getInstance().playEffect(this.clipClick),a.default.instance.loadScene("Lobby")}actHonors(){}actRoom1(){this.show(!1),g.default.getInstance().playEffect(this.clipClick),this.play.show(!0,1)}actRoom2(){this.show(!1),g.default.getInstance().playEffect(this.clipClick),this.play.show(!0,2)}actRoom3(){this.show(!1),g.default.getInstance().playEffect(this.clipClick),this.play.show(!0,3)}show(t){this.node.active=t,r.default.send(r.default.USER_UPDATE_COIN)}};v.instance=null,o([b(cc.Node)],v.prototype,"playNode",void 0),o([b(cc.Label)],v.prototype,"lblBalance",void 0),o([b(l.default)],v.prototype,"popupCoinTransfer",void 0),o([b({type:cc.AudioClip})],v.prototype,"clipBgm",void 0),o([b({type:cc.AudioClip})],v.prototype,"clipClick",void 0),v=s=o([m],v),i.default=v,cc._RF.pop()},{"../../Main/Game/src/common/App":void 0,"../../Main/Game/src/common/BroadcastReceiver":void 0,"../../Main/Game/src/common/Common.AudioManager":void 0,"../../Main/Game/src/common/Configs":void 0,"../../Main/Game/src/common/Utils":void 0,"../../Main/Game/src/networks/MiniGameNetworkClient":void 0,"../../Main/Game/src/networks/Network.InPacket":void 0,"../../Main/Game/src/networks/ShootFishNetworkClient":void 0,"../../Main/Lobby/src/Lobby.Cmd":void 0,"./ShootFish.Play":"ShootFish.Play","./ShootFish.PopupCoinTransfer":"ShootFish.PopupCoinTransfer"}],"ShootFish.PanelMenu":[function(t,e,i){"use strict";cc._RF.push(e,"3ebbaXYFItGA4MRPRT0exe9","ShootFish.PanelMenu");var s=this&&this.__decorate||function(t,e,i,s){var o,n=arguments.length,a=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,s);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(n<3?o(a):n>3?o(e,i,a):o(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const o=t("../../Main/Game/src/common/SPUtils"),n=t("../../Main/Game/src/common/BroadcastReceiver"),{ccclass:a,property:c}=cc._decorator;let l=class extends cc.Component{constructor(){super(...arguments),this.arrow=null,this.btnSound=null,this.sfSoundOn=null,this.sfSoundOff=null,this.btnMusic=null,this.sfMusicOn=null,this.sfMusicOff=null,this.isShow=!1}onLoad(){n.default.send(n.default.SET_SOUND,this.node)}show(t){this.isShow=t,this.isShow?(this.node.runAction(cc.moveTo(.3,cc.v2(-115,0))),this.arrow.runAction(cc.rotateTo(.3,0))):(this.node.runAction(cc.moveTo(.3,cc.v2(0,0))),this.arrow.runAction(cc.rotateTo(.3,180))),this.btnSound.getComponent(cc.Sprite).spriteFrame=o.default.getSoundVolumn()>0?this.sfSoundOn:this.sfSoundOff,this.btnMusic.getComponent(cc.Sprite).spriteFrame=o.default.getMusicVolumn()>0?this.sfMusicOn:this.sfMusicOff}toggleShow(){this.show(!this.isShow)}toggleSound(){o.default.setSoundVolumn(o.default.getSoundVolumn()>0?0:1),this.btnSound.getComponent(cc.Sprite).spriteFrame=o.default.getSoundVolumn()>0?this.sfSoundOn:this.sfSoundOff,n.default.send(n.default.ON_AUDIO_CHANGED)}toggleMusic(){o.default.setMusicVolumn(o.default.getMusicVolumn()>0?0:1),this.btnMusic.getComponent(cc.Sprite).spriteFrame=o.default.getMusicVolumn()>0?this.sfMusicOn:this.sfMusicOff,n.default.send(n.default.ON_AUDIO_CHANGED)}};s([c(cc.Node)],l.prototype,"arrow",void 0),s([c(cc.Button)],l.prototype,"btnSound",void 0),s([c(cc.SpriteFrame)],l.prototype,"sfSoundOn",void 0),s([c(cc.SpriteFrame)],l.prototype,"sfSoundOff",void 0),s([c(cc.Button)],l.prototype,"btnMusic",void 0),s([c(cc.SpriteFrame)],l.prototype,"sfMusicOn",void 0),s([c(cc.SpriteFrame)],l.prototype,"sfMusicOff",void 0),l=s([a],l),i.default=l,cc._RF.pop()},{"../../Main/Game/src/common/BroadcastReceiver":void 0,"../../Main/Game/src/common/SPUtils":void 0}],"ShootFish.Player":[function(t,e,i){"use strict";cc._RF.push(e,"720d1dsYhpMV5P3msI2r43M","ShootFish.Player");var s=this&&this.__decorate||function(t,e,i,s){var o,n=arguments.length,a=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,s);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(n<3?o(a):n>3?o(e,i,a):o(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const o=t("../../Main/Game/src/common/BroadcastReceiver"),n=t("../../Main/Game/src/common/Utils"),{ccclass:a,property:c}=cc._decorator;let l=class extends cc.Component{constructor(){super(...arguments),this.localPos=0,this.lblNickname=null,this.lblCoin=null,this.lblBet=null,this.gunRotate=null,this.sprGunBar=null,this.sprFramesGunBar=[],this.guns=[],this.id=0,this.username="",this.nickname="",this.coin=0,this.avatar="",this.serverPos=-1,this.gun=null,this.curGunIdx=-1}onLoad(){o.default.send(o.default.SET_SOUND,this.node)}set(t,e,i,s,o){switch(this.id=t,this.username=e,this.nickname=i,this.coin=s,this.avatar=o,this.gunRotate.angle=0,this.node.active=!0,this.lblNickname.string=this.nickname,this.lblCoin.string=n.default.formatNumber(s),this.localPos){case 0:case 1:this.gunRotate.angle=90;break;case 2:case 3:this.gunRotate.angle=-90}this.setGun(0)}leave(){this.id=-1,this.nickname="",this.coin=0,this.avatar="",this.node.active=!1}setGun(t){if(t>=this.guns.length&&(t=0),this.curGunIdx!=t){this.curGunIdx=t;for(let e=0;e<this.guns.length;e++)this.guns[e].node.active=e==t;this.sprGunBar.spriteFrame=this.sprFramesGunBar[t],this.gun=this.guns[t]}}rotateGun(t){var e=this.gunRotate.convertToWorldSpaceAR(cc.Vec2.ZERO),i=t.sub(e),s=Math.atan2(i.y,i.x)*n.default.Rad2Deg;s<-90?s=180:s<0&&s>-90&&(s=0),this.gunRotate.angle=s}shoot(){this.gun.setAnimation(0,"2",!1),this.gun.addAnimation(0,"1",!0)}};s([c],l.prototype,"localPos",void 0),s([c(cc.Label)],l.prototype,"lblNickname",void 0),s([c(cc.Label)],l.prototype,"lblCoin",void 0),s([c(cc.Label)],l.prototype,"lblBet",void 0),s([c(cc.Node)],l.prototype,"gunRotate",void 0),s([c(cc.Sprite)],l.prototype,"sprGunBar",void 0),s([c([cc.SpriteFrame])],l.prototype,"sprFramesGunBar",void 0),s([c([sp.Skeleton])],l.prototype,"guns",void 0),l=s([a],l),i.default=l,cc._RF.pop()},{"../../Main/Game/src/common/BroadcastReceiver":void 0,"../../Main/Game/src/common/Utils":void 0}],"ShootFish.Play":[function(t,e,i){"use strict";cc._RF.push(e,"5fa1efbhuJLl5N2iupithus","ShootFish.Play");var s,o=this&&this.__decorate||function(t,e,i,s){var o,n=arguments.length,a=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,s);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(n<3?o(a):n>3?o(e,i,a):o(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const n=t("./ShootFish.Player"),a=t("./ShootFish.Bullet"),c=t("../../Main/Game/src/common/Utils"),l=t("./ShootFish.Fish"),h=t("../../Main/Game/src/common/Configs"),r=t("../../Main/Game/src/common/Tween"),d=t("./ShootFish.CoinEffect"),u=t("./ShootFish.EffectJackpot"),p=t("../../Main/Game/src/common/App"),f=t("./ShootFish.Lobby"),g=t("./ShootFish.PanelMenu"),m=t("./ShootFish.PopupGuide"),b=t("./ShootFish.EffectBigWin"),v=t("../../Main/Game/src/networks/ShootFishNetworkClient"),y=t("../../Main/Game/src/common/Common.AudioManager"),F=t("../../Main/Game/src/common/BroadcastReceiver"),{ccclass:S,property:C}=cc._decorator;let T=s=class extends cc.Component{constructor(){super(...arguments),this.lobby=null,this.loading=null,this.touchPad=null,this.sprFramesBullet=[],this.bulletTemplate=null,this.players=[],this.fishsAnim=[],this.fishsNode=null,this.fishTemplate=null,this.coinEffectTemplate=null,this.lblJackpot=null,this.toggleAuto=null,this.target=null,this.waveState=null,this.btnFastShoot=null,this.progressFastShoot=null,this.lblFastShootTime=null,this.btnTargetFish=null,this.progressTargetFish=null,this.lblTargetFishTime=null,this.effectJackpot=null,this.effectBigWin=null,this.effectMegaWin=null,this.panelMenu=null,this.popupGuide=null,this.lblPing=null,this.lblServerTime=null,this.clipClick=null,this.clipHit=null,this.clipCoin=null,this.clipJackpot=null,this.mePlayer=null,this.bullets=[],this.fishs=[],this.coinEffects=[],this.isStateGeted=!1,this.inited=!1,this.lastUpdateTime=-1,this.roomId=0,this.listBet=[],this.listJackpot=[],this.betIdx=0,this.mapPlayersIdx=[[0,1,2,3],[1,0,3,2],[2,3,0,1],[3,2,1,0]],this.shootInterval=.25,this.fastShootInterval=.13,this.curShootInterval=0,this.isShoot=!1,this.isFastShoot=!1,this.isTargetFish=!1,this.targetFish=null,this.intervalFindTargetFish=2,this.curIntervalFindTargetFish=0,this.curTimeFastShootCountdown=0,this.curTimeTargetFishCountdown=0,this.tweens=new Array}init(){this.inited||(this.mePlayer=this.players[0])}onLoad(){F.default.send(F.default.SET_SOUND,this.node),s.instance=this}start(){this.bulletTemplate.active=!1,this.touchPad.on(cc.Node.EventType.TOUCH_START,t=>{var e=t.getLocation();this.mePlayer.rotateGun(e),this.isShoot=!0},this.touchPad),this.touchPad.on(cc.Node.EventType.TOUCH_MOVE,t=>{var e=t.getLocation();this.mePlayer.rotateGun(e)},this.touchPad),this.touchPad.on(cc.Node.EventType.TOUCH_END,()=>{this.isShoot=!1},this.touchPad),this.touchPad.on(cc.Node.EventType.TOUCH_CANCEL,()=>{this.isShoot=!1},this.touchPad),this.toggleAuto.node.on("toggle",()=>{this.playClickSound(),this.toggleAuto.isChecked?(this.touchPad.active=!1,this.curIntervalFindTargetFish=this.intervalFindTargetFish,this.isShoot=!0,this.findTargetFishInWorld()):this.stopAutoShoot()}),v.default.getInstance().addListener((t,e)=>{if(this.node.active&&this.isStateGeted)switch(t){case"OnUpdateJackpot":this.listJackpot.length=0,this.listJackpot.push(e[this.roomId+"1"]),this.listJackpot.push(e[this.roomId+"2"]),this.listJackpot.push(e[this.roomId+"3"]),this.listJackpot.push(e[this.roomId+"4"]),r.default.numberTo(this.lblJackpot,this.listJackpot[this.betIdx],.3);break;case"OnEnterPlayer":{let t=e.data,i=this.mapPlayersIdx[this.mePlayer.serverPos][t.posIndex],s=this.players[i];s.set(t.id,t.playerId,t.nickname,t.cash,t.avatar),s.serverPos=t.posIndex,s.lblBet.string=c.default.formatNumberMin(this.listBet[this.betIdx]);break}case"OnLeavePlayer":{let t=e.playerId;t==h.default.Login.UsernameFish&&(1==e.reason&&p.default.instance.alertDialog.showMsg("B\u1ea1n \u0111\u01b0\u1ee3c m\u1eddi ra kh\u1ecfi ph\xf2ng do kh\xf4ng thao t\xe1c trong th\u1eddi gian d\xe0i."),this.back());let i=this.getPlayerByUsername(t);if(null==i)break;i.leave();break}case"OnUpdateObject":{let t=e.id,i=this.getFishById(t);if(null==i){console.log("can't find fish "+t);break}i.setData(e);break}case"OnUpdateCash":{let t=e.playerId,i=Number(e.cash),s=e.scr;t==h.default.Login.UsernameFish&&(h.default.Login.CoinFish=i);let o=this.getPlayerByUsername(t);if(null==o)break;switch(o.coin=i,o.lblCoin.string=c.default.formatNumber(i),s){case 2:this.effectBigWin.show(!1),this.effectMegaWin.show(!1),this.effectJackpot.show(!0,o.nickname,i),y.default.getInstance().playEffect(this.clipJackpot)}break}case"OnObjectDie":{let t=e.id,i=e.value,s=e.playerId,o=this.getFishById(t);if(null==o)break;o.die(),o==this.targetFish&&(this.exploreAllBulletWithTargetFishId(this.targetFish.id),this.target.active=!1,this.targetFish=null,this.curIntervalFindTargetFish=0);let n=this.getPlayerByUsername(s);if(null==n)break;switch(this.getCoinEffect().run(i,o.node.position,n.node.position),o.type){case 15:case 16:case 17:case 18:case 19:case 20:case 21:this.effectJackpot.node.active||this.effectMegaWin.show(!0,n.nickname,i);break;case 22:case 23:case 24:this.effectJackpot.node.active||this.effectBigWin.show(!0,n.nickname,i)}break}case"OnShoot":{let t=e.playerId,o=Number(e.type)-1,n=e.rad,a=Number(e.target);if(t==h.default.Login.UsernameFish)break;let l=this.getPlayerByUsername(t);if(null==l)break;let r=n;switch(this.mePlayer.serverPos){case 0:r=n;break;case 1:r=Math.PI-n;break;case 2:r=n-Math.PI;break;case 3:r=-n}l.lblBet.string=c.default.formatNumberMin(this.listBet[o]),l.gunRotate.angle=r*c.default.Rad2Deg,l.setGun(o),l.shoot();var i=this.getBullet();i.targetFishId=a,i.bullet.getComponent(cc.Sprite).spriteFrame=this.sprFramesBullet[o],i.node.angle=l.gunRotate.angle;var s=i.node.parent.convertToNodeSpaceAR(l.gunRotate.convertToWorldSpaceAR(cc.Vec2.ZERO));s.x+=90*c.default.degreesToVec2(i.node.angle).x,s.y+=90*c.default.degreesToVec2(i.node.angle).y,i.node.position=s,i.run(),y.default.getInstance().playEffect(this.clipHit);break}case"OnChat":break;case"OnNewState":switch(e.state){case 3:{this.waveState.stopAllActions(),this.waveState.active=!0;let t=this.waveState.position;t.x=1400,this.waveState.position=t,t.x=-1400,this.waveState.runAction(cc.sequence(cc.moveTo(1,t),cc.callFunc(()=>{this.waveState.active=!1})));break}}break;case"OnJackpot":{e.nickname;let t=e.value;switch(e.tableIndex){case 2:"Ph\xf2ng 2";break;case 3:"Ph\xf2ng 3"}c.default.formatNumber(t);break}}},this),this.init()}onDisable(){this.tweens.forEach(t=>{t.stop()})}onDestroy(){this.tweens.forEach(t=>{t.stop()})}update(t){null!=this.lblPing&&(this.lblPing.string=v.default.PING+"ms"),null!=this.lblServerTime&&this.lblServerTime.node.active&&(this.lblServerTime.string="t: "+v.default.systemCurrentTimeMillis()+" d: "+v.default.TIME_DISTANCE+" mp: "+v.default.MIN_PING);let e=v.default.systemCurrentTimeMillis();this.isStateGeted&&this.lastUpdateTime>0&&e-this.lastUpdateTime>500&&(console.log("onresume getstate"),this.getState(!1)),this.lastUpdateTime=e,this.curTimeFastShootCountdown>0&&(this.curTimeFastShootCountdown=Math.max(0,this.curTimeFastShootCountdown-t),this.lblFastShootTime.string=Math.round(this.curTimeFastShootCountdown)+"s",0==this.curTimeFastShootCountdown&&(this.lblFastShootTime.node.active=!1,this.btnFastShoot.enabled=!0)),this.curTimeTargetFishCountdown>0&&(this.curTimeTargetFishCountdown=Math.max(0,this.curTimeTargetFishCountdown-t),this.lblTargetFishTime.string=Math.round(this.curTimeTargetFishCountdown)+"s",0==this.curTimeTargetFishCountdown&&(this.lblTargetFishTime.node.active=!1,this.btnTargetFish.enabled=!0)),this.updateShoot(t);for(var i=0,s=this.bullets.length;i<s;i++)this.bullets[i].updateRealTime(t);var o=new Array;for(i=0,s=this.fishs.length;i<s;i++){let e=this.fishs[i];e.updateRealTime(t),e.node.active&&Math.abs(e.node.x)<704&&Math.abs(e.node.y)<360*1.1?o.push(e.getPolygon()):o.push(null)}i=0;for(var n=this.bullets.length;i<n;i++){var a=this.bullets[i];if(a.node.active&&!a.isExploring&&!a.isExplored)for(var c=a.getCircle(),l=0,h=this.fishs.length;l<h;l++){var r=this.fishs[l];if(null!=o[l]&&!(a.targetFishId>0&&a.targetFishId!=r.id)&&SAT.testCirclePolygon(c,o[l])){a.explore(),r.hurt();break}}}o.length=0}play(){this.isStateGeted=!1,this.resetView(),v.default.getInstance().ping(()=>{v.default.getInstance().ping(()=>{v.default.getInstance().ping(()=>{console.log(this.roomId),v.default.getInstance().request("play",{playerId:h.default.Login.UsernameFish,password:h.default.Login.PasswordFish,index:this.roomId},t=>{if(console.log(t),!t.ok){switch(t.err){case 4:p.default.instance.confirmDialog.show2("S\u1ed1 d\u01b0 kh\xf4ng \u0111\u1ee7 vui l\xf2ng n\u1ea1p th\xeam.",t=>{t&&f.default.instance.popupCoinTransfer.show()});break;case 1:v.default.getInstance().request("quit",null,()=>{},this),p.default.instance.alertDialog.showMsg("L\u1ed7i "+t.err+", vui l\xf2ng th\u1eed l\u1ea1i.");break;default:p.default.instance.alertDialog.showMsg("L\u1ed7i "+t.err+", kh\xf4ng x\xe1c \u0111\u1ecbnh.")}return this.show(!1),void this.lobby.getComponent(f.default).show(!0)}this.getState(!0)},this)},this)},this)},this)}resetView(){this.betIdx=0;for(let t=0;t<this.players.length;t++)this.players[t].leave();for(let t=0;t<this.fishs.length;t++)this.fishs[t].node.removeFromParent();this.fishs.length=0;for(let t=0;t<this.bullets.length;t++)this.bullets[t].node.active=!1;for(let t=0;t<this.coinEffects.length;t++)this.coinEffects[t].node.active=!1;this.effectBigWin.show(!1),this.effectMegaWin.show(!1),this.effectJackpot.show(!1),this.popupGuide.active=!1,this.waveState.stopAllActions(),this.waveState.active=!1}getJackpot(){v.default.getInstance().request("getJackpot",null,t=>{t.ok&&(this.listJackpot.length=0,this.listJackpot.push(t.data[this.roomId+"1"]),this.listJackpot.push(t.data[this.roomId+"2"]),this.listJackpot.push(t.data[this.roomId+"3"]),this.listJackpot.push(t.data[this.roomId+"4"]),r.default.numberTo(this.lblJackpot,this.listJackpot[this.betIdx],.3))},this)}getState(t){t||p.default.instance.showLoading(!0),this.isStateGeted=!1,this.resetView(),v.default.getInstance().request("state",null,e=>{t||p.default.instance.showLoading(!1);let i=e.players,o=null,n=0;for(let t=0;t<i.length;t++)if(i[t].playerId==h.default.Login.UsernameFish){n=i[t].posIndex,o=i[t],h.default.Login.CoinFish=i[t].cash;break}console.log("mePlayerServerPos: "+n);for(let t=0;t<i.length;t++){let e=this.mapPlayersIdx[n][i[t].posIndex],s=i[t],o=this.players[e];o.set(s.id,s.playerId,s.nickname,s.cash,s.avatar),o.serverPos=s.posIndex,o.lblBet.string=c.default.formatNumberMin(this.listBet[this.betIdx])}let a=e.objects.concat(e.sobjects);for(let t=0;t<a.length;t++){let e=cc.instantiate(this.fishTemplate).getComponent(l.default);e.node.parent=this.fishsNode,e.setData(a[t]),this.fishs.push(e)}var r=e.time-o.rfire,d=s.SERVER_CONFIG.FastFireCoolDownS;this.progressFastShoot.progress=0,r>d?(this.btnFastShoot.enabled=!0,this.lblFastShootTime.node.active=!1):(this.btnFastShoot.enabled=!1,this.curTimeFastShootCountdown=r,this.lblFastShootTime.string=this.curTimeFastShootCountdown+"s",this.lblFastShootTime.node.active=!0);var u=e.time-o.snipe,f=s.SERVER_CONFIG.SnipeCoolDownS;this.progressTargetFish.progress=0,u>f?(this.btnTargetFish.enabled=!0,this.lblFastShootTime.node.active=!1):(this.btnTargetFish.enabled=!1,this.curTimeTargetFishCountdown=u,this.lblTargetFishTime.string=this.curTimeTargetFishCountdown+"s",this.lblTargetFishTime.node.active=!0),this.isStateGeted=!0,this.getJackpot(),t&&(this.loading.active=!1)},this)}updateShoot(t){if(this.toggleAuto.isChecked||this.isTargetFish)if(null!=this.targetFish){var e=this.mePlayer.gunRotate.convertToWorldSpaceAR(cc.Vec2.ZERO),i=this.targetFish.node.convertToWorldSpaceAR(cc.v2(this.targetFish.node.width/2,0)),s=c.default.v2Distance(i,e);if(Math.abs(this.targetFish.node.x)>512||Math.abs(this.targetFish.node.y)>288||s<135)this.exploreAllBulletWithTargetFishId(this.targetFish.id),this.target.active=!1,this.targetFish=null,this.curIntervalFindTargetFish=0;else{var o=i.sub(e),n=Math.atan2(o.y,o.x)*c.default.Rad2Deg;this.mePlayer.gunRotate.angle=n,this.target.position=this.target.parent.convertToNodeSpaceAR(i)}}else this.isTargetFish||(this.curIntervalFindTargetFish=Math.max(0,this.curIntervalFindTargetFish-t),0==this.curIntervalFindTargetFish&&this.findTargetFishInWorld());if(this.curShootInterval>0)this.curShootInterval=Math.max(0,this.curShootInterval-t);else if(this.isShoot){if(this.curShootInterval=this.isFastShoot?this.fastShootInterval:this.shootInterval,h.default.Login.CoinFish<this.listBet[this.betIdx])return p.default.instance.alertDialog.showMsg("S\u1ed1 d\u01b0 kh\xf4ng \u0111\u1ee7, vui l\xf2ng n\u1ea1p th\xeam."),this.isShoot=!1,void(this.toggleAuto.isChecked&&this.stopAutoShoot());if((this.toggleAuto.isChecked||this.isTargetFish)&&null==this.targetFish)return;h.default.Login.CoinFish=Math.max(0,h.default.Login.CoinFish-this.listBet[this.betIdx]),this.mePlayer.coin=h.default.Login.CoinFish,this.mePlayer.lblCoin.string=c.default.formatNumber(h.default.Login.CoinFish),this.mePlayer.shoot();let t=this.mePlayer.gunRotate.angle;var a=this.getBullet();a.bullet.getComponent(cc.Sprite).spriteFrame=this.sprFramesBullet[this.betIdx],a.targetFishId=null!=this.targetFish?this.targetFish.id:-1,a.node.angle=t;var l=a.node.parent.convertToNodeSpaceAR(this.mePlayer.gunRotate.convertToWorldSpaceAR(cc.Vec2.ZERO));l.x+=90*c.default.degreesToVec2(a.node.angle).x,l.y+=90*c.default.degreesToVec2(a.node.angle).y,a.node.position=l,a.run(),y.default.getInstance().playEffect(this.clipHit);let e=t*c.default.Deg2Rad;switch(this.mePlayer.serverPos){case 0:e=e;break;case 1:e=Math.PI-e;break;case 2:e-=Math.PI;break;case 3:e=-e}v.default.getInstance().notify("shoot",{rad:e,type:this.betIdx+1,target:null!=this.targetFish?this.targetFish.id:-1,rapidFire:this.isFastShoot,auto:!1})}}findTargetFishInWorld(){this.curIntervalFindTargetFish=this.intervalFindTargetFish;let t=[];var e=this.mePlayer.gunRotate.convertToWorldSpaceAR(cc.Vec2.ZERO);for(let n=0;n<this.fishs.length;n++){var i=this.fishs[n].node;if(i.active&&Math.abs(i.position.x)<=512&&Math.abs(i.position.y)<=288){var s=i.convertToWorldSpaceAR(cc.Vec2.ZERO),o=c.default.v2Distance(e,s);o>=135&&t.push({fish:this.fishs[n],distance:o})}}t.length>0&&(this.targetFish=t[c.default.randomRangeInt(0,t.length)].fish,this.target.active=!0,this.target.position=this.targetFish.node.position)}stopAutoShoot(){this.isShoot=!1,this.toggleAuto.isChecked=!1,this.target.active=!1,this.touchPad.active=!0,this.curIntervalFindTargetFish=0,this.targetFish=null}getBullet(){let t=null;for(let e=0;e<this.bullets.length;e++)if(!this.bullets[e].node.active){t=this.bullets[e];break}if(null==t){let e=cc.instantiate(this.bulletTemplate);e.parent=this.bulletTemplate.parent,t=e.getComponent(a.default),this.bullets.push(t)}return t.node.active=!0,t.targetFishId=-1,t}exploreAllBulletWithTargetFishId(t){for(let e=0;e<this.bullets.length;e++)this.bullets[e].node.active&&this.bullets[e].targetFishId>=0&&this.bullets[e].targetFishId==t&&(this.bullets[e].targetFishId=-1)}getCoinEffect(){let t=null;for(let e=0;e<this.coinEffects.length;e++)if(!this.coinEffects[e].node.active){t=this.coinEffects[e];break}if(null==t){let e=cc.instantiate(this.coinEffectTemplate);e.parent=this.coinEffectTemplate.parent,t=e.getComponent(d.default),this.coinEffects.push(t)}return t.node.active=!0,t.node.setSiblingIndex(t.node.parent.children.length-1),y.default.getInstance().playEffect(this.clipCoin),t}getFishById(t){for(let e=0;e<this.fishs.length;e++)if(this.fishs[e].id==t)return this.fishs[e];return null}getPlayerById(t){if(t<=0)return null;for(let e=0;e<this.players.length;e++)if(this.players[e].id>0&&this.players[e].id==t)return this.players[e];return null}getPlayerByUsername(t){if(null==t||""==t)return null;for(let e=0;e<this.players.length;e++)if(null!=this.players[e].username&&""!=this.players[e].username&&this.players[e].username==t)return this.players[e];return null}getFishAnimByType(t){let e="";switch(t){case 0:e="fish0";break;case 1:e="fish1";break;case 2:e="fish2";break;case 3:e="fish3";break;case 4:e="fish4";break;case 5:e="fish5";break;case 6:e="fish6";break;case 7:e="fish7";break;case 8:case 9:e="fish9";break;case 10:e="fish10";break;case 11:e="fish11";break;case 12:e="fish12";break;case 13:e="fish13";break;case 14:e="fish14";break;case 15:e="fish15";break;case 16:e="fish16";break;case 17:e="fish17";break;case 18:e="fish18";break;case 19:e="fish19";break;case 20:e="fish20";break;case 21:e="fish21";break;case 22:e="fish22";break;case 23:e="fish23";break;case 24:e="fish24"}for(let i=0;i<this.fishsAnim.length;i++)if(null!=this.fishsAnim[i].name&&""!=this.fishsAnim[i].name&&this.fishsAnim[i].name==e)return this.fishsAnim[i];return this.fishsAnim[0]}actGetState(){this.getState(!1)}actBetUp(){this.betIdx<this.listBet.length-1&&(this.betIdx++,this.mePlayer.lblBet.string=c.default.formatNumberMin(this.listBet[this.betIdx]),this.mePlayer.setGun(this.betIdx),r.default.numberTo(this.lblJackpot,this.listJackpot[this.betIdx],.3)),y.default.getInstance().playEffect(this.clipClick)}actBetDown(){this.betIdx>0&&(this.betIdx--,this.mePlayer.lblBet.string=c.default.formatNumberMin(this.listBet[this.betIdx]),this.mePlayer.setGun(this.betIdx),r.default.numberTo(this.lblJackpot,this.listJackpot[this.betIdx],.3)),y.default.getInstance().playEffect(this.clipClick)}actBack(){p.default.instance.confirmDialog.show2("B\u1ea1n c\xf3 mu\u1ed1n r\u1eddi kh\u1ecfi b\xe0n kh\xf4ng",t=>{t&&this.back()}),y.default.getInstance().playEffect(this.clipClick)}actFastShoot(){this.isFastShoot=!0,this.btnFastShoot.enabled=!1;var t=s.SERVER_CONFIG.FastFireDuration;this.progressFastShoot.progress=1,this.tweens.push(cc.tween(this.progressFastShoot).to(t,{progress:0}).call(()=>{this.isFastShoot=!1,this.curTimeFastShootCountdown=s.SERVER_CONFIG.FastFireCoolDownS,this.lblFastShootTime.string=this.curTimeFastShootCountdown+"s",this.lblFastShootTime.node.active=!0}).start()),y.default.getInstance().playEffect(this.clipClick)}actTargetFish(){this.isShoot=!0,this.isTargetFish=!0,this.btnTargetFish.enabled=!1;var t=s.SERVER_CONFIG.SnipeDurationS;this.progressTargetFish.progress=1,this.tweens.push(cc.tween(this.progressTargetFish).to(t,{progress:0}).call(()=>{this.isTargetFish=!1,this.targetFish=null,this.target.active=!1,this.curTimeTargetFishCountdown=s.SERVER_CONFIG.SnipeCoolDownS,this.lblTargetFishTime.string=this.curTimeTargetFishCountdown+"s",this.lblTargetFishTime.node.active=!0,this.fishs.forEach(t=>{t.getComponent(cc.Button).enabled=!1}),this.isShoot=this.toggleAuto.isChecked,this.touchPad.active=!this.toggleAuto.isChecked}).start()),this.touchPad.active=!1,this.fishs.forEach(t=>{t.getComponent(cc.Button).enabled=!0,t.node.off("click"),t.node.on("click",()=>{this.targetFish=t,this.target.active=!0})}),y.default.getInstance().playEffect(this.clipClick)}back(){this.isStateGeted=!1,this.stopAutoShoot(),p.default.instance.showLoading(!0),v.default.getInstance().request("quit",null,()=>{p.default.instance.showLoading(!1),this.resetView(),this.show(!1),this.lobby.getComponent(f.default).show(!0)},this)}actEffectJackpotTest(){this.effectJackpot.show(!0,"Test nickname",54032423)}actEffectBigWinTest(){this.effectBigWin.show(!0,"Test nickname",54032423)}actEffectMegaWinTest(){this.effectMegaWin.show(!0,"Test nickname",54032423)}show(t,e=0){if(t){if(null==s.SERVER_CONFIG)return this.lobby.getComponent(f.default).show(!0),void p.default.instance.alertDialog.showMsg("B\u1ea1n ch\u01b0a \u0111\u0103ng nh\u1eadp.");this.node.active=!0,this.loading.active=!0,this.roomId=e,this.stopAutoShoot(),this.panelMenu.show(!1),this.listBet.length=0,this.listBet.push(s.SERVER_CONFIG.TypeToValue.Bullet1*s.SERVER_CONFIG.TableBulletValueRate[this.roomId]),this.listBet.push(s.SERVER_CONFIG.TypeToValue.Bullet2*s.SERVER_CONFIG.TableBulletValueRate[this.roomId]),this.listBet.push(s.SERVER_CONFIG.TypeToValue.Bullet3*s.SERVER_CONFIG.TableBulletValueRate[this.roomId]),this.listBet.push(s.SERVER_CONFIG.TypeToValue.Bullet4*s.SERVER_CONFIG.TableBulletValueRate[this.roomId]),this.shootInterval=1/s.SERVER_CONFIG.FIRE_RATE,this.fastShootInterval=this.shootInterval/s.SERVER_CONFIG.FastFireRate,this.play()}else this.popupGuide.active&&this.popupGuide.getComponent(m.default).dismiss(),this.node.active=!1}playClickSound(){y.default.getInstance().playEffect(this.clipClick)}};T.instance=null,T.SERVER_CONFIG=null,o([C(cc.Node)],T.prototype,"lobby",void 0),o([C(cc.Node)],T.prototype,"loading",void 0),o([C(cc.Node)],T.prototype,"touchPad",void 0),o([C([cc.SpriteFrame])],T.prototype,"sprFramesBullet",void 0),o([C(cc.Node)],T.prototype,"bulletTemplate",void 0),o([C([n.default])],T.prototype,"players",void 0),o([C([cc.Node])],T.prototype,"fishsAnim",void 0),o([C(cc.Node)],T.prototype,"fishsNode",void 0),o([C(cc.Node)],T.prototype,"fishTemplate",void 0),o([C(cc.Node)],T.prototype,"coinEffectTemplate",void 0),o([C(cc.Label)],T.prototype,"lblJackpot",void 0),o([C(cc.Toggle)],T.prototype,"toggleAuto",void 0),o([C(cc.Node)],T.prototype,"target",void 0),o([C(cc.Node)],T.prototype,"waveState",void 0),o([C(cc.Button)],T.prototype,"btnFastShoot",void 0),o([C(cc.ProgressBar)],T.prototype,"progressFastShoot",void 0),o([C(cc.Label)],T.prototype,"lblFastShootTime",void 0),o([C(cc.Button)],T.prototype,"btnTargetFish",void 0),o([C(cc.ProgressBar)],T.prototype,"progressTargetFish",void 0),o([C(cc.Label)],T.prototype,"lblTargetFishTime",void 0),o([C(u.default)],T.prototype,"effectJackpot",void 0),o([C(b.default)],T.prototype,"effectBigWin",void 0),o([C(b.default)],T.prototype,"effectMegaWin",void 0),o([C(g.default)],T.prototype,"panelMenu",void 0),o([C(cc.Node)],T.prototype,"popupGuide",void 0),o([C(cc.Label)],T.prototype,"lblPing",void 0),o([C(cc.Label)],T.prototype,"lblServerTime",void 0),o([C({type:cc.AudioClip})],T.prototype,"clipClick",void 0),o([C({type:cc.AudioClip})],T.prototype,"clipHit",void 0),o([C({type:cc.AudioClip})],T.prototype,"clipCoin",void 0),o([C({type:cc.AudioClip})],T.prototype,"clipJackpot",void 0),T=s=o([S],T),i.default=T,cc._RF.pop()},{"../../Main/Game/src/common/App":void 0,"../../Main/Game/src/common/BroadcastReceiver":void 0,"../../Main/Game/src/common/Common.AudioManager":void 0,"../../Main/Game/src/common/Configs":void 0,"../../Main/Game/src/common/Tween":void 0,"../../Main/Game/src/common/Utils":void 0,"../../Main/Game/src/networks/ShootFishNetworkClient":void 0,"./ShootFish.Bullet":"ShootFish.Bullet","./ShootFish.CoinEffect":"ShootFish.CoinEffect","./ShootFish.EffectBigWin":"ShootFish.EffectBigWin","./ShootFish.EffectJackpot":"ShootFish.EffectJackpot","./ShootFish.Fish":"ShootFish.Fish","./ShootFish.Lobby":"ShootFish.Lobby","./ShootFish.PanelMenu":"ShootFish.PanelMenu","./ShootFish.Player":"ShootFish.Player","./ShootFish.PopupGuide":"ShootFish.PopupGuide"}],"ShootFish.PopupCoinTransfer":[function(t,e,i){"use strict";cc._RF.push(e,"bcd88coqOBPF7ZC2zQEsAhZ","ShootFish.PopupCoinTransfer");var s=this&&this.__decorate||function(t,e,i,s){var o,n=arguments.length,a=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,s);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(n<3?o(a):n>3?o(e,i,a):o(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0}),i.TabCashOut=i.TabCashIn=void 0;const o=t("../../Main/Game/src/common/Dialog"),n=t("../../Main/Game/src/common/BroadcastReceiver"),a=t("../../Main/Game/src/common/Utils"),c=t("../../Main/Game/src/common/Configs"),l=t("../../Main/Game/src/common/App"),h=t("../../Main/Game/src/networks/MiniGameNetworkClient"),r=t("../../Main/Lobby/src/Lobby.Cmd"),d=t("../../Main/Game/src/networks/ShootFishNetworkClient"),{ccclass:u,property:p}=cc._decorator;let f=class{constructor(){this.lblBalance=null,this.edbCoin=null,this.quickButtons=null,this.popup=null,this.values=[5e4,1e5,2e5,5e5,1e6,2e6,5e6,1e7,2e7]}onLoad(){n.default.send(n.default.SET_SOUND,this.node)}start(t){this.popup=t,this.edbCoin.node.on("editing-did-ended",()=>{let t=a.default.stringToInt(this.edbCoin.string);this.edbCoin.string=a.default.formatNumber(t)});for(let i=0;i<this.quickButtons.childrenCount;i++){var e=this.quickButtons.children[i];let t=this.values[i];e.getComponentInChildren(cc.Label).string=a.default.formatNumber(t),e.on("click",()=>{this.edbCoin.string=a.default.formatNumber(t)})}}submit(){let t=a.default.stringToInt(this.edbCoin.string);t<=0?l.default.instance.alertDialog.showMsg("S\u1ed1 ti\u1ec1n \u0111\xe3 nh\u1eadp kh\xf4ng h\u1ee3p l\u1ec7."):(l.default.instance.showLoading(!0),d.default.getInstance().request("xxengCashin",{ccash:t},t=>{l.default.instance.showLoading(!1),t.ok?(c.default.Login.CoinFish=t.newCash,n.default.send(n.default.USER_UPDATE_COIN),l.default.instance.alertDialog.showMsg("Thao t\xe1c th\xe0nh c\xf4ng."),this.reset(),h.default.getInstance().send(new r.default.ReqGetMoneyUse)):l.default.instance.alertDialog.showMsg("Thao t\xe1c th\u1ea5t b\u1ea1i, vui l\xf2ng th\u1eed l\u1ea1i sau.")},this.popup))}reset(){this.edbCoin.string="",this.lblBalance.string=a.default.formatNumber(c.default.Login.Coin)}};s([p(cc.Label)],f.prototype,"lblBalance",void 0),s([p(cc.EditBox)],f.prototype,"edbCoin",void 0),s([p(cc.Node)],f.prototype,"quickButtons",void 0),f=s([u("PopupCoinTransfer.TabCashIn")],f),i.TabCashIn=f;let g=class{constructor(){this.lblBalance=null,this.edbCoin=null,this.quickButtons=null,this.popup=null,this.values=[5e4,1e5,2e5,5e5,1e6,2e6,5e6,1e7,2e7]}start(t){this.popup=t,this.edbCoin.node.on("editing-did-ended",()=>{let t=a.default.stringToInt(this.edbCoin.string);this.edbCoin.string=a.default.formatNumber(t)});for(let i=0;i<this.quickButtons.childrenCount;i++){var e=this.quickButtons.children[i];let t=this.values[i];e.getComponentInChildren(cc.Label).string=a.default.formatNumber(t),e.on("click",()=>{this.edbCoin.string=a.default.formatNumber(t)})}}submit(){let t=a.default.stringToInt(this.edbCoin.string);t<=0?l.default.instance.alertDialog.showMsg("S\u1ed1 ti\u1ec1n \u0111\xe3 nh\u1eadp kh\xf4ng h\u1ee3p l\u1ec7."):(l.default.instance.showLoading(!0),d.default.getInstance().request("xxengCashin",{ccash:-t},t=>{l.default.instance.showLoading(!1),t.ok?(c.default.Login.CoinFish=t.newCash,n.default.send(n.default.USER_UPDATE_COIN),l.default.instance.alertDialog.showMsg("Thao t\xe1c th\xe0nh c\xf4ng."),this.reset(),h.default.getInstance().send(new r.default.ReqGetMoneyUse)):l.default.instance.alertDialog.showMsg("Thao t\xe1c th\u1ea5t b\u1ea1i, vui l\xf2ng th\u1eed l\u1ea1i sau.")},this.popup))}reset(){this.edbCoin.string="",this.lblBalance.string=a.default.formatNumber(c.default.Login.CoinFish)}};s([p(cc.Label)],g.prototype,"lblBalance",void 0),s([p(cc.EditBox)],g.prototype,"edbCoin",void 0),s([p(cc.Node)],g.prototype,"quickButtons",void 0),g=s([u("PopupCoinTransfer.TabCashOut")],g),i.TabCashOut=g;let m=class extends o.default{constructor(){super(...arguments),this.tabs=null,this.tabContents=null,this.tabCashIn=null,this.tabCashOut=null,this.tabSelectedIdx=0}start(){for(let t=0;t<this.tabs.toggleItems.length;t++)this.tabs.toggleItems[t].node.on("toggle",()=>{this.tabSelectedIdx=t,this.onTabChanged()});n.default.register(n.default.USER_UPDATE_COIN,()=>{this.tabCashIn.lblBalance.string=a.default.formatNumber(c.default.Login.Coin),this.tabCashOut.lblBalance.string=a.default.formatNumber(c.default.Login.CoinFish)},this),this.tabCashIn.start(this),this.tabCashOut.start(this)}show(){super.show(),this.tabSelectedIdx=0,this.tabs.toggleItems[this.tabSelectedIdx].isChecked=!0,this.onTabChanged()}onTabChanged(){for(let t=0;t<this.tabContents.childrenCount;t++)this.tabContents.children[t].active=t==this.tabSelectedIdx;for(let t=0;t<this.tabs.toggleItems.length;t++)this.tabs.toggleItems[t].node.getComponentInChildren(cc.LabelOutline).color=t==this.tabSelectedIdx?cc.Color.BLACK.fromHEX("#AA5F00"):cc.Color.BLACK.fromHEX("#4677F3");switch(this.tabSelectedIdx){case 0:this.tabCashIn.reset();break;case 1:this.tabCashOut.reset()}}actSubmitCashIn(){this.tabCashIn.submit()}actSubmitCashOut(){this.tabCashOut.submit()}actClearCashIn(){this.tabCashIn.edbCoin.string="0"}actClearCashOut(){this.tabCashOut.edbCoin.string="0"}};s([p(cc.ToggleContainer)],m.prototype,"tabs",void 0),s([p(cc.Node)],m.prototype,"tabContents",void 0),s([p(f)],m.prototype,"tabCashIn",void 0),s([p(g)],m.prototype,"tabCashOut",void 0),m=s([u],m),i.default=m,cc._RF.pop()},{"../../Main/Game/src/common/App":void 0,"../../Main/Game/src/common/BroadcastReceiver":void 0,"../../Main/Game/src/common/Configs":void 0,"../../Main/Game/src/common/Dialog":void 0,"../../Main/Game/src/common/Utils":void 0,"../../Main/Game/src/networks/MiniGameNetworkClient":void 0,"../../Main/Game/src/networks/ShootFishNetworkClient":void 0,"../../Main/Lobby/src/Lobby.Cmd":void 0}],"ShootFish.PopupGuide":[function(t,e,i){"use strict";cc._RF.push(e,"bab5aIcJEpPB53KA3RPsstw","ShootFish.PopupGuide");var s=this&&this.__decorate||function(t,e,i,s){var o,n=arguments.length,a=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,s);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(n<3?o(a):n>3?o(e,i,a):o(e,i))||a);return n>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});const o=t("../../Main/Game/src/common/Dialog"),n=t("./ShootFish.Play"),{ccclass:a,property:c}=cc._decorator;let l=class extends o.default{constructor(){super(...arguments),this.grid=null,this.itemTemplate=null,this.items=[],this.mapFishType={0:["Cuttle",1],1:["GoldFish",1],2:["LightenFish",1],3:["Mermaid",1],4:["Octopus",1],5:["PufferFish",1],6:["SeaFish",1],7:["Shark",1],8:["Stringray",1],9:["Turtle",1],10:["CaThanTai",1],11:["FlyingFish",1],12:["GoldenFrog",.2],13:["SeaTurtle",1],14:["MerMan",1],15:["Phoenix",.7],16:["MermaidBig",.6],17:["MermaidSmall",.6],18:["BombFish",.6],19:["Fish19",.6],20:["Fish20",.6],21:["Fish21",.4],22:["Fish22",.3],23:["Fish23",.3],24:["Fish24",.3]}}show(){super.show(),this.itemTemplate.active=!1}_onShowed(){if(super._onShowed(),null!=n.default.SERVER_CONFIG)for(let t in this.mapFishType){let e=this.mapFishType[t][0],i=this.mapFishType[t][1],s=n.default.SERVER_CONFIG.FishPhysicalData[e],o=cc.instantiate(this.itemTemplate);o.parent=this.grid,o.active=!0;let a=cc.instantiate(n.default.instance.getFishAnimByType(Number(t)));a.parent=o.getChildByName("fishParent"),a.scale=i,a.angle=35,o.getChildByName("lblFactor").getComponent(cc.Label).string=(s.Health/100).toString(),this.items.push(o)}}dismiss(){this.items.forEach(t=>{t.removeFromParent()}),super.dismiss()}};s([c(cc.Node)],l.prototype,"grid",void 0),s([c(cc.Node)],l.prototype,"itemTemplate",void 0),l=s([a],l),i.default=l,cc._RF.pop()},{"../../Main/Game/src/common/Dialog":void 0,"./ShootFish.Play":"ShootFish.Play"}]},{},["ShootFish.Bullet","ShootFish.CoinEffect","ShootFish.EffectBigWin","ShootFish.EffectJackpot","ShootFish.Fish","ShootFish.Lobby","ShootFish.PanelMenu","ShootFish.Play","ShootFish.Player","ShootFish.PopupCoinTransfer","ShootFish.PopupGuide"]);