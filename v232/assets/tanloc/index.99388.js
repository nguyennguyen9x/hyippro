window.__require=function e(t,n,i){function s(c,a){if(!n[c]){if(!t[c]){var r=c.split("/");if(r=r[r.length-1],!t[r]){var l="function"==typeof __require&&__require;if(!a&&l)return l(r,!0);if(o)return o(r,!0);throw new Error("Cannot find module '"+c+"'")}c=r}var h=n[c]={exports:{}};t[c][0].call(h.exports,function(e){return s(t[c][1][e]||e)},h,h.exports,e,t,n,i)}return n[c].exports}for(var o="function"==typeof __require&&__require,c=0;c<i.length;c++)s(i[c]);return s}({"TanLoc.Cmd":[function(e,t,n){"use strict";cc._RF.push(t,"5677aFa795BYoYgjPSc0RYR","TanLoc.Cmd"),Object.defineProperty(n,"__esModule",{value:!0}),n.TanLocCmd=void 0;const i=e("../../Main/Game/src/common/Constants"),s=e("../../Main/Game/src/networks/Network.InPacket"),o=e("../../Main/Game/src/networks/Network.OutPacket");var c;(function(e){class t{}t.PING_PONG=50,t.SUBSCRIBE=2e3,t.SUBCRIBE_RESPONSE=2002,t.SPIN_RESULT=2003,t.LOG_CHAT=18003,t.SEND_CHAT=18e3,t.SUBSCRIBE_CHAT=18001,t.UNSUBSCRIBE_CHAT=18002,t.UPDATE_USER_MONEY=21e3,e.Code=t,e.SendPing=class extends o.default{constructor(){super(),this.initData(100),this.setControllerId(0),this.setCmdId(t.PING_PONG),this.packHeader(),this.updateSize()}},e.SendSubscribe=class extends o.default{constructor(){super(),this.initData(100),this.setControllerId(1),this.setCmdId(t.SUBSCRIBE),this.packHeader(),this.updateSize()}},e.SendSubscribeChat=class extends o.default{constructor(){super(),this.initData(100),this.setControllerId(1),this.setCmdId(t.SUBSCRIBE_CHAT),this.packHeader(),this.putString(i.ChatChannel.TAN_LOC),this.updateSize()}},e.SendUnSubscribeChat=class extends o.default{constructor(){super(),this.initData(100),this.setControllerId(1),this.setCmdId(t.UNSUBSCRIBE_CHAT),this.packHeader(),this.putString(i.ChatChannel.TAN_LOC),this.updateSize()}},e.SendChat=class extends o.default{constructor(e){super(),this.initData(100),this.setControllerId(1),this.setCmdId(t.SEND_CHAT),this.packHeader(),this.putString(e),this.putString(i.ChatChannel.TAN_LOC),this.updateSize()}},e.ReceiveSubscribe=class extends s.default{constructor(e){super(e),this.isSpinBingo=!1,this.isSpinBingo=this.getBool()}},e.ReceiveSpinResult=class extends s.default{constructor(e){super(e),this.spinResult="",this.currentRound=0,this.spinResult=this.getString(),this.currentRound=this.getByte()}},e.ReceiveLogChat=class extends s.default{constructor(e){super(e),this.message="",this.minVipPoint=0,this.timeBan=0,this.userType=0,this.chatChannel="",this.message=this.getString(),this.minVipPoint=this.getByte(),this.timeBan=this.getLong(),this.userType=this.getByte(),this.chatChannel=this.getString()}},e.ReceiveSendChat=class extends s.default{constructor(e){super(e),this.error=0,this.nickname="",this.message="",this.desc="",this.suggestionActions=[],this.vip=0,this.chatChannel="",this.error=this.getError(),this.nickname=this.getString(),this.message=this.getString(),this.desc=this.getString();let t=this.getString();if(this.vip=this.getInt(),t){let e=JSON.parse(t);e.hasOwnProperty("suggestionActions")&&Array.isArray(e.suggestionActions)&&(this.suggestionActions=i.UserActions.toEnums(e.suggestionActions))}this.chatChannel=this.getString()}},e.ReceivedUpdateUserMoney=class extends s.default{constructor(e){super(e),this.error=0,this.desc=this.getString(),this.nickName=this.getString(),this.changeMoney=this.getLong(),this.totalMoney=this.getLong(),this.showPopup=this.getBool()}}})(c=n.TanLocCmd||(n.TanLocCmd={})),n.default=c,cc._RF.pop()},{"../../Main/Game/src/common/Constants":void 0,"../../Main/Game/src/networks/Network.InPacket":void 0,"../../Main/Game/src/networks/Network.OutPacket":void 0}],"TanLoc.Controller":[function(e,t,n){"use strict";cc._RF.push(t,"6de3bhs7WJNxqjRs41QPYaB","TanLoc.Controller");var i,s=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,c=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(c=(o<3?s(c):o>3?s(t,n,c):s(t,n))||c);return o>3&&c&&Object.defineProperty(t,n,c),c};Object.defineProperty(n,"__esModule",{value:!0}),n.Ticket=void 0;const o=e("../../Main/Game/src/common/App"),c=e("../../Main/Game/src/common/BroadcastReceiver"),a=e("../../Main/Game/src/common/Configs"),r=e("../../Main/Game/src/common/Http"),l=e("../../Main/Game/src/common/Tween"),h=e("./TanLoc.NetworkClient"),d=e("../../Main/Game/src/networks/Network.InPacket"),u=e("./TanLoc.Cmd"),p=e("./TanLoc.PanelChat"),g=e("../../Main/Game/src/networks/Network.Cmd"),m=e("../../Main/Lobby/src/Lobby.PopupShop"),f=e("../../Main/Game/src/networks/MiniGameNetworkClient"),C=e("./TanLoc.PopupTanLoc"),y=e("./TanLoc.PopupHonors"),T=e("./TanLoc.PopupHistory"),w=e("../../Main/Game/src/common/Constants");class v{static toTicket(e){let t=new v;return t.id=e.id,t.matrix=e.matrix.split(","),t}static toTickets(e){let t=[];return null==e||e.forEach(e=>{t.push(this.toTicket(e))}),t}}n.Ticket=v;const{ccclass:k,property:L}=cc._decorator;let b=i=class extends cc.Component{constructor(){super(...arguments),this.lbChip=null,this.safeArea=null,this.gamePlay=null,this.itemResult=null,this.scrollResult=null,this.tickets=null,this.itemMyTicket=null,this.scrollMyTicket=null,this.animWin=null,this.lbWin=null,this.btnBingo=null,this.lbTime=null,this.panelChat=null,this.popupTanLoc=null,this.popupHonors=null,this.popupHistory=null,this.listResult=[],this.currentResults=[],this.isClickBack=!1,this.scheduleBonusTime=null}static getInstance(){return this.instance}onLoad(){i.instance=this}start(){this.resizePlayView(),this.itemResult.active=!1,this.itemMyTicket.active=!1;let e=[];for(let t=0;t<25;t++)e.push(-1);e.forEach((e,t)=>{this.setCellInTicket(t,0,e)}),c.default.register(c.default.USER_UPDATE_COIN,()=>{l.default.numberTo(this.lbChip,a.default.Login.Coin,.3)},this),c.default.send(c.default.USER_UPDATE_COIN),c.default.register(c.default.USER_DISCONNECTED,()=>{h.default.getInstance().close()},this),o.default.instance.showErrLoading("\u0110ang k\u1ebft n\u1ed1i t\u1edbi server..."),h.default.getInstance().addOnOpen(()=>{o.default.instance.showErrLoading("\u0110ang \u0111ang \u0111\u0103ng nh\u1eadp...")},this),h.default.getInstance().addOnClose(()=>{this.isClickBack||!a.default.Login.IsLogin?this.backToLobby():o.default.instance.alertDialog.showMsgWithOnDismissed("B\u1ea1n \u0111\xe3 m\u1ea5t k\u1ebft n\u1ed1i v\u1edbi server.",()=>{this.backToLobby()})},this),h.default.getInstance().connect(),h.default.getInstance().addListener(e=>{if(this.node.active)switch(new d.default(e).getCmdId()){case g.default.Code.LOGIN:o.default.instance.showLoading(!1),this.subscribe(),this.requestConfig(),this.requestUserInfo();break;case u.default.Code.SUBCRIBE_RESPONSE:{let t=new u.default.ReceiveSubscribe(e);cc.log(t)}break;case u.default.Code.SPIN_RESULT:{let t=new u.default.ReceiveSpinResult(e);this.updateSpinRedult(t)}}},this),f.default.getInstance().addListener(e=>{switch(new d.default(e).getCmdId()){case u.default.Code.UPDATE_USER_MONEY:{let t=new u.default.ReceivedUpdateUserMoney(e);a.default.Login.Coin=t.totalMoney,c.default.send(c.default.USER_UPDATE_COIN),t.showPopup&&o.default.instance.alertDialog.showMsg("C\xf3 th\u01b0 m\u1edbi :\n"+t.desc)}}},this),this.schedule(()=>{h.default.getInstance().send(new u.default.SendPing)},20)}resizePlayView(){const e=(this.safeArea.height-100-1180)/2;e>0&&(this.scrollMyTicket.node.height=this.scrollMyTicket.node.height+e,this.scrollResult.node.height=this.scrollResult.node.height+e)}subscribe(){h.default.getInstance().send(new u.default.SendSubscribe)}requestConfig(){r.default.get(a.default.App.API_TAN_LOC+"config",{},(e,t)=>{if(null!=e)return;cc.log(t);let n=t.countDown;this.setCountDown(n),this.schedule(this.scheduleBonusTime=()=>{--n>=0?this.setCountDown(n):(this.unschedule(this.scheduleBonusTime),this.requestConfig())},1)})}setCountDown(e){let t=Math.floor(e/3600),n=Math.floor((e-3600*t)/60),i=Math.floor(e-3600*t-60*n);this.lbTime.string=[t<10?"0"+t:t,n<10?"0"+n:n,i<10?"0"+i:i].join(":"),this.lbTime.node.color=e>10?cc.Color.CYAN:cc.Color.RED}requestUserInfo(){r.default.get(a.default.App.API_TAN_LOC+"userinfo",{},(e,t)=>{null==e&&(cc.log(t),this.generateMyTicket(v.toTickets(t.eventTanLocUserTicketList)))})}backToLobby(){cc.audioEngine.stopAll(),o.default.instance.loadScene("Lobby")}actionBack(){this.isClickBack=!0,h.default.getInstance().close()}actionAddCoin(){m.default.createAndShow(o.default.instance.popups)}actionHonors(){this.popupHonors.show()}actionHistory(){this.popupHistory.show()}actionTanLoc(){this.popupTanLoc.show()}actionRegisterLoc(){r.default.post(a.default.App.API_TAN_LOC+"register",{},(e,t)=>{if(null==e)if(cc.log(t),t.success)o.default.instance.toast.showToast("\u0110\u0103ng k\xfd r\xfat l\u1ed9c th\xe0nh c\xf4ng."),this.generateMyTicket(v.toTickets(t.eventTanLocUserTicketList));else{const e=w.UserActions.toEnums(t.suggestionActions);e.length>0?o.default.instance.actiontDialog.showMsgWithActions(t.message,e):o.default.instance.toast.showToast(t.message)}})}actionChat(){cc.Tween.stopAllByTarget(this.tickets),cc.Tween.stopAllByTarget(this.scrollResult.node),cc.Tween.stopAllByTarget(this.scrollMyTicket.node),cc.Tween.stopAllByTarget(this.panelChat.node),cc.tween(this.tickets).to(.5,{scale:.5,y:365},{easing:"quartInOut"}).start(),cc.tween(this.scrollResult.node).to(.5,{scale:.5,y:551.75,height:350},{easing:"quartInOut"}).start(),cc.tween(this.scrollMyTicket.node).to(.5,{scale:.5,x:this.gamePlay.width/2,y:178.25,width:this.gamePlay.width,height:350},{easing:"quartInOut"}).start(),this.panelChat.show(),this.panelChat.node.opacity=0,this.panelChat.node.scaleY=0,cc.tween(this.panelChat.node).to(.5,{scaleY:1,opacity:255},{easing:"quartInOut"}).start()}dismissChat(){cc.Tween.stopAllByTarget(this.tickets),cc.Tween.stopAllByTarget(this.scrollResult.node),cc.Tween.stopAllByTarget(this.scrollMyTicket.node),cc.Tween.stopAllByTarget(this.panelChat.node),cc.tween(this.tickets).to(.5,{scale:1,y:-45},{easing:"quartInOut"}).start(),cc.tween(this.scrollResult.node).to(.5,{scale:1,y:this.gamePlay.height/2-53,height:180+(this.gamePlay.height-1180)/2},{easing:"quartInOut"}).start(),cc.tween(this.scrollMyTicket.node).to(.5,{scale:1,x:this.gamePlay.width/2-150,y:-this.gamePlay.height/2,width:this.gamePlay.width-150,height:150+(this.safeArea.height-100-1180)/2},{easing:"quartInOut"}).start(),cc.tween(this.panelChat.node).to(.5,{y:-280,opacity:0},{easing:"quartInOut"}).call(()=>{this.panelChat.node.active=!1}).start()}actionBingo(){r.default.post(a.default.App.API_TAN_LOC+"bingo",{},(e,t)=>{null==e&&cc.log(t)})}updateSpinRedult(e){this.currentResults.length!=JSON.parse(e.spinResult)[e.currentRound].length&&(this.currentResults=JSON.parse(e.spinResult)[e.currentRound],cc.log(this.currentResults),this.scrollResult.content.children.forEach(e=>{e.active=!1}),this.currentResults.forEach((e,t)=>{let n=this.scrollResult.content.children[t];n?(n.active=!0,n.getChildByName("number-ball").getComponent(cc.Label).string=e<10?"0"+e:""+e,n.getChildByName("type-ball").getComponent(cc.Label).string=e<20?"B":e<40?"I":e<60?"N":e<80?"G":"O"):this.addResult(e)}))}addResult(e=null){"number"!=typeof e&&(e=Math.floor(100*Math.random())),this.listResult.push(e);let t=cc.instantiate(this.itemResult);t.active=!0,t.getChildByName("number-ball").getComponent(cc.Label).string=e<10?"0"+e:""+e,t.getChildByName("type-ball").getComponent(cc.Label).string=e<20?"B":e<40?"I":e<60?"N":e<80?"G":"O",this.scrollResult.content.addChild(t),this.scrollResult.scrollToRight(.2),this.checkTicket()}checkTicket(){this.tickets.children.forEach(e=>{this.setCellInTicket(parseInt(e.name),0)}),this.listResult.forEach(e=>{let t=this.tickets.children.find(t=>t.getChildByName("number-cell")&&t.getChildByName("number-cell").getComponent(cc.Label).string==(e<10?"0"+e:""+e));t&&this.setCellInTicket(parseInt(t.name),1)});let e=this.tickets.children.filter(e=>e.getChildByName("number-cell")&&(e.getChildByName("win").active||e.getChildByName("cell_win").active)).map(e=>parseInt(e.name)).sort((e,t)=>e-t),t=[];for(let n=0;n<5;n++){t=[];for(let i=0;i<5;i++)-1!=e.indexOf(5*n+i)&&t.push(5*n+i);if(5==t.length)return this.showLineWin(t);t=[];for(let i=0;i<5;i++)-1!=e.indexOf(n+5*i)&&t.push(n+5*i);if(5==t.length)return this.showLineWin(t)}t=[];for(let n=0;n<5;n++)-1!=e.indexOf(n+5*n)&&t.push(n+5*n);if(5==t.length)return this.showLineWin(t);t=[];for(let n=0;n<5;n++)-1!=e.indexOf(4-n+5*n)&&t.push(4-n+5*n);return 5==t.length?this.showLineWin(t):void 0}generateMyTicket(e){let t=this.scrollMyTicket.content.children.findIndex(e=>1==e.getComponent(cc.Toggle).isChecked);this.scrollMyTicket.content.children.forEach(e=>e.active=!1),e.forEach((n,i)=>{let s=this.scrollMyTicket.content.children[i];s||(s=cc.instantiate(this.itemMyTicket),this.scrollMyTicket.content.addChild(s)),s.active=!0,s.getChildByName("number").getComponent(cc.Label).string=n.id<10?"0"+n.id:""+n.id,s.off("toggle"),s.on("toggle",()=>{n.matrix.reverse().forEach((e,t)=>{this.setCellInTicket(t,0,e)}),this.checkTicket()}),(t&&t<e.length&&t===i||i===e.length-1)&&(s.getComponent(cc.Toggle).check(),s.emit("toggle"))}),this.scrollMyTicket.scrollToRight(.2)}setCellInTicket(e,t=0,n=-1){let i=this.tickets.getChildByName(""+e);i&&(-1!=n&&(i.getChildByName("number-cell").getComponent(cc.Label).string=n<0?"":n<10?"0"+n:""+n),i.getChildByName("win").active=t>0,i.getChildByName("cell_win").active=t>1)}showLineWin(e=[-1,-1,-1,-1,-1]){e.forEach(e=>{let t=this.tickets.getChildByName(e+"");if(!t)return;t.getChildByName("cell_win").active=!0;let n=[];n.push(cc.callFunc(()=>{t.getChildByName("win").active=!1}));for(let i=0;i<5;i++)n.push(cc.sequence(cc.fadeIn(.2),cc.fadeOut(.2)));n.push(cc.callFunc(()=>{t.getChildByName("win").active=!0,this.showWin(),this.btnBingo.node.active=!0})),n.push(cc.delayTime(2)),cc.tween(t.getChildByName("cell_win")).repeatForever(cc.sequence(n)).start()})}showWin(){this.animWin.enabled=!0,this.animWin.setAnimation(0,"animation",!1),cc.tween(this.lbWin.node).set({opacity:0}).delay(.1).to(.2,{opacity:255}).delay(1.9).to(.2,{opacity:0}).start()}};b.instance=null,s([L(cc.Label)],b.prototype,"lbChip",void 0),s([L(cc.Node)],b.prototype,"safeArea",void 0),s([L(cc.Node)],b.prototype,"gamePlay",void 0),s([L(cc.Node)],b.prototype,"itemResult",void 0),s([L(cc.ScrollView)],b.prototype,"scrollResult",void 0),s([L(cc.Node)],b.prototype,"tickets",void 0),s([L(cc.Node)],b.prototype,"itemMyTicket",void 0),s([L(cc.ScrollView)],b.prototype,"scrollMyTicket",void 0),s([L(sp.Skeleton)],b.prototype,"animWin",void 0),s([L(cc.Label)],b.prototype,"lbWin",void 0),s([L(cc.Button)],b.prototype,"btnBingo",void 0),s([L(cc.Label)],b.prototype,"lbTime",void 0),s([L(p.default)],b.prototype,"panelChat",void 0),s([L(C.default)],b.prototype,"popupTanLoc",void 0),s([L(y.default)],b.prototype,"popupHonors",void 0),s([L(T.default)],b.prototype,"popupHistory",void 0),b=i=s([k],b),n.default=b,cc._RF.pop()},{"../../Main/Game/src/common/App":void 0,"../../Main/Game/src/common/BroadcastReceiver":void 0,"../../Main/Game/src/common/Configs":void 0,"../../Main/Game/src/common/Constants":void 0,"../../Main/Game/src/common/Http":void 0,"../../Main/Game/src/common/Tween":void 0,"../../Main/Game/src/networks/MiniGameNetworkClient":void 0,"../../Main/Game/src/networks/Network.Cmd":void 0,"../../Main/Game/src/networks/Network.InPacket":void 0,"../../Main/Lobby/src/Lobby.PopupShop":void 0,"./TanLoc.Cmd":"TanLoc.Cmd","./TanLoc.NetworkClient":"TanLoc.NetworkClient","./TanLoc.PanelChat":"TanLoc.PanelChat","./TanLoc.PopupHistory":"TanLoc.PopupHistory","./TanLoc.PopupHonors":"TanLoc.PopupHonors","./TanLoc.PopupTanLoc":"TanLoc.PopupTanLoc"}],"TanLoc.Dialog":[function(e,t,n){"use strict";cc._RF.push(t,"8491auHjEpNiZHWtFhOy2Jj","TanLoc.Dialog");var i=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,c=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(c=(o<3?s(c):o>3?s(t,n,c):s(t,n))||c);return o>3&&c&&Object.defineProperty(t,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});const{ccclass:s,property:o}=cc._decorator;let c=class extends cc.Component{show(){cc.Tween.stopAllByTarget(this.node),this.node.active=!0,cc.tween(this.node).set({position:cc.v3(-cc.winSize.width,0)}).to(.4,{position:cc.v3(0,0)}).start()}dismiss(){cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(.4,{position:cc.v3(-cc.winSize.width,0)}).call(()=>{this.node.active=!1}).start()}};c=i([s],c),n.default=c,cc._RF.pop()},{}],"TanLoc.NetworkClient":[function(e,t,n){"use strict";cc._RF.push(t,"86996qJ9QFFrKmRZoc7Fa0R","TanLoc.NetworkClient"),Object.defineProperty(n,"__esModule",{value:!0});const i=e("../../Main/Game/src/networks/Network.NetworkClient"),s=e("../../Main/Game/src/networks/Network.NetworkListener"),o=e("../../Main/Game/src/common/Configs"),c=e("../../Main/Game/src/networks/Network.InPacket"),a=e("../../Main/Game/src/networks/Network.Cmd");class r extends i.default{constructor(){super(),this.listeners=new Array,this.isLogin=!1,this.onLogined=null,this.isUseWSS=o.default.App.USE_WSS}static getInstance(){return null==this.instance&&(this.instance=new r),this.instance}checkConnect(e=null){this.onLogined=e,null!=this.ws&&this.ws.readyState==WebSocket.CONNECTING||(this.isConnected()?this.isLogin&&null!=this.onLogined&&this.onLogined():this.connect())}connect(){super.connect(o.default.App.HOST_TAN_LOC.host,o.default.App.HOST_TAN_LOC.port)}onOpen(e){super.onOpen(e),this.send(new a.default.SendLogin(o.default.Login.Nickname,o.default.Login.AccessToken))}onMessage(e){for(var t=new Uint8Array(e.data),n=0;n<this.listeners.length;n++){var i=this.listeners[n];i.target&&i.target instanceof Object&&i.target.node?i.callback(t):(this.listeners.splice(n,1),n--)}switch(new c.default(t).getCmdId()){case a.default.Code.LOGIN:this.isLogin=!0,null!=this.onLogined&&this.onLogined()}}addListener(e,t){this.listeners.push(new s.default(t,e))}send(e){for(var t=new Int8Array(e._length),n=0;n<e._length;n++)t[n]=e._data[n];null!=this.ws&&this.isConnected()&&this.ws.send(t.buffer)}sendCheck(e){this.checkConnect(()=>{this.send(e)})}}n.default=r,cc._RF.pop()},{"../../Main/Game/src/common/Configs":void 0,"../../Main/Game/src/networks/Network.Cmd":void 0,"../../Main/Game/src/networks/Network.InPacket":void 0,"../../Main/Game/src/networks/Network.NetworkClient":void 0,"../../Main/Game/src/networks/Network.NetworkListener":void 0}],"TanLoc.PanelChat":[function(e,t,n){"use strict";cc._RF.push(t,"1c957brhSxC+rfN0N2xF7TB","TanLoc.PanelChat");var i=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,c=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(c=(o<3?s(c):o>3?s(t,n,c):s(t,n))||c);return o>3&&c&&Object.defineProperty(t,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});const s=e("../../Main/Game/src/common/App"),o=e("../../Main/Game/src/common/BroadcastReceiver"),c=e("../../Main/Game/src/common/Constants"),a=e("../../Main/Game/src/common/Utils"),r=e("../../Main/Game/src/networks/MiniGameNetworkClient"),l=e("../../Main/Game/src/networks/Network.InPacket"),h=e("./TanLoc.Cmd"),d=e("./TanLoc.Controller"),{ccclass:u,property:p}=cc._decorator;let g=class extends cc.Component{constructor(){super(...arguments),this.itemChatTemplate=null,this.scrMessage=null,this.edbMessage=null,this.atlasVip=null}start(){this.itemChatTemplate.active=!1,o.default.send(o.default.SET_SOUND,this.node),r.default.getInstance().addListener(e=>{if(this.node.active)switch(new l.default(e).getCmdId()){case h.default.Code.LOG_CHAT:try{let s=new h.default.ReceiveLogChat(e);if(cc.log(s),s.chatChannel!==c.ChatChannel.TAN_LOC)break;for(var t=JSON.parse(s.message),n=0;n<t.length;n++)this.addMessage(t[n].u,t[n].m,t[n].vipId)}catch(i){cc.log(i)}null==this||this.scrollToBottom();break;case h.default.Code.SEND_CHAT:{let t=new h.default.ReceiveSendChat(e);if(cc.log(t),t.chatChannel!==c.ChatChannel.TAN_LOC)break;switch(t.error){case 0:this.addMessage(t.nickname,t.message,t.vip);break;default:s.default.instance.actiontDialog.showMsgWithActions(t.desc,t.suggestionActions)}break}}},this)}show(){this.node.active=!0;for(var e=0;e<this.scrMessage.content.childrenCount;e++)this.scrMessage.content.children[e].active=!1;r.default.getInstance().send(new h.default.SendSubscribeChat)}addMessage(e,t,n){let i=null;for(var s=0;s<this.scrMessage.content.childrenCount;s++){let e=this.scrMessage.content.children[s];if(!e.active){i=e;break}}null==i&&(i=this.scrMessage.content.childrenCount>=50?this.scrMessage.content.children[0]:cc.instantiate(this.itemChatTemplate));var o=0;for(s=0;s<this.scrMessage.content.childrenCount;s++){let e=this.scrMessage.content.children[s];e!=i&&(e.zIndex=o++)}i.parent=this.scrMessage.content,i.active=!0,i.zIndex=o++;let c=i.getComponentInChildren(cc.RichText);c.imageAtlas=this.atlasVip;let r=a.default.getColorVip("VIP_"+n),l="<color="+r+"><outline color="+r+"width=1>"+e+"</outline></color> <img src='Vip"+n+"' offset=0,-7/><img src='VIP_"+n+"' offset=0,-7/>:  "+t;c.string=l,this.scrollToBottom()}sendChat(){let e=this.edbMessage.string.trim();0!=e.length&&(this.edbMessage.string="",this.submitChat(e))}submitChat(e){r.default.getInstance().send(new h.default.SendChat(unescape(encodeURIComponent(e))))}scrollToBottom(){this.scrMessage.scrollToBottom(.2)}dismiss(){r.default.getInstance().send(new h.default.SendUnSubscribeChat),d.default.getInstance().dismissChat()}};i([p(cc.Node)],g.prototype,"itemChatTemplate",void 0),i([p(cc.ScrollView)],g.prototype,"scrMessage",void 0),i([p(cc.EditBox)],g.prototype,"edbMessage",void 0),i([p(cc.SpriteAtlas)],g.prototype,"atlasVip",void 0),g=i([u],g),n.default=g,cc._RF.pop()},{"../../Main/Game/src/common/App":void 0,"../../Main/Game/src/common/BroadcastReceiver":void 0,"../../Main/Game/src/common/Constants":void 0,"../../Main/Game/src/common/Utils":void 0,"../../Main/Game/src/networks/MiniGameNetworkClient":void 0,"../../Main/Game/src/networks/Network.InPacket":void 0,"./TanLoc.Cmd":"TanLoc.Cmd","./TanLoc.Controller":"TanLoc.Controller"}],"TanLoc.PopupHistory":[function(e,t,n){"use strict";cc._RF.push(t,"b8f954DN6ZAiIEUnWu6r+j/","TanLoc.PopupHistory");var i=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,c=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(c=(o<3?s(c):o>3?s(t,n,c):s(t,n))||c);return o>3&&c&&Object.defineProperty(t,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});const s=e("../../Main/Game/src/common/App"),o=e("../../Main/Game/src/common/Configs"),c=e("../../Main/Game/src/common/Http"),a=e("./TanLoc.Dialog"),{ccclass:r,property:l}=cc._decorator;let h=class extends a.default{constructor(){super(...arguments),this.scrollHistory=null,this.itemHistory=null,this.lbPage=null,this.pageSize=10,this.currentPage=0}show(){this.loadData(this.currentPage),super.show()}loadData(e){c.default.get(o.default.App.API_TAN_LOC+"history",{page:e,size:this.pageSize},(t,n)=>{if(null!==t)return;if(cc.log(n),!n.success)return void s.default.instance.alertDialog.showMsg(n.desc);let i=n.lotteryResults;if(0!==i.length){this.currentPage=e,this.lbPage.string=this.currentPage+1+"/"+n.totalPages,this.scrollHistory.content.children.forEach(e=>e.active=!1);for(let e=0;e<i.length;e++){const t=i[e];let n=this.scrollHistory.content.children[e];n||((n=cc.instantiate(this.itemHistory)).parent=this.scrollHistory.content),n.active=!0,n.getComponentsInChildren(cc.Label)[0].string=t.date}}})}actionPrePage(){0!==this.currentPage&&this.loadData(this.currentPage-1)}actionNextPage(){this.loadData(this.currentPage+1)}};i([l(cc.ScrollView)],h.prototype,"scrollHistory",void 0),i([l(cc.Node)],h.prototype,"itemHistory",void 0),i([l(cc.Label)],h.prototype,"lbPage",void 0),h=i([r],h),n.default=h,cc._RF.pop()},{"../../Main/Game/src/common/App":void 0,"../../Main/Game/src/common/Configs":void 0,"../../Main/Game/src/common/Http":void 0,"./TanLoc.Dialog":"TanLoc.Dialog"}],"TanLoc.PopupHonors":[function(e,t,n){"use strict";cc._RF.push(t,"3f5c52x9c1BZJM788Up9mwn","TanLoc.PopupHonors");var i=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,c=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(c=(o<3?s(c):o>3?s(t,n,c):s(t,n))||c);return o>3&&c&&Object.defineProperty(t,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});const s=e("../../Main/Game/src/common/Configs"),o=e("../../Main/Game/src/common/Http"),c=e("../../Main/Game/src/common/Utils"),a=e("./TanLoc.Dialog"),{ccclass:r,property:l}=cc._decorator;let h=class extends a.default{constructor(){super(...arguments),this.scrollRewarded=null,this.itemRewarded=null,this.scrollShared=null,this.itemShared=null,this.spriteRanks=[],this.atlasVip=null,this.pageSize=10}start(){this.itemRewarded.height=this.scrollRewarded.node.height/this.pageSize,this.itemShared.height=this.scrollShared.node.height/this.pageSize}show(){this.requestTopRewarded(),this.requestTopShared(),super.show()}requestTopRewarded(){this.scrollRewarded.content.children.forEach(e=>e.active=!1),o.default.get(s.default.App.API_TAN_LOC+"toprewarded",{page:0,size:this.pageSize},(e,t)=>{var n;if(null!==e)return;cc.log(t);const i=t;for(let s=0;s<i.length;s++){const e=i[s];let t=this.scrollRewarded.content.children[s];t||((t=cc.instantiate(this.itemRewarded)).parent=this.scrollRewarded.content),t.getChildByName("Bg").active=s%2==0,t.getChildByName("IconRank").getComponent(cc.Sprite).spriteFrame=this.spriteRanks[s];let o=t.getChildByName("Nickname"),a=Number(null===(n=e.vipRank)||void 0===n?void 0:n.replace(/^\D+/g,""));o.getComponentInChildren(cc.Sprite).spriteFrame=this.atlasVip.getSpriteFrame("VIP_"+a),o.getComponentInChildren(cc.Label).node.color=cc.Color.BLACK.fromHEX(c.default.getColorVip("VIP_"+a)),o.getComponentInChildren(cc.Label).string=e.nickname.length<=10?e.nickname:e.nickname.substring(0,8)+"...",t.getChildByName("LbCoin").getComponent(cc.Label).string=c.default.formatMoney(e.money),t.active=!0,t.parent=this.scrollRewarded.content,t.position=cc.v3(cc.winSize.width,400);let r=.7;t.runAction(cc.sequence(cc.delayTime(.15*s*r),cc.moveTo(.15*r,cc.v2(0,400)),cc.delayTime(.05),cc.moveTo(.2*r*(1===s?.8:1-Math.pow(2,-10*s)),cc.v2(0,380-85*s)).easing(cc.easeCircleActionOut())))}})}requestTopShared(){this.scrollShared.content.children.forEach(e=>e.active=!1),o.default.get(s.default.App.API_TAN_LOC+"topshared",{page:0,size:this.pageSize},(e,t)=>{var n;if(null!==e)return;cc.log(t);const i=t;for(let s=0;s<i.length;s++){const e=i[s];let t=this.scrollShared.content.children[s];t||((t=cc.instantiate(this.itemShared)).parent=this.scrollShared.content),t.getChildByName("Bg").active=s%2==0,t.getChildByName("IconRank").getComponent(cc.Sprite).spriteFrame=this.spriteRanks[s];let o=t.getChildByName("Nickname"),a=Number(null===(n=e.vipRank)||void 0===n?void 0:n.replace(/^\D+/g,""));o.getComponentInChildren(cc.Sprite).spriteFrame=this.atlasVip.getSpriteFrame("VIP_"+a),o.getComponentInChildren(cc.Label).node.color=cc.Color.BLACK.fromHEX(c.default.getColorVip("VIP_"+a)),o.getComponentInChildren(cc.Label).string=e.nickname.length<=10?e.nickname:e.nickname.substring(0,8)+"...",t.getChildByName("LbCoin").getComponent(cc.Label).string=c.default.formatMoney(e.totalShareMoney),t.active=!0,t.parent=this.scrollShared.content,t.position=cc.v3(cc.winSize.width,400);let r=.7;t.runAction(cc.sequence(cc.delayTime(.15*s*r),cc.moveTo(.15*r,cc.v2(0,400)),cc.delayTime(.05),cc.moveTo(.2*r*(1===s?.8:1-Math.pow(2,-10*s)),cc.v2(0,380-85*s)).easing(cc.easeCircleActionOut())))}})}};i([l(cc.ScrollView)],h.prototype,"scrollRewarded",void 0),i([l(cc.Node)],h.prototype,"itemRewarded",void 0),i([l(cc.ScrollView)],h.prototype,"scrollShared",void 0),i([l(cc.Node)],h.prototype,"itemShared",void 0),i([l([cc.SpriteFrame])],h.prototype,"spriteRanks",void 0),i([l(cc.SpriteAtlas)],h.prototype,"atlasVip",void 0),h=i([r],h),n.default=h,cc._RF.pop()},{"../../Main/Game/src/common/Configs":void 0,"../../Main/Game/src/common/Http":void 0,"../../Main/Game/src/common/Utils":void 0,"./TanLoc.Dialog":"TanLoc.Dialog"}],"TanLoc.PopupTanLoc":[function(e,t,n){"use strict";cc._RF.push(t,"43278IeVcRF4YZ5CYKEhxes","TanLoc.PopupTanLoc");var i=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,c=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(c=(o<3?s(c):o>3?s(t,n,c):s(t,n))||c);return o>3&&c&&Object.defineProperty(t,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});const s=e("../../Main/Game/src/common/App"),o=e("../../Main/Game/src/common/Configs"),c=e("../../Main/Game/src/common/Dialog"),a=e("../../Main/Game/src/common/Http"),{ccclass:r,property:l}=cc._decorator;let h=class extends c.default{constructor(){super(...arguments),this.edbAmount=null}show(){super.show(),this.edbAmount.string=""}actionSubmit(){const e=parseInt(this.edbAmount.string);0===e||isNaN(e)?s.default.instance.toast.showToast("S\u1ed1 ti\u1ec1n kh\xf4ng h\u1ee3p l\u1ec7."):(a.default.post(o.default.App.API_TAN_LOC+"tanloc",{amount:e},(e,t)=>{null==e&&(cc.log(t),s.default.instance.toast.showToast(t.success?"T\xe1n l\u1ed9c th\xe0nh c\xf4ng":t.message))}),this.dismiss())}};i([l(cc.EditBox)],h.prototype,"edbAmount",void 0),h=i([r],h),n.default=h,cc._RF.pop()},{"../../Main/Game/src/common/App":void 0,"../../Main/Game/src/common/Configs":void 0,"../../Main/Game/src/common/Dialog":void 0,"../../Main/Game/src/common/Http":void 0}]},{},["TanLoc.Cmd","TanLoc.Controller","TanLoc.Dialog","TanLoc.NetworkClient","TanLoc.PanelChat","TanLoc.PopupHistory","TanLoc.PopupHonors","TanLoc.PopupTanLoc"]);